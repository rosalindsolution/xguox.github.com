<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[XguoX_L]]></title>
  <link href="http://xguox.github.com/atom.xml" rel="self"/>
  <link href="http://xguox.github.com/"/>
  <updated>2013-04-12T19:00:29+08:00</updated>
  <id>http://xguox.github.com/</id>
  <author>
    <name><![CDATA[XguoX_L]]></name>
    <email><![CDATA[golvinlu@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[扯点Sublime]]></title>
    <link href="http://xguox.github.com/blog/2013/04/11/jabber-sublime/"/>
    <updated>2013-04-11T18:33:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/11/jabber-sublime</id>
    <content type="html"><![CDATA[<h2>Fxxk Jabber</h2>

<p>回想起初初接触编程语言的时候, 特喜欢折腾IDE的玩意, 什么visual studio啊, Eclipse啊, Netbeans, Aptana的会不会用好不好用都不管了, 装进PC再说, 怎么说, 很傻13的觉得我的PC里有这些工具我就牛13了, 熟不知真正的编程知识却木有学到, 后来搞Ruby开始放弃笨重的IDE改玩Vim和Sublime Text, 当时Textmate被捧上天不过木有Mac耍不起. <br/>
换了Mac了, Textmate2也开源了, 于是也装上耍了耍. 没多久又继续用Sublime Text了.  OOXX来来去去, 这两货其实真没差多少. 好吧, 是我用的都不够透彻. (T . T)</p>

<h2>Theme</h2>

<p>有时候蛋疼起来可以折腾某个主题某个配色好长的时间, 即使这对我的编程技能木有任何实质性提高.  强推一款theme - <a href="https://github.com/thinkpixellab/flatland">Flatland</a>,  随着Flat UI的兴起, ST的主题肿么能落后啊.  附带的icon更是比Sublime原本的霸气的不是一点两点啊. 貌似在哪见过, 想不起来了.
<img src="http://farm9.staticflickr.com/8392/8636887917_4db9f0f2b7_b.jpg" alt="" /></p>

<p>这UI还行吧? 我自己也懒得再去调了, 额外的把cursor换了个色就是了(原本的灰色真心不够骚啊, 老是眼瞎找不着)</p>

<!-- more -->


<p>说到theme就想起这个正在用着的<a href="https://github.com/aziz/knockdown">Knockdown</a> Package -Markdown文件专属的主题, 再配上Sublime Text的<strong>Enter Distraction Free Mode</strong> 用写静态Blog很带感叻, 对不对.  有时候, 巨爱这个模式. 舍不得Sublime的原因之一<br/>
<img src="http://farm9.staticflickr.com/8264/8638936015_31cde7d54f_b.jpg" alt="" /></p>

<p>之前也试用过<a href="https://github.com/ttscoff/MarkdownEditing">MarkdownEditing</a>, MarkdownEditing的高亮做的没Knockdown那么好(说实话, Knockdown的代码块的高亮配色不怎么符合我的style, 太过偏暗偏沉, 但总比木有高亮来得强), 挺喜欢ME的默认放在center这一点, 但是, 在<strong>Enter Distraction Free Mode</strong>下, 这个优点也就荡然无存了.</p>

<h2>Packages</h2>

<p>每个用Sublime新手老手都会介绍强推的<a href="http://wbond.net/sublime_packages/package_control/installation">Package Control</a> 插件管理就不再累赘啦.
Actually, 想装啥插件可以直接在里头搜, 或者网页版搜索, 一般都会给出相应的github开源链接. 装什么插件就更是因人而异的.  比如如果从来不写Markdown的那就木有必要装我上面说的那货.  又比如, 如果是重度Hacker News 用户的话, 直接搜hacker news(其实在&#8221;Install Package&#8221;上输入hack就已经跑出来一堆相关让你选择), 当然也不是啥都有的, 如果搜的是reddit就没看到结果了.</p>

<p>个人用的目前装着的packages有:</p>

<ul>
<li><a href="https://github.com/alienhard/SublimeAllAutocomplete">All Autocomplete</a> 这货是在已打开的文件的基础上拓展匹配的</li>
<li><a href="https://github.com/aziz/knockdown">knockdown</a></li>
<li><a href="https://github.com/nathos/sass-textmate-bundle">Sass</a> Sass的高亮, 补全&#8230;</li>
<li><a href="http://xavura.github.io/CoffeeScript-Sublime-Plugin/">CoffeeScript</a>  CoffeeScript高亮,补全, Compile等&#8230;</li>
<li><a href="https://github.com/dzhibas/SublimePrettyJson">Pretty JSON</a> 经常看到一些个JSON文件一坨坨的, 有了这货看着也舒服多了</li>
<li><a href="https://github.com/uipoet/sublime-jshint">JSHint</a> 检查Javascript的语法规范, 要先在装了node, 然后<code>npm install -g jshint</code></li>
<li><a href="http://emmet.io/">Emmet</a> 前身Zen Coding, 貌似所有的packages之中排在最前的. 几乎被吹捧成为神器中的神器了.</li>
<li><a href="">HTMLpretty</a> 个人觉得解决缩进等格式问题的神器, 好吧, 即使木有这个偶本身也是具有良好编码规范的.</li>
<li><a href="https://github.com/kemayo/sublime-text-2-git">Git</a></li>
<li><a href="https://github.com/sokolovstas/SublimeWebInspector">Web Inspector</a> 纯属贪新鲜装上耍耍, 取代浏览器的inspector不太可能.</li>
<li><a href="https://github.com/eddorre/SublimeERB">ERB Insert and Toggle Commands</a> 快速输入<code>&lt;%= %&gt;</code>或者<code>&lt;% %&gt;</code></li>
<li><a href="https://github.com/dotty/HackerNews-SublimeTextPlugin">Hacker News</a> 不常用, 而且要自己改改shortcut, 否则会占用了显隐侧边栏的快捷键.</li>
</ul>


<h2>Settings-User</h2>

<p>先把custom的show一下, 也没啥的, 都是些无关痛痒的修改. 个人爱好吧. 有个必须有的就是<code>"scroll_past_end": true,</code> 经常写了一大车页面布满了, 下面的就滚不起来, 眼睛老要往下瞄很不爽. 设置以后就可以自由控制底部显示.<br/>
基本上自己看着Settings - Default 还是老规矩按需修改啦.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;theme&quot;</span><span class="o">:</span> <span class="s2">&quot;Flatland.sublime-theme&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;color_scheme&quot;</span><span class="o">:</span> <span class="s2">&quot;Packages/Theme - Flatland/Flatland.tmtheme&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;tab_size&quot;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;font_options&quot;</span><span class="o">:</span>
</span><span class='line'>    <span class="p">[</span>
</span><span class='line'>        <span class="s2">&quot;bold&quot;</span>
</span><span class='line'>    <span class="p">],</span>
</span><span class='line'>    <span class="s2">&quot;font_face&quot;</span><span class="o">:</span> <span class="s2">&quot;Courier New&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;font_size&quot;</span><span class="o">:</span> <span class="mf">20.0</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;bold_folder_labels&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;hot_exit&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;open_files_in_new_window&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;create_window_at_startup&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;scroll_past_end&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;wide_caret&quot;</span><span class="o">:</span> <span class="kc">true</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Key Bindings - User</h2>

<p>快捷键同样跟Settings可以多看Default绝对比看路边3322的像我这些要靠谱, 完整的多. 忘了在哪学到的<code>{ "keys": ["ctrl+command+r"], "command": "reveal_in_side_bar" }</code> 挺实用的, 直接在侧边栏显示当前的文件所在的目录.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">[</span>
</span><span class='line'>  <span class="p">{</span> <span class="s2">&quot;keys&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;ctrl+command+r&quot;</span><span class="p">],</span> <span class="s2">&quot;command&quot;</span><span class="o">:</span> <span class="s2">&quot;reveal_in_side_bar&quot;</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="s2">&quot;keys&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;command+shift+.&quot;</span><span class="p">],</span> <span class="s2">&quot;command&quot;</span><span class="o">:</span> <span class="s2">&quot;erb&quot;</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="s2">&quot;keys&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;super+v&quot;</span><span class="p">],</span> <span class="s2">&quot;command&quot;</span><span class="o">:</span> <span class="s2">&quot;paste_and_indent&quot;</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="s2">&quot;keys&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;super+shift+v&quot;</span><span class="p">],</span> <span class="s2">&quot;command&quot;</span><span class="o">:</span> <span class="s2">&quot;paste&quot;</span> <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Shortcut</h2>

<p>列一些个老是忘记用快捷键的操作, (有时候又无故发现一些快捷键)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">focus</span><span class="err">到侧边栏</span><span class="o">:</span> <span class="s1">&#39;ctrl + 0&#39;</span>
</span><span class='line'><span class="nx">Command</span> <span class="o">+</span> <span class="nx">D</span><span class="err">：选择词。重复按下可以增加选择下一相同的词。按下</span> <span class="nx">Ctrl</span> <span class="o">+</span> <span class="nx">Command</span> <span class="o">+</span> <span class="nx">G</span> <span class="err">可选中所有相同的词。</span>
</span><span class='line'><span class="nx">Command</span> <span class="o">+</span> <span class="nx">Option</span> <span class="o">+</span> <span class="err">/：块注释。</span>
</span><span class='line'><span class="nx">Control</span> <span class="o">+</span> <span class="nx">M</span><span class="err">：跳转到对应的括号。</span>
</span><span class='line'><span class="nx">Control</span> <span class="o">+</span> <span class="nx">Shift</span> <span class="o">+</span> <span class="nx">M</span><span class="err">：选中当前括号内的内容，重复按下可增加选择括号本身。</span>
</span><span class='line'><span class="nx">Command</span> <span class="o">+</span> <span class="nx">Shift</span> <span class="o">+</span> <span class="nx">J</span><span class="err">：选中当前缩进级别下的所有代码。</span>
</span><span class='line'><span class="nx">Command</span> <span class="o">+</span> <span class="nx">Option</span> <span class="o">+</span> <span class="p">.</span><span class="err">：闭合</span> <span class="nx">HTML</span> <span class="err">标签。</span><span class="p">(</span><span class="err">说常用也不常用</span><span class="p">,</span> <span class="err">但又貌似有用</span><span class="p">)</span>
</span><span class='line'><span class="err">按住</span><span class="nx">option</span> <span class="err">拖拽多列</span>
</span><span class='line'><span class="err">按下</span> <span class="nx">Control</span> <span class="o">+</span> <span class="nx">Shift</span> <span class="o">+</span> <span class="err">方向键，可以选中矩形区域的文本。</span>
</span><span class='line'><span class="err">选择数行文本末端，选中区域然后按下</span> <span class="nx">Shift</span> <span class="o">+</span> <span class="nx">Command</span> <span class="o">+</span> <span class="nx">L</span><span class="err">。</span>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Understanding Publications and Subscriptions]]></title>
    <link href="http://xguox.github.com/blog/2013/04/10/understanding-publications-and-subscriptions/"/>
    <updated>2013-04-10T14:22:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/10/understanding-publications-and-subscriptions</id>
    <content type="html"><![CDATA[<h5>LEVEL: INTERMEDIATE</h5>

<p>Publications &amp; subscriptions 是在Meteor里最基本也是最重要的概念之一, 但同时也是最难理解的. 很大程度上是由于这其中跟传统的构建web的方式有很大的不同.<br/>
过去, 我们习惯思考,定义API用在客户端和服务器之间进行数据传递, 而在Meteor中, 客户端和服务端的数据是同步的. 我们使用publications来精确地控制如何同步. <br/>
最初人们觉得这个概念有一些难以理解的部分原因是由于Meteor像&#8221;魔术&#8221;那样为我们做了这一切. 这些&#8221;魔术&#8221;都非常有用, 而具体发生了什么则都被掩盖封装起来了(就如魔术为何如此奇幻一样). 那么, 现在就让我们拨开这些魔术表层的面纱一探究竟. 在此, 我们将会学习到一到两个窍门.</p>

<h2>Defining Publications</h2>

<p>从本质上讲, <strong>publication</strong>(使用<strong>subscription</strong>与之相连)是从服务端(源)collection到客户端(目标)collection的传递数据方法. 同时, 把subscription想象成一个漏斗连接着标准的数据存储(与mongodb数据库交互的源集合)与客户端缓存(目标集合, 相应数据的备份或者子集).</p>

<p><strong>subscription</strong>精确地控制着哪些数据该通过这个漏斗, 同时负责同步两端的数据. 通过添加多个<strong>subscription</strong>到服务端数据存储, 我们就可以实时地, 有效地, 安全地保持各个客户端的数据同步.</p>

<!-- more -->


<p>这里头所用的隧道协议叫作 <strong>DDP</strong>(Distributed Data Protocol). 想要了解更多关于DDP可以观看Matt DeBergalis(Meteor的founder之一)在(<a href="http://2012.realtimeconf.com/video/matt-debergalis">The Realtime Conference</a>上的演讲. 又或者是 Chris Mather的<a href="http://www.eventedmind.com/posts/meteor-subscriptions-and-ddp">这个视频</a>更详细的为你介绍DDP的概念.</p>

<p>现在, 我们了解了基础部分, 让我们往更深层探个究竟吧.</p>

<h2>Autopublish</h2>

<p>当你创建了一个最基本的Meteor应用之后(比如使用 <code>meteor create</code>), 它会自动的启用 <strong>autopublish</strong>这个package. 首先的, 我们先来看看它究竟为干了些什么.</p>

<p><strong>autopublish</strong>是移除了对subscriptions的需要还是只为你保管subscriptions 这取决于你如何看待它. <strong>autopublish</strong>所做的是自动地把服务端的所有数据镜像到客户端.
<img src="http://www.themeteorbook.com/images/book/autopublish@2x.png" alt="" /></p>

<p>这是怎么做到的呢? 假设你在服务端有个<code>posts</code>的集合. 那么 <strong>autopublish</strong>会自动把在Mongo 的posts 集合所找到的每一个post发送到客户端给一个也同样叫posts 的集合.</p>

<p>所以, 如果你使用<code>autopublish</code>, 你就不用再去管subscriptions了. 数据在哪都可以访问, 所有事情变得各种简单. 当然, 很明显这是有问题的, 你不可能在每一个用户的机器上都缓存有你的整个app的数据库备份.</p>

<p>出于这个原因, <strong>autopublish</strong>只适合用在你的app刚起步还没考虑到subscriptions的时候.</p>

<h2>Publishing Full Collections</h2>

<p>当你移除掉autopublish以后, 很快你就会发现你的数据都会在客户端消失不见. 有一种方法可以很简单地取回这些数据, 那就是简单的复刻<code>autopublish</code>, 并把一个collection全部publish. 例如:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;allPosts&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://www.themeteorbook.com/images/book/fullcollection@2x.png" alt="" /></p>

<p>同样地, 我们也还是把整个collection都publish了, 所不同的是, 现在对哪个collection进行publish是可控的. 在上边这个例子, 我们publish了<code>posts</code> collection, 而<code>comments</code> collection没有被publish.</p>

<h2>Publishing Partial Collections</h2>

<p>更高一级的粒度控制是只publish某个collection的一部分. 比如, 只作用于属于某个author的posts:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;somePosts&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s1">&#39;author&#39;</span><span class="o">:</span><span class="s1">&#39;Tom&#39;</span><span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://www.themeteorbook.com/images/book/partialcollection@2x.png" alt="" /></p>

<p>代码都很简单, 但是究竟在底层发生了些什么呢?</p>

<p>如果你有读过<a href="http://docs.meteor.com/#publishandsubscribe">Meteor的文档</a>, 可能会对<code>added()</code>和<code>ready()</code>在客户端设置记录的属性感到惊讶,  and struggled to square that with the Meteor apps that you&#8217;ve seen that never use those methods.(I am so sorry 这句没想着怎么翻译好)</p>

<p>这其中的原因是, Meteor提供了一个非常重要的便利 - <code>_publishCursor()</code>方法. 可能你从没见过它的使用? 因为有可能不是直接的调用，但如果你在调用一个publish函数并返回一个<strong>游标(cursor)</strong>(例如: <code>Posts.find({'author':'Tom'})</code>), 那么这就是<code>_publishCursor</code>.</p>

<p>当Meteor看到<code>somePosts</code>这个publication返回来一个游标(cursor), 则表明它自动调用了<code>_publishCursor()</code>publish这个cursor. 下面这是<code>_publishCursor()</code>所做的事情:</p>

<ul>
<li>在服务端查找这个名字的collection</li>
<li>从cursor中取得所有匹配的documents并发送到客户端的同名集合(在这用到的是<code>added()</code>)</li>
<li>只要某个document被增删改, 都会被同步到客户端(在cursor上使用<code>.observe()</code>, 并使用<code>.added()</code> <code>.updated()</code> <code>.removed()</code>来完成)</li>
</ul>


<p>那么,在上边的例子, 我们就可以很简便地确保只有用户感兴趣的posts(written by Tom)会出现在他们的客户端缓存之中.</p>

<h2>Publishing Partial Properties</h2>

<p>在上边我们已经看到了如何publish我们的一部分posts, 但是我们还可以做的更精确一些. 下面看看如何publish特定的记录吧. <br/>
<img src="http://www.themeteorbook.com/images/book/partialproperties@2x.png" alt="" /></p>

<p>跟前边的一样, 我们先用<code>find()</code>得到一个cursor, 不过这一次我们会排除掉一些</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;allPosts&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span><span class="nx">fields</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">author</span><span class="o">:</span> <span class="kc">false</span>
</span><span class='line'>  <span class="p">}});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>当然的, 我们还能够结合这两种技巧. 比如我们想要返回所有来自Tom的posts同时, 可以这么写</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;allPosts&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s1">&#39;author&#39;</span><span class="o">:</span><span class="s1">&#39;Tom&#39;</span><span class="p">},</span> <span class="p">{</span><span class="nx">fields</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">author</span><span class="o">:</span> <span class="kc">false</span>
</span><span class='line'>  <span class="p">}});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>总结</h2>

<p>现在, 我们已经知道了如何publish从所有collections的所有documents的所有属性(通过<code>autopublish</code>)到特定collections的特定documents的特定记录.</p>

<p>这包括了你能用Meteor的subscription所能做的所有基本东西, 而这些简单的技巧应该</p>

<p>有时候, 你可能会需要更深层的组合, 联接, 合并 publication, 而这些我们将会再找个时间详谈.</p>

<p>原文来自Tom Coleman <a href="http://www.themeteorbook.com/2013/04/05/publications-and-subscriptions/">Understanding Publications and Subscriptions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[继续折腾 -- Hexo版Blog]]></title>
    <link href="http://xguox.github.com/blog/2013/04/08/hexo-blog-node-octopress/"/>
    <updated>2013-04-08T22:51:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/08/hexo-blog-node-octopress</id>
    <content type="html"><![CDATA[<p>早之前就听说了<a href="http://zespia.tw/hexo/">Hexo</a>,  也就是Octopress的node.js版本, 不过是源自台湾.  setup的话其实中文英文都无妨吧.  尽管阅读起来肯定是较之中文困难, 不过也基本习惯了.</p>

<p>基本上按照官方给出的guide很容易搭建好. 不过还是不准备现在就撤出Octopress奔赴Hexo, 尽管基于node.js的Hexo在generate, deploy的时候有一定的执行速度优势, 不过目前post不太多, so有感觉出差距, 但不大.</p>

<p>因为不熟node, 还是遇上了麻烦, root下的db.json就不太明白. 导致在修改tags的时候死活修改不了, 查了一下github上以前的issue才知道得把db.json这货rm掉.  否则不管怎么generate, 怎么deploy都只会有增无减.</p>

<p>另一个跟Octopress比较不同的是Markdown的解析器. Octopress用的是Liquid, 而Hexo用的是Marked. 大部分情况下都没什么差别. 而之所以发现这个不同是因为刚开始的generate的时候不断报错</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>undefined:11
</span><span class='line'>if ((typeof _context !== "undefined" && typeof _context.&gt; posts !== "undefined
</span><span class='line'>                                                        ^
</span><span class='line'>SyntaxError: Unexpected token &gt;
</span><span class='line'>    at Object.Function (unknown source)
</span><span class='line'>    at createRenderFunc (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/swig/lib/swig.js:44:10)
</span><span class='line'>    at createTemplate (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/swig/lib/swig.js:96:14)
</span><span class='line'>    at getTemplate (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/swig/lib/swig.js:124:20)
</span><span class='line'>    at Object.exports.compile (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/swig/lib/swig.js:186:14)
</span><span class='line'>    at file.read.async.waterfall.compiled.replace.options.gutter (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/lib/plugins/processor/index.js:128:27)
</span><span class='line'>    at async.iterator.fn (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/async/lib/async.js:573:34)
</span><span class='line'>    at async.waterfall.wrapIterator (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/async/lib/async.js:489:34)
</span><span class='line'>    at process.startup.processNextTick.process._tickCallback (node.js:244:9)</span></code></pre></td></tr></table></div></figure>


<p>用尽各种蛋疼的办法才发现原来是有一篇文章里头的一段underscore代码块解析出了问题</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  
</span><span class='line'>{{ &gt; posts}}
</span><span class='line'> </span></code></pre></td></tr></table></div></figure>


<p>
吐血啊, 找了我老久.  原来是这个东西忘了套上 &#8220;{ % raw % }&#8221; &#8220;{ % endraw % }&#8221;<br/>
在Octopress(Liquid)里没套上的话则直接无视掉, 而Hexo(Marked)则直接嘣掉.</p>

<p>现阶段的plugins自然还是跟Octopress有些差距的,  不过挺看好的. 虽然暂时不撤往Hexo. 但还是弄了个<a href="http://xguoxlu.github.io/">github pages</a>, 喜欢折腾吧&#8230;</p>

<p>另外也顺带把404页面改成扣扣的公益页面了. 尽管知道不太可能起到什么作用&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[最近在折腾 -- deploy Meteor on heroku]]></title>
    <link href="http://xguox.github.com/blog/2013/04/06/deploy-meteor-on-heroku/"/>
    <updated>2013-04-06T23:42:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/06/deploy-meteor-on-heroku</id>
    <content type="html"><![CDATA[<p>貌似有好一段时间没有在这儿小发一些闷骚或者情感泛滥什么的, 都是用自己蹩脚的英语水平翻译些英文post. 这些天想部署个Meteor app玩一玩, 结果一玩就各种出事了.</p>

<p>vps退货, godaddy的莫名失单, 部署各种卡壳&#8230;</p>

<p>因为最近比较多的关注前端的东西,  同时在自己local耍着<a href="https://github.com/SachaG/Telescope">SachaG / Telescope</a>这个基于Meteor的项目. 于是也就顺手搭了<a href="http://frontn.com">FrontN</a>这么个类似HN, Reddit的玩意. 原本是准备直接把HN,Reddit clone 成中文版的, 不过<a href="http://news.dbanotes.net/">Fenng</a>貌似已经这么干了, 所以, 我也就不再造这个轮子了.另外原本也想专门作为<a href="http://jianshu.io">简书</a>的评论系统. 不过想想也不是很妥, 就&#8230;</p>

<p>Meteor的系统是超级alpha的, 所以很多问题遇上了也没人帮忙, 解决. 比如之前在<a href="http://stackoverflow.com/questions/15654637/same-helper-for-different-template">Stack Overflow</a>. 而部署这一块, 是我比较陌生的. 包括以前搞rails那会, 也没真正意义的整一整部署. 绝大部分时间都在本地跑啊跑. 所以, 在Meteor, 也是这一块最让我头疼.</p>

<!--more -->


<p>从vps到appfog到heroku, 各种转了一圈, 最终还是选定了heroku.  原因之一就是资料相对多, 出错情况也较少.</p>

<p>秉承流水帐作风, 待我慢慢道来.</p>

<p>幸得以前一直搞得是ruby/rails. 所以装heroku的时候没啥压力, 不然可能这又得搞上一会. 直接下载了官方的<a href="https://toolbelt.heroku.com/">heroku toolbelt</a>无压力安装, login, clone&#8230;</p>

<p>and then 跟着 <a href="https://github.com/oortcloud/heroku-buildpack-Meteorite">Heroku buildpack for Meteorite</a> 这个buildpack完成接下来的:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku create --stack cedar --buildpack https://github.com/oortcloud/heroku-buildpack-Meteorite.git</span></code></pre></td></tr></table></div></figure>


<p><strong>Please note: 在这如果你想把你的项目名改成想要的比如我改成了<a href="frontn.herokuapp.com">frontn.herokuapp.com</a>, 在heroku的项目页面上修改名字的同时, 记得把repo的git remote 也相应的更改</strong></p>

<p>否则就会报错</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku !  Resource not found</span></code></pre></td></tr></table></div></figure>


<p>好吧, 很明显我自己傻13了才会知道要这么做的.</p>

<p>接着到了最关键的push了.  当我<code>git push heroku master</code>的时候, bla,blah blah&#8230;下来还以为这次会真的很顺畅. 结果oops的一嘣</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>...
</span><span class='line'>...
</span><span class='line'>-----&gt; Launching... !     Heroku push rejected, Please verify your account to install this add-on
</span><span class='line'>For more information, see http://devcenter.heroku.com/categories/billing
</span><span class='line'>Verify now at https://heroku.com/verify</span></code></pre></td></tr></table></div></figure>


<p>纳尼,  原来这货还要用到一个mongo的数据库插件, 在这里是Mongohq, 原本没注意看以为直接
<code>heroku addons:add mongohq:sandbox</code>就OK
(sandbox是免费餐)</p>

<p>结果毫无疑问的继续嘣&#8230;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Adding mongohq:sandbox on frontn... failed
</span><span class='line'> !    Please verify your account to install this add-on
</span><span class='line'> !    For more information, see http://devcenter.heroku.com/categories/billing
</span><span class='line'> !    Verify now at https://heroku.com/verify</span></code></pre></td></tr></table></div></figure>


<p>Google之才知道原来Heroku在装插件前得通过传说中的credit card卡认证, 我辣时就更嘣了. 对于我等无产阶级而言, credit card仿佛就跟神一般滴遥不可及. 你想买3刀的godaddy域名?不好意思, 请出示credit card; 你想用name.com买域名? 不好意思, 请出示credit card; 你想买linode的vps?有credit card吗? 亲&#8230;正当我开始准备放弃heroku这条路时, 忽然无意中发现了虚拟信用卡这货, 顺藤摸瓜发现, 柳暗花明又一村.</p>

<p><strong>工行国际e卡 + entropay</strong>(怎么觉得我像在拍广告的)</p>

<p>虽然门路是找着了, 不过弄得我好不蛋疼.<br/>
因为mac上工行网银不支持插U盾, 于是又启动了以前的那台老爷机, 一卡一顿的, 唉, 为了搞到手就忍忍吧&#8230;结果成功申请后唬弄半晌才知道原来要先用软妹b买美刀才能花, 而且至少买50刀. 我现在要50刀搞毛线撒&#8230;没法子, 只得照办了. 然后是entropay的虚拟卡>>><br/>
OOXX一轮下来总算是把heroku的验证给通过了, 感动啊&#8230;</p>

<p><code>heroku addons:add mongohq:sandbox</code></p>

<p><code>git push heroku master</code></p>

<p>好吧, 总算是成功了. 我容易吗&#8230;</p>

<p>最后总结, heroku相对的来说除了出错情况较少, 可用资料多之外, 管理上也比自己搭vps要方便些, feel了一下MongoHQ的那个插件还不错&#8230;这样, 也就可以花更多的时间的app的开发上. 而不是折腾这出错那无解.  好吧, 尽管咱都爱折腾, 不过, 往你想的地方折腾不更好吗? 其实这些也就都是Paas的优势啦, 专注核心开发, 减少运维成本&#8230;</p>

<p>其他的待续吧, 相比rails, 或许底层它怎么干还没搞透, 但起码的知道它干了什么, 可Meteor我还真不知道它都干了些什么, 比rails更magic.</p>

<p>不管是否热爱前端的亲, 欢迎做客<a href="http://frontn.com">FrontN</a>. 有Bug那是必然的啦, 欢迎Feedback.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[5 Use Cases for Icon Fonts]]></title>
    <link href="http://xguox.github.com/blog/2013/03/25/5-use-cases-for-icon-fonts/"/>
    <updated>2013-03-25T15:48:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/25/5-use-cases-for-icon-fonts</id>
    <content type="html"><![CDATA[<p>Icon fonts非常的强大:</p>

<ul>
<li>You can CSS the crap out of them and they don’t mind.</li>
<li>在任何的显示器和分辨率上看起来都很不错</li>
<li>无论多大的icons集都只需要一次HTTP请求</li>
</ul>


<p>下面来看看5个典型的icon fonts用例.</p>

<h2>在开始之前</h2>

<p>为了让代码保持整洁和高可读性, 我们将不会用到浏览器前缀. 我们会用到的东西诸如animations, transitions, and transforms, 所有的这些为了确保更好的浏览器支持一般都需要添加hack前缀. 在这里你想如何处理浏览器前缀问题<a href="http://css-tricks.com/how-to-deal-with-vendor-prefixes/">由你自己决定</a>.</p>

<!-- more -->


<p>正如你在例子中可以看到的, 我使用的是icon fonts托管服务<a href="http://weloveiconfonts.com/">weloveiconfonts.com</a>. 这是一个我自己的项目&#8211;原本想写一篇文章关于icon-fonts, 搜索发现没有免费的icon fonts托管服务, 于是就新建了这么个项目来完成这篇文章.</p>

<h2>1. CSS Loader</h2>

<p>现今有许多<a href="http://codepen.io/stuffit/pen/vlfyA">很棒的</a>, <a href="http://codepen.io/FWeinb/pen/BeJLo">纯</a>CSS Loader, 你也可以在<a href="http://cssload.net/">cssload.net</a>上创建你自己的Loader. 而除此之外我们还可以使用<a href="http://css-tricks.com/flat-icons-icon-fonts/">icon fonts</a>来完成. 你可以使用一个看起来像Loading的符号,然后用CSS让其<a href="http://docs.webplatform.org/wiki/css/properties/animation/animation">动起来</a>.</p>

<p>以下这是基本的HTML. 开始是三个loader, 他们都是<code>div.wrapper</code>的子元素. 第四个(<code>div.complex</code>)是由两个icons组成.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-spin1&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-spin3&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-spin5&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;complex&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-emo-devil&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-spin4&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>导入icon font <a href="https://github.com/fontello/fontelico.font">Fontelico</a>到你的CSS之中.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">fontelico</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;fontelico-&quot;</span><span class="o">]</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;fontelico&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>给元素添加名为<code>load</code>的动画, 使得这些元素360度旋转, 可适当做一些调整或者更改颜色.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="c">/* Normal (left) */</span>
</span><span class='line'><span class="nt">span</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
</span><span class='line'>  <span class="k">text-align</span><span class="o">:</span> <span class="k">center</span><span class="p">;</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">5em</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">load</span> <span class="m">1.337s</span> <span class="n">infinite</span> <span class="n">ease</span><span class="o">-</span><span class="n">out</span> <span class="n">reverse</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c">/* Fast (center) */</span>
</span><span class='line'><span class="nc">.wrapper</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">2</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">load</span> <span class="m">.5s</span> <span class="n">infinite</span> <span class="n">linear</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c">/* Steps (right) */</span>
</span><span class='line'><span class="nc">.wrapper</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">3</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">load</span> <span class="m">1.25s</span> <span class="n">infinite</span> <span class="n">steps</span><span class="p">(</span><span class="m">18</span><span class="o">,</span> <span class="n">end</span><span class="p">)</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">load</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>    <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">10</span><span class="o">%</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">20</span><span class="o">%</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">30</span><span class="o">%</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">120</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">40</span><span class="o">%</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">50</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">180</span><span class="n">deg</span><span class="p">)</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>    <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">120</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">360</span><span class="n">deg</span><span class="p">)</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>    <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>将最后的那个loader(<code>div.complex</code>) 的两个icons堆叠在最上层. 第一个子元素为devil形状的icon(用的是名为<code>rotate</code>的动画), 第二个子元素为spin icon(使用名为<code>scale</code>的动画).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.complex</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">1</span><span class="o">),</span>
</span><span class='line'><span class="nc">.complex</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">2</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c">/* Devil icon  */</span>
</span><span class='line'><span class="nc">.complex</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">1</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">load</span> <span class="m">1.25s</span> <span class="n">infinite</span> <span class="n">steps</span><span class="p">(</span><span class="m">18</span><span class="o">,</span> <span class="n">end</span><span class="p">)</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c">/* Spin icon */</span>
</span><span class='line'><span class="nc">.complex</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">2</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">3em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">left</span><span class="o">:</span> <span class="m">-.35em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">top</span><span class="o">:</span> <span class="m">-.35em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">3</span><span class="p">);</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">devil</span> <span class="m">3s</span> <span class="n">infinite</span> <span class="n">linear</span> <span class="n">reverse</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">devil</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">-1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">50</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">-1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">-1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="FCsHe" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<h2>SocialCount meets Style</h2>

<p>人们都喜欢在他们的网站上使用一些社交分享按钮, 从而使得访问者可以轻易的传播他们的内容. 但是当你如果添加Facebook, Twitter, Google+, 那么你将要面临的是大约309KB的空缓存负载量. 这就是<a href="https://github.com/filamentgroup/SocialCount">SocialCount jQuery plugin</a>所存在的原因. SocialCount是渐进增强的, 并且可以lazy loaded以及对移动设备比较友好.</p>

<p>它的默认样式很简单且在iframe中包含的buttons也很少. 下面, 让我们为这些buttons添加一些CSS花样.</p>

<p>以下的HTML是由<a href="SocialCount%20markup%20generator">SocialCount markup generator</a>所创建. 其实也就是一些包含着链接和icons的无序列表.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;ul</span>
</span><span class='line'>  <span class="na">class=</span><span class="s">&quot;socialcount&quot;</span>
</span><span class='line'>  <span class="na">data-url=</span><span class="s">&quot;http://www.google.com/&quot;</span>
</span><span class='line'>  <span class="na">data-counts=</span><span class="s">&quot;true&quot;</span>
</span><span class='line'>  <span class="na">data-share-text=</span><span class="s">&quot;Google is a search engine&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;facebook&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://www.facebook.com/sharer/sharer.php?u=http://www.google.com/&quot;</span> <span class="na">title=</span><span class="s">&quot;Share on Facebook&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;count entypo-thumbs-up&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/a&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;twitter&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://twitter.com/intent/tweet?text=http://www.google.com/&quot;</span> <span class="na">title=</span><span class="s">&quot;Share on Twitter&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;count entypo-twitter&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/a&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;googleplus&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://plus.google.com/share?url=http://www.google.com/&quot;</span> <span class="na">title=</span><span class="s">&quot;Share on Google Plus&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;count entypo-gplus&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/a&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>接着在CSS中导入icon font(Entypo)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">entypo</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;entypo-&quot;</span><span class="o">]</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font</span><span class="o">:</span> <span class="m">2.5em</span><span class="o">/</span><span class="m">1.9em</span> <span class="s1">&#39;entypo&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>然后是重写SocialCount提供的默认样式:</p>

<ul>
<li>加入transition</li>
<li>缩放iframe</li>
<li>给buttons设定自定义的背景</li>
</ul>


<blockquote><p>Editor&#8217;s note: 以下的CSS所使用的是SASS的一种格式SCSS.  包括后边的也是. 如果你想要使用标准的CSS, 可以跳转到下边的CodePen 演示链接,  在CSS编辑框头部点击&#8221;SCSS&#8221;, 然后就可以看到经过编译后的标准CSS</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='sass'><span class='line'><span class="nc">.socialcount</span> <span class="err">{</span>
</span><span class='line'>  <span class="o">&gt;</span> <span class="nt">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">width</span><span class="o">:</span> <span class="mi">33</span><span class="kt">%</span><span class="err">;</span>
</span><span class='line'>    <span class="na">border-radius</span><span class="o">:</span> <span class="mi">0</span><span class="err">;</span>
</span><span class='line'>    <span class="na">transition</span><span class="o">:</span> <span class="n">all</span> <span class="mf">.3</span><span class="kt">s</span> <span class="n">ease-in-out</span><span class="err">;</span>
</span><span class='line'>    <span class="na">cursor</span><span class="o">:</span> <span class="no">pointer</span><span class="err">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="na">&amp;</span><span class="o">:</span><span class="n">hover</span> <span class="p">[</span><span class="n">class</span><span class="o">*=</span><span class="s2">&quot;entypo-&quot;</span><span class="p">]</span><span class="o">:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="na">opacity</span><span class="o">:</span> <span class="mi">0</span><span class="err">;</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">iframe</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">transform</span><span class="o">:</span> <span class="nf">scale</span><span class="p">(</span><span class="mi">1</span><span class="mf">.65</span><span class="o">,</span> <span class="mi">1</span><span class="mf">.65</span><span class="p">)</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.button</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">top</span><span class="o">:</span> <span class="mi">50</span><span class="kt">%</span><span class="err">;</span>
</span><span class='line'>    <span class="na">margin</span><span class="o">:</span> <span class="mf">-.75</span><span class="kt">em</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="err">;</span>
</span><span class='line'>    <span class="na">height</span><span class="o">:</span> <span class="mi">2</span><span class="kt">em</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.facebook</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">background</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">59</span><span class="o">,</span> <span class="mi">89</span><span class="o">,</span> <span class="mi">152</span><span class="o">,</span> <span class="mf">.7</span><span class="p">)</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">&amp;</span><span class="nc">.like</span> <span class="nc">.facebook</span> <span class="nt">iframe</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">width</span><span class="o">:</span> <span class="mi">8</span><span class="kt">em</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.twitter</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">background</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">172</span><span class="o">,</span> <span class="mi">237</span><span class="o">,</span> <span class="mf">.7</span><span class="p">)</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.googleplus</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">background</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">172</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mf">.7</span><span class="p">)</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="Czfyu" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<h2>3.Enhanced lists</h2>

<p>下边的三个例子都基于下边这个简单的HTML</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h2&gt;</span>Title<span class="nt">&lt;/h2&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li</span> <span class="na">data-text=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Text<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li</span> <span class="na">data-text=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Text<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li</span> <span class="na">data-text=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Text<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>导入 icon font (Font Awesome)到你的CSS</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">fontawesome</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;fontawesome-&quot;</span><span class="o">]</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;FontAwesome&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>为列表, 列表元素, <a href="http://css-tricks.com/almanac/selectors/a/after/">伪元素</a>以及button添加默认样式. 在这里我们不使用class来设定列表元素下的icon的样式, 取而代之是我们改变元素的<code>content</code>属性来创建一个伪元素.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nt">ul</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">list-style</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
</span><span class='line'>  <span class="k">padding</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="k">position</span><span class="o">:</span> <span class="k">relative</span><span class="p">;</span>
</span><span class='line'>    <span class="k">min-height</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>    <span class="k">padding</span><span class="o">:</span> <span class="m">.3em</span> <span class="m">.3em</span> <span class="m">.3em</span> <span class="m">1.5em</span><span class="p">;</span>
</span><span class='line'>    <span class="n">transition</span><span class="o">:</span>
</span><span class='line'>      <span class="k">background</span> <span class="m">.3s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span><span class="o">,</span>
</span><span class='line'>      <span class="k">color</span> <span class="m">.3s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span><span class="o">,</span>
</span><span class='line'>      <span class="n">box</span><span class="o">-</span><span class="n">shadow</span> <span class="m">.1s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span><span class="o">,</span>
</span><span class='line'>      <span class="k">height</span> <span class="m">.25s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span>
</span><span class='line'>   <span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">button</span> <span class="err">{</span>
</span><span class='line'>      <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>      <span class="k">left</span><span class="o">:</span> <span class="m">1.45em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">bottom</span><span class="o">:</span> <span class="m">.35em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">opacity</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">height</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">border</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
</span><span class='line'>      <span class="k">font-size</span><span class="o">:</span> <span class="m">.8em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
</span><span class='line'>      <span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">.4s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>      <span class="k">top</span><span class="o">:</span> <span class="m">.425em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;FontAwesome&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'>      <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">.35em</span> <span class="m">0</span> <span class="m">-1.35em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">vertical-align</span><span class="o">:</span> <span class="k">bottom</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">button</span> <span class="err">{</span>
</span><span class='line'>        <span class="k">opacity</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>        <span class="k">height</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>        <span class="k">right</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>        <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">2</span><span class="o">.</span><span class="m">5</span><span class="o">,</span> <span class="m">2</span><span class="o">.</span><span class="m">5</span><span class="p">)</span> <span class="n">translate</span><span class="p">(</span><span class="m">-.25em</span><span class="o">,</span> <span class="m">.15em</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="o">&amp;</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>        <span class="k">content</span><span class="o">:</span> <span class="n">attr</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="k">text</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3.1 Stuff You Love</h3>

<p>第一个示例很简单. 使用的是一个心形而不是默认的列表样式加特定的hover: icon会被移到右侧, 另外<code>::after</code>伪元素得到data-text这个<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedding-custom-non-visible-data-with-the-data-*-attributes">data-attribute</a>的文本</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.love</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-heart */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f004&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:before</span><span class="o">,</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">20</span><span class="o">,</span> <span class="m">20</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">background</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">20</span><span class="o">,</span> <span class="m">20</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">after</span> <span class="err">{</span>
</span><span class='line'>        <span class="k">width</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>        <span class="k">right</span><span class="o">:</span> <span class="m">.445em</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3.2 Downloads</h3>

<p>这是一个自定义列表下载扩展标记: 每个列表元素有一个链接和一个icon. 按钮被隐藏了, 只有当hover的时候才显示.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.downloads</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="k">border-bottom</span><span class="o">:</span> <span class="m">.15em</span> <span class="k">solid</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">3</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-download-alt */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f019&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">50</span><span class="o">,</span> <span class="m">50</span><span class="o">,</span> <span class="m">50</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">background</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">140</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">7</span><span class="p">);</span>
</span><span class='line'>      <span class="k">height</span><span class="o">:</span> <span class="m">4em</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">after</span> <span class="err">{</span>
</span><span class='line'>        <span class="k">right</span><span class="o">:</span> <span class="m">.35em</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">2</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3.3 Your account</h3>

<p>用户菜单的UI. 当你hover在一个列表元素上的时候, icon移动到右侧并且box-shadow填满整个背景. 基于<code>:nth-child</code>选择器和<code>content</code>属性, 每个列表元素都有一个自己的icon.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.account</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">padding</span><span class="o">:</span> <span class="m">.75em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">border</span><span class="o">:</span> <span class="m">.15em</span> <span class="k">solid</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">2</span><span class="p">);</span>
</span><span class='line'>  <span class="k">background-color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">7</span><span class="p">);</span>
</span><span class='line'>  <span class="k">background-image</span><span class="o">:</span> <span class="n">radial</span><span class="o">-</span><span class="n">gradient</span><span class="p">(</span><span class="k">center</span><span class="o">,</span> <span class="n">ellipse</span> <span class="n">cover</span><span class="o">,</span> <span class="n">rgba</span><span class="p">(</span><span class="m">104</span><span class="o">,</span><span class="m">104</span><span class="o">,</span><span class="m">104</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">6</span><span class="p">)</span> <span class="m">0</span><span class="o">%,</span><span class="n">rgba</span><span class="p">(</span><span class="m">23</span><span class="o">,</span><span class="m">23</span><span class="o">,</span><span class="m">23</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">7</span><span class="p">)</span> <span class="m">100</span><span class="o">%</span><span class="p">);</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="k">inset</span> <span class="m">0</span> <span class="m">0</span> <span class="m">.35em</span> <span class="m">0</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">2</span><span class="p">);</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>  <span class="n">backface</span><span class="o">-</span><span class="k">visibility</span><span class="o">:</span> <span class="k">hidden</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&amp;:</span><span class="n">nth</span><span class="o">-</span><span class="n">child</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-heart-empty */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f08a&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">2</span><span class="o">)</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-glass */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f000&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">3</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">margin-bottom</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-comment */</span>
</span><span class='line'>        <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f075&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">4</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">margin-bottom</span><span class="o">:</span> <span class="m">.5em</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-cog */</span>
</span><span class='line'>         <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f013&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">5</span><span class="o">)</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-signout */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f08b&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>      <span class="k">padding-left</span><span class="o">:</span> <span class="m">1.5em</span><span class="p">;</span>
</span><span class='line'>      <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="k">inset</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">10em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>        <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>        <span class="n">transform</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="tcklJ" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<h2>4. Emocons.js jQuery Plugin</h2>

<p><a href="https://github.com/TimPietrusky/emocons">Emojons.js</a>是一个搜索元素里特定字符序列内容的jQuery插件. 所有匹配上的都会用一个<code>span</code>和相应的icon HTML class来替换.<br/>
例如, 一个聊天app:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;chat&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    :D :) ;) :&#39;( :o :/ :( B) :P :|
</span><span class='line'>    :beer: :devil: :shoot: :coffee: :thumbsup: :angry: :ueber-happy:
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>接着在你的元素上调用 Emocons.js 插件的方法</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.chat&#39;</span><span class="p">).</span><span class="nx">emocons</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>现在, 所有在聊天时候的元素都会被转换成这样:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-emo-grin go&quot;</span> <span class="na">title=</span><span class="s">&quot;:D&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在CSS中导入icon font(Fontelico):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">fontelico</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;fontelico-&quot;</span><span class="o">]</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;fontelico&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>当 Emocons.js 把一个字符串转换成表情符号时, 会给<code>span</code>元素增加一个<code>go</code>类(添加一个动画效果).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.go</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">hey</span> <span class="m">.55s</span> <span class="m">1</span> <span class="n">linear</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">hey</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">50</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">-1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>一些表情符号会有特殊的样式(如颜色的改变)或者通过<code>::after</code>伪元素添加一些东西</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.fontelico-emo-devil</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span><span class="n">rgba</span><span class="p">(</span><span class="m">180</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">9</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.fontelico-emo-beer</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span>
</span><span class='line'>    <span class="m">-.475em</span> <span class="m">.75em</span> <span class="m">0</span> <span class="m">.275em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">220</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">1</span><span class="p">)</span><span class="o">,</span>
</span><span class='line'>    <span class="m">-.185em</span> <span class="m">.675em</span> <span class="m">0</span> <span class="m">.175em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">220</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">1</span><span class="p">)</span>
</span><span class='line'>  <span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.fontelico-emo-coffee</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span>
</span><span class='line'>    <span class="m">-.475em</span> <span class="m">.78em</span> <span class="m">0</span> <span class="m">.235em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">222</span><span class="o">,</span> <span class="m">184</span><span class="o">,</span> <span class="m">135</span><span class="o">,</span> <span class="m">1</span><span class="p">)</span><span class="o">,</span>
</span><span class='line'>    <span class="m">-.215em</span> <span class="m">.715em</span> <span class="m">0</span> <span class="m">.155em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">222</span><span class="o">,</span> <span class="m">184</span><span class="o">,</span> <span class="m">135</span><span class="o">,</span> <span class="m">1</span><span class="p">)</span>
</span><span class='line'>  <span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.fontelico-emo-shoot</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">.15em</span><span class="p">;</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="m">.315em</span> <span class="m">.525em</span> <span class="m">0</span> <span class="m">.1em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.fontelico-emo-angry</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">.15em</span><span class="p">;</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="m">-.695em</span> <span class="m">.455em</span> <span class="m">0</span> <span class="m">.085em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">220</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="KloGD" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<h2>5. Parallax Movie #1337</h2>

<p>最后的这个例子只是为了好玩吧. 它只是一个试验, 使用一个icon font来创建一个无穷的parallax movie. 创建场景的HTML包含有许多的元素.</p>

<ul>
<li>The setting: sky, ground, night and sun</li>
<li>Fixed element: bicycle</li>
<li>Animated elements: Trees, giraffe, shopping cart, buildings and heliport</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;night&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;sun&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;maki-fast-food&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;sky&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-bicycle&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-tree-1&quot;</span> <span class="na">data-child=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-tree-1&quot;</span> <span class="na">data-child=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-tree-1&quot;</span> <span class="na">data-child=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-giraffe&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-grocery-store&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-commerical-building&quot;</span> <span class="na">data-child=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-commerical-building&quot;</span> <span class="na">data-child=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-heliport&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ground&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在CSS中导入 icon font(Maki):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">maki</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;maki-&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="m">#fff</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;maki-&quot;</span><span class="o">]</span><span class="nd">:before</span><span class="p">{</span>
</span><span class='line'>  <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;maki&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">*</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">top</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">right</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">content</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">-1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>整个场景旋转 &#8220;-3度&#8221;.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.wrapper</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">140</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">120</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">-3</span><span class="n">deg</span><span class="p">)</span> <span class="n">translate</span><span class="p">(</span><span class="m">-10</span><span class="o">%,</span> <span class="m">-15</span><span class="o">%</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>当日落西山后, 场景变换为夜晚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.night</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">5</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">night</span> <span class="m">45s</span> <span class="n">infinite</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">night</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%,</span> <span class="nt">30</span><span class="o">%,</span> <span class="nt">100</span><span class="o">%</span> <span class="p">{</span><span class="k">background</span><span class="o">:</span><span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="p">);}</span>
</span><span class='line'>  <span class="nt">55</span><span class="o">%</span> <span class="p">{</span><span class="k">background</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>sky与ground都用的是同样的<code>background-position</code>动画, 只是速度有所不同.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.sky</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">relative</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">background</span><span class="o">:</span> <span class="sx">url(http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/bedge_grunge.png)</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span><span class="o">-</span><span class="n">bg</span> <span class="m">25s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.ground</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">background</span><span class="o">:</span> <span class="sx">url(http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/blackorchid.png)</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span><span class="o">-</span><span class="n">bg</span> <span class="m">7s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">rollin-bg</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://lea.verou.me/2012/02/moving-an-element-along-a-circle/">沿着圆周移动一个元素</a>(the burger-sun)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.sun</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">left</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">top</span><span class="o">:</span> <span class="m">10</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">4em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">line-height</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="k">circle</span> <span class="m">45s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span> <span class="m">3.85em</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.sun</span> <span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;maki-&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">240</span><span class="o">,</span> <span class="m">180</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">2</span><span class="p">);</span>
</span><span class='line'>  <span class="k">text-shadow</span><span class="o">:</span> <span class="m">0</span> <span class="m">0</span> <span class="m">.35em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">240</span><span class="o">,</span> <span class="m">240</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">7</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.sun</span> <span class="o">&gt;</span> <span class="nt">div</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">inner</span><span class="o">-</span><span class="k">circle</span> <span class="m">45s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">circle</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">from</span> <span class="p">{</span> <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">0</span><span class="n">deg</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">to</span> <span class="p">{</span> <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">360</span><span class="n">deg</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">inner-circle</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">from</span> <span class="p">{</span> <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">0</span><span class="n">deg</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">to</span> <span class="p">{</span> <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">-360</span><span class="n">deg</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>以下这个是唯一一个没有使用动画效果的元素, 但它看起来还是在移动.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.maki-bicycle</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">left</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">4</span><span class="p">;</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-.85em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">-.5em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">30</span><span class="o">,</span> <span class="m">30</span><span class="o">,</span> <span class="m">140</span><span class="o">,</span> <span class="o">.</span><span class="m">95</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这里全都是使用同样的滚动动画, 但速度不一的元素.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.maki-tree-1</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">5</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">5s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">2.4em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">110</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">8</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-tree-1</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">85</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">12s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">1.6em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">110</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-tree-1</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">25</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">17s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">1.2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">110</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">3</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-giraffe</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">.25em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">6</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">12s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">reverse</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">10em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">10</span><span class="o">,</span> <span class="o">.</span><span class="m">9</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-giraffe</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">right</span><span class="o">:</span> <span class="m">-3em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">content</span><span class="o">:</span> <span class="s1">&#39;\e82a \e82a \e82a \e82a \e82a&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font</span><span class="o">:</span> <span class="m">.2em</span> <span class="s1">&#39;Maki&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'>  <span class="k">letter-spacing</span><span class="o">:</span> <span class="m">.2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">3em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span>
</span><span class='line'>    <span class="m">0</span> <span class="m">.45em</span> <span class="m">0</span> <span class="m">.75em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">4</span><span class="p">)</span><span class="o">,</span>
</span><span class='line'>    <span class="m">1em</span> <span class="m">.35em</span> <span class="m">0</span> <span class="m">.75em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">4</span><span class="p">)</span><span class="o">,</span>
</span><span class='line'>    <span class="m">2.25em</span> <span class="m">.25em</span> <span class="m">0</span> <span class="m">1.05em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">4</span><span class="p">)</span>
</span><span class='line'>  <span class="p">;</span>
</span><span class='line'>  <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">transform</span><span class="o">:</span> <span class="n">translate</span><span class="p">(</span><span class="m">2.3em</span><span class="o">,</span> <span class="m">.55em</span><span class="p">)</span> <span class="n">rotateY</span><span class="p">(</span><span class="m">-180</span><span class="n">deg</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-grocery-store</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-.35em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">5</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">22s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">4em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">10</span><span class="o">,</span> <span class="o">.</span><span class="m">7</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-commerical-building</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">3</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">6s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">7em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">120</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="o">.</span><span class="m">8</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-commerical-building</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">14s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">4em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="o">.</span><span class="m">4</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-heliport</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-3.5em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">30</span><span class="o">,</span> <span class="m">30</span><span class="o">,</span> <span class="m">30</span><span class="o">,</span> <span class="o">.</span><span class="m">45</span><span class="p">);</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">1.25em</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">26s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">reverse</span> <span class="m">2s</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">rollin</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span><span class="k">margin-left</span><span class="o">:</span><span class="m">105</span><span class="o">%</span><span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span><span class="k">margin-left</span><span class="o">:-</span><span class="m">15</span><span class="o">%</span><span class="p">;}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="ELuiG" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<p>原文来自 Tim Pietrusky <a href="http://css-tricks.com/five-use-cases-for-icon-fonts/">5 Use Cases for Icon Fonts</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Improving UX Through Front-End Performance]]></title>
    <link href="http://xguox.github.com/blog/2013/03/20/improving-ux-through-front-end-performance/"/>
    <updated>2013-03-20T11:39:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/20/improving-ux-through-front-end-performance</id>
    <content type="html"><![CDATA[<p>想象一下,你正在一个马路口等待着过马路. You push the button to call the walk signal, and you take out your phone. 你想要完成某件事: 可能是查看邮件, 可能是给你的to-do列表添加一条item,又或者是阅读你的twitter. 你仅有有限的时间来完成这其中的一件事.</p>

<p>这所要花的长短取决于用户在你的网站上完成他们想做的事情的时长.这很重要.</p>

<p>据Google的一项研究, 用户的搜索结果页面每增加半秒会致使营业额和广告收入减少20%. 另外一篇来自Amazon的<a href="http://www.websiteoptimization.com/speed/tweak/psychology-web-performance/">类似报道</a>发现, 每增加额外的100毫秒加载时间, 销售额则会减少1%. 用户期望在两秒以内加载完整个页面, 否则第三秒后,高达40%的用户会<a href="http://www.gomez.com/pdfs/wp_why_web_performance_matters.pdf">选择离开</a>.</p>

<p>你能保持这样的速度? 如果你的网站包含有丰富的内容, 许多动态元素, 更大的JavaScript文件和复杂的图形, 那么我们当中的很多人的回答可能会是 &#8220;no&#8221;.</p>

<p>现在,是时候让我们把性能优化作为如何为各种设备设计, 搭建, 测试每一个我们创建的网站的基本组成部分了.</p>

<!-- more -->


<h2>Designing for performance</h2>

<p>网站的性能优劣从网站设计开始.权衡一个设计选择对你的网页速度的影响 你的网站的转化率. 你真的需要8个深浅不同的蓝色吗？这个宽度为1000px的背景图片还需要加什么值吗? 使用icon font来取代sprite会导致页面变得更重,渲染更慢, 还是会比使用原始图片更快呢?</p>

<p>并非所有的设计决策都是有利于性能的. 我发现一个略微减慢了页面速度的button样式可以提高转化(conversions), 对于仅需要牺牲小小的页面速度来说, 这是值得的.</p>

<p>但有时候, 我们更需要关注的是性能. 我曾经重新设计一个登录页面, 需要在上边为其添加大量的图片, 我不确定性能上变差了是否会对转化带来负面影响, 于是我在一个 <a href="http://alistapart.com/article/a-primer-on-a-b-testing">A/B test</a> 上为一小部分的用户推出了这个新的设计来看看会有什么样的反响. 新的设计加载时间是之前的两倍, 我看到了一个很高的 exit rate 和更低的转化率, 于是我们沿用了之前的轻量级设计. 犯错了没关系 &#8211; 它能给你一个参考的基准.</p>

<p>在另外一次试验, <a href="http://dyn.com/">dyn.com</a>主页上着重介绍的一个缩略图部分, 需要在10个图槽内交替显示26张图片.</p>

<p><img src="http://d.alistapart.com/371/dyncomhomepage.jpg" alt="dyn.com homepage." /></p>

<p>于是我的teammate把这26张的图片放到一个sprite里头, 结果:</p>

<ul>
<li>CSS,JavaScript,以及images的体积有所变大, 主页的总大小增加了<strong>60k</strong></li>
<li>请求数减少了<strong>21%</strong></li>
<li>页面总加载时间减少高达<strong>35%</strong></li>
</ul>


<p>这也就证明了这个试验是值得的: 我们也不确定这是否能给页面带来提速, 但我们都觉得这是值得学习的试验.</p>

<h2>Coding for performance</h2>

<p>清理你的HTML, 或许其他的一切也会跟着变好.</p>

<p>首先, 重命名你的HTML中的非语义化元素. 这可能会是最艰难的, 但只要你开始依据像<code>nav</code>,<code>article</code>这样的语义而不是通过图样或者网格来思考主题, 就会有显著的进展. 通常情况下, 我们是通过更复杂的CSS选择器来得到非语义化名称, 这样的话我们就会添加了不必要的ID和元素到HTML当中, 这反而会造成我们的CSS不够简洁, 同时也难以正确的使用某些特性.</p>

<p>其次, 就是整理你的CSS. 第一件事要做的是清除无效的选择器. 我在<a href="http://writegoodcode.com/">writegoodcode.com</a>中的<a href="http://dyn.com/how-we-got-dyndns-com-to-load-faster-and-how-you-can-learn-from-it">一次研究</a>发现, 在一个CSS文件中添加一些无效的选择器实际上会致使页面的加载时间增加<code>5.5%</code>. 更有效的CSS选择器也因为在样式表中更易阅读且有语义从而更易于将来的重设计和自定义样式. 多用途,可编辑的代码通常可以带来高性能. 在前面提到的那个研究中, 通过整理CSS文件我节省了<code>39%</code>的文件大小.</p>

<p>再次, 重点维护你的<code>div</code>. 通常你的标记越整洁, 那么你的CSS就会越小, 将来编辑,重设计也就更容易. 这不仅仅是提高了你的页面加载时间, 同时也为你节省了开发的时间.</p>

<p>最后, 专注于开发多用途的代码, 这样可以节省时间且减少CSS和HTML的大小. 更少的CSS和HTML可以明显地提高将来代码的可维护性和可重构性, 更轻的页面对加载速度有着积极的影响.</p>

<h2>Optimizing requests</h2>

<p>请求是指浏览器获取某样东西比如一个文件或者一个DNS记录. 你的标记越简洁, 浏览器也就更少的发出请求, 同时用户花在等待数据在客户端和服务端来回的时间就更少.</p>

<p>除了简洁的标记外, 还要做的是最小化JavaScript请求 &#8211; 只在确实需要的时候才加载之. 如果某一文件不是确实需要, 则不必在每一个页面都加载之. 不要在响应式设计中加载某一个只在大屏幕下才需要用到的JavaScript文件. 例如, 使用<a href="http://www.zurb.com/article/883/small-painful-buttons-why-social-media-bu">简单的链接来取代使用社交脚本</a>. 你也可以异步加载JavaScript从而不会导致所有的内容都被JavaScript给屏蔽掉.</p>

<p>尽管, 通常情况下响应式设计需要更多的CSS和图片(页面更重), 但还是可以通过减少请求来得到更快的页面加载速度.</p>

<h2>Optimizing images</h2>

<p>同样的, 尽你所能的减少图片的请求. 首先, 我们可以<a href="http://alistapart.com/article/sprites/">建立sprite</a>. 在 writegoodcode.com 的 研究中, 我发现一个案例使用icons sprite 后减少了<code>16.6%</code>的加载时间. 我喜欢通过创建一个背景重复的sprite来整理图片. 可能你需要创建的是水平重复或者垂直重复的.</p>

<p>接下来, 创建一个no-repeat backgrounds 的透明sprite. 这个sprite可以包含你的logo和icons. 如果你希望更先进一些, 可以使用像<a href="http://filamentgroup.com/lab/grunticon">Grunticon</a>这样的工具, 它可以使用SVG icon和background images,并基于用户浏览器的兼容性计算得出如何最好的为之服务.</p>

<p>在整理好所有新的图片后, 通过像<a href="http://imageoptim.com/">ImageOptim</a>这类的优化器运行. 同样的, retina-sized 的图片可以通过使用<a href="http://blog.netvlies.nl/design-interactie/retina-revolution/">extensive compression</a>使之变小, 不过最终结果不是特别显著.</p>

<p>现在, 看一看哪些图片你可以使用CSS3的渐变来替代. 这样做不仅仅是为了减少加载时间, 而且还可以使得在将来编辑页面变得极其简单, 因为开发人员无须找到原始图片进而编辑,生成,优化等.</p>

<p>最后, 来看看使用<a href="http://www.greywyvern.com/code/php/binary2base64">Base64 encode</a>, 它可以让你在CSS文件中嵌入图片而不是通过调用一个单独的URL. 通常看起来的结果如下:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nf">#nav</span> <span class="nt">li</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">content</span><span class="o">:</span><span class="sx">url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAI0lEQVQIW2P4//8/w8yZM//DMIjPAGPAMIiPWxCIMQQxzAQAoFpF7lGFr24AAAAASUVORK5CYII=)</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在一个小圆圈内随意添加一些字母和数字在很多地方都可以看到, 包括 dyn.com . 每次当你想要在你的设计中使用这类嵌入的图片, 可以让你节省一次图片请求. 这么嵌入图片会使你的CSS文件变得更大, 因此你需要测试嵌入前后的页面加载时间确保是有意义的.</p>

<h2>Measuring performance</h2>

<p>下面这部分比较有趣一些: 确认你的努力是否得到了回报.</p>

<p>Google的<a href="https://developers.google.com/speed/pagespeed/">PageSpeed</a>和Yahoo!的<a href="http://developer.yahoo.com/yslow/">YSlow</a>都而可以为你提供一些可以提高你的页面速度的建议, 包括确定哪个元素阻塞了页面渲染, 页面中不同的组件如HTML以及CSS的大小.</p>

<p>同时, 我也推荐YSlow的拓展 <a href="http://www.phpied.com/3po/">3PO</a>. 它可以检查你的网站所集成的一些流行的第三方脚本比如Facebook, Twitter, Google+等. 这个插件可以给你提高建议来进一步优化你的页面上的这些社交脚本进而提升页面速度.</p>

<p>自从我使用了PageSpeed 和 YSlow的建议来提高页面性能以后, <a href="http://webpagetest.org/">WebPageTest.org</a>已经成为我首选的基准参考工具. 它非常详细地给出关于请求, 文件大小, 时间等信息, 并且提供不同地方不同浏览器的测试.</p>

<p>确定基准可以在你设计的时候帮助你排除故障. 测量性能并分析结果可以帮助你的页面在大屏幕或者小屏幕上提速. 你可以测试或者定位像<a href="http://adactio.com/journal/5414/">conditional loading of images</a>这类技术从而在开发中更轻松应对性能问题.</p>

<h2>The impact of web performance</h2>

<p>网页的性能影响着你的用户&#8211;这意味着了解, 测量,提高性能问题是每个人的工作. 所有的这些技术都可以提高页面的加载速度. 进而可以显著的提高你的网站的用户体验.</p>

<p>用户更高兴了也就意味着更高的转化率, 无论你是按照什么来衡量, 或是收入, 注册数, 回访数, 还是下载数. 在更快的页面速度下, 用户可以使用你的网站在短时间内完成他们想要做的事&#8211;即使可能只是在等待红绿灯.</p>

<p>原文来自Lara Swanson <a href="http://alistapart.com/article/improving-ux-through-front-end-performance">Improving UX Through Front-End Performance</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[5 Meteor Misconceptions]]></title>
    <link href="http://xguox.github.com/blog/2013/03/14/5-meteor-misconceptions/"/>
    <updated>2013-03-14T16:52:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/14/5-meteor-misconceptions</id>
    <content type="html"><![CDATA[<p>由于某些原因，关于Meteor一直都有着各种各样的误解。或许是因为Meteor刚正式推出的时候， 缺失很多重要的功能。而很多不知道的是，这些缺陷在后来早就被修复了。</p>

<p>为了给Meteor正名，下面列举的是5个最常见的误解。</p>

<h2>误解#1：“Meteor的数据不安全”</h2>

<p>在Meteor的第一个Demo推出之时， 数据安全和用户权限这些东西是没有的。任何客户端的用户都能够访问，修改数据库的数据然后发送返回到服务端。</p>

<p>但这第一个版本只是作为一个提示告诉大家Meteor来了， 并不意味着它可以被用来打造一个真实的应用产品。 打那之后， 现在的Meteor已经有了一个内置的身份认证包（authentication package）。</p>

<!-- more -->


<p><strong>造成误解的另一个原因是， 许多新手为了更容易地快速上手常常在创建Meteor应用的时候， 遵循默认的把所有的数据发布给客户端。</strong></p>

<p>正如Meteor的开发者之一 <strong>Avital Oliver</strong>在<a href="http://stackoverflow.com/questions/10099843/how-secure-is-Meteor">StackOverflow上的回答</a>那样</p>

<blockquote><p>当你使用Meteor的命令行工具创建一个应用的时候， 默认的会包含有两个packages：<strong>AUTOPUBLISH</strong>和<strong>INSECURE</strong>. 这两个packages能使得每个客户端都拥有所有的服务器数据库读写权限效果。这是非常好的原型工具（目的只为了开发），但通常这不适合用于应用的生产环境。当你需要发布到生产环境的时候，请去掉这两个packages</p></blockquote>

<p>类似地，也因为Meteor可以共享服务端和客户端的代码，但实际上，这并不意味着所有的代码都可用于客户端.</p>

<p>所有放在<code>server/</code>目录下的东西都是只能在<a href="http://docs.Meteor.com/#structuringyourapp">服务端</a>执行使用的, 同时Meteor也让你可以定义<a href="http://docs.Meteor.com/#methods_header">服务端安全方法</a>，这些方法可以在客户端调用。</p>

<h2>误解#2：“Meteor对SEO不友好”</h2>

<p>与传统的网页应用不一样，Meteor不会在服务端搭建HTML页面。取而代之， 服务端只发送数据， 然后在客户端决定如何渲染之（这就是Meteor的“data on the wire”原则）</p>

<p>这种做法的缺点就是， 当JavaScript被禁用的话， 你的网站几乎跟一个空白页面无异。</p>

<p>你或许会觉得这会迷惑搜索引擎。但幸运地是， Meteor有解决的方案，那就是使用<a href="http://docs.Meteor.com/#spiderable">Spiderable</a> Package.</p>

<p><img src="http://theMeteorbook.com/images/phantomjs.png" alt="" /></p>

<p>这个package使用的是<a href="http://phantomjs.org/">PhantomJS </a>在服务端预渲染后提供给网络爬虫。实际上网络爬虫得到的网页跟你看到的是一样的。</p>

<h2>误解#3：“Meteor不支持第三方packages”</h2>

<p>有很多的讨论是关于Meteor所用的不是Node的标准包管理&#8211;NPM. 而事实上， Meteor压根就没有不允许使用第三方程序包.</p>

<p>And it’s true that the vanilla install of Meteor does not come with a package manager. 但庆幸的是， <a href="http://theMeteorbook.com/">本书</a>的合著者之一Tom Coleman， 同时也是Meteor包管理器<a href="https://github.com/oortcloud/Meteorite">Meteorite</a>和packages资源库<a href="http://atmosphere.Meteor.com/">Atmosphere</a>的开发者。</p>

<p>尽管当下Meteorite 和 Atmosphere还不是Meteor的官方部分， 但它们已经得到广泛的使用并将会在未来被合并到Meteor的核心部分。事实上，这方面的工作已经在Meteor的核心代码的<a href="https://github.com/Meteor/Meteor/tree/engine">engine</a>分支中开展，预期会被很快解决。</p>

<h2>误解#4：“Meteor是完全封闭的(walled garden)”</h2>

<p>一个密切相关的异议是,Meteor可以支持第三方packages,但这些第三方packages却严格地限制于流星的生态系统。</p>

<p>为什么有成千上万的Node packages 在那还要使用自定义的package呢？这又是否与开源精神相悖呢？</p>

<p>首先，需要意识到一点很重要的就是， 在Meteor中可以任意的使用node packages。尽管在当下这么做可能还会有一些棱角使得接口不那么顺利，但这种情况在<code>engine</code>分支添加<a href="https://groups.google.com/forum/?fromgroups=#!topic/Meteor-talk/b6zQrgk8lYo">Node support</a>
并发布后将得到很大改善。</p>

<p><img src="http://theMeteorbook.com/images/npm.png" alt="" />
其次，Meteor不仅仅是Node.js的一个框架， 更是一种全新的网站应用开发方式和构想.</p>

<p>换句话说，想知道为什么Meteor不使用NPM无异于问为什么它不能使用Ruby Gems. 有很多人建议所有的JavaScript代码应该都用NPM来管理， 但这么做的话会有一些细节上的问题， 正如核心开发者<a href="https://github.com/Meteor/Meteor/pull/516#issuecomment-12919473">解释说</a>.</p>

<h2>误解#5：“Meteor只适用于原型”</h2>

<p>“Meteor非常适用于小规模快速原型的项目，但它不适合用于大规模的应用.”</p>

<p>在某种程度上， 这很难争个谁对谁错。毕竟Meteor的主页的版本号还是以<code>0</code>开头.</p>

<p>但事实是Meteor还没准备到一个黄金时间，比起内在的局限性，在如此青涩的时期(不到一岁)Meteor还有许多需要做的。</p>

<p>再说， 即使是现在， 有时牺牲一点稳定性来做交换得到Meteor带来的轻松且快速的开发还是值得的。如果你希望看到一些具体的Meteor案例，我可以推荐看看<a href="http://telesc.pe/">Telescope</a>吗？</p>

<p>So，我坚信，在Meteor这样快速发展之下，今天的技术原型将会是明天thousand-user 的应用.</p>

<h3>总结</h3>

<p>现在，即使我们正在写这本关于Meteor的书， 但我们首先依旧会承认一点， 如同其他的技术那样，Meteor同样也有着自己的缺陷。</p>

<p>But I do believe Meteor has enough potential to make it worth evaluating it on its own merits. 所以如果你犹豫不决是否使用Meteor， 希望我的建议能说服你你选择它.</p>

<p>原文来自 Sacha Greif  <a href="http://theMeteorbook.com/2013/03/12/5-Meteor-misconceptions/">5 Meteor Misconceptions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introduction to Realtime Web with Meteor and Node.js]]></title>
    <link href="http://xguox.github.com/blog/2013/03/10/introduction-to-realtime-web-with-meteor-dot-js-and-node-dot-js/"/>
    <updated>2013-03-10T23:16:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/10/introduction-to-realtime-web-with-meteor-dot-js-and-node-dot-js</id>
    <content type="html"><![CDATA[<p>最近,有许多关于 <a href="http://derbyjs.com/">Derby.js</a>的激动人心的讨论涌现在了我的Twitter Timeline. 我从未使用过能够帮你做这么多&#8211;实时同步客户端和服务端 的框架. 从本质上讲, 这使得我们可以自己编写一个代码量很少的应用可以让两个人编写同一个 text field–live. 而 Derby帮你处理了在 models 和 views 之间所有的同步. 就如 Google Docs 的协作编辑那样.</p>

<p>这非常的伟大, 但经过深入的研究, 发现 Derby.js 并没有我想象中的那么成熟&#8211;目前还没有到1.0版本. 当然, Node.js 和 Meteor 也同样没有. 但相比起来, 似乎Derby缺少的更多一些. 比如, 据我目前知道的, 还没有一个好使的方法来处理sessions. 或许是因为缺乏文档的原因吧, 但是, 据说Derby的团队目前正在开发authentication. 如果有谁有一些关于Derby.js 处理sessions的新手指引, 我会很乐意去研究的.</p>

<p>另外一个我经常见到被拿来与Derby.js做比较的框架是<a href="http://Meteor.com/">Meteor</a>. 与Derby相似的是,它也能在多个客户端下实时更新views, 尽管做法上可能跟Derby有点不同. Derby可以较容易的使用多种数据库, 而Meteor则只亲近于<a href="http://mongodb.org/">MongoDB</a>. 事实上, 通过如<a href="http://mongoosejs.com/">Mongoose</a>客户端接入数据库的API与你在服务端所期望的已经非常接近了.</p>

<p>比起现在node的一些缺点和<a href="http://bjouhier.wordpress.com/2012/03/11/fibers-and-threads-in-node-js-what-for/">争议</a>, Meteor看起来是非常有趣的选择用来建立有实时需求的应用. 个人觉得还是Derby基于传统回调的编程形式更吸引我, 但在Derby的强大背后,却缺乏健壮的文档和一个大的开发者社区, 这无疑是个很大的打击. 或许这会随着时间推移而有所改变吧, 但比起Meteor来说还是会慢很多, 因为后者最近获得了1100万美元的资金. 这笔财政资金确保了Meteor的存在以及得到持续的支持. 对于那些需要财政与发展稳定的框架的开发者而言, 这笔资金只会让Meteor更加优胜.</p>

<!-- more -->


<p>今天,让我们一起来看看如何新建一个真实的但又简单的Meteor应用. 本质上说, 这是基于<a href="http://vimeo.com/40300075">Tom的 Vimeo screencast</a>的一个新手指引. 与Tom的 Vimeo screencast最大的不同是处理事件的方式. 比起复制粘贴一个Meteor示例的代码, 我会一步一步的通过自己的方式来处理使用Enter键来提交一则讯息. 让我们开始吧.</p>

<h3>Creating a Meteor App</h3>

<p>Derby和Meteor 他们共有的一个大加分是他们各自的命令行工具. 与Derby使用Node的内置的 npm 工具所不同的是, Meteor使用的是它自己的.</p>

<p>在终端(Mac OS X 和 Linux),执行如下的命令. (在这之前请确保你已经安装了Node)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl https://install.Meteor.com | /bin/sh</span></code></pre></td></tr></table></div></figure>


<p>接下来的事Meteor会自己搞定了.</p>

<p>要新建一个项目, 先转到你的工作目录然后运行下边的代码. 这会创建一个目录, 里边包括有Meteor和一个最基本模板程序.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ Meteor create chat</span></code></pre></td></tr></table></div></figure>


<p>现在, 你可以转到该目录并运行下面的代码让它跑起来</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd chat
</span><span class='line'>$ Meteor
</span><span class='line'>Running on: http://localhost:3000/</span></code></pre></td></tr></table></div></figure>


<p>想要看到这个最基础的应用程序, 你只需要在任意一款不过时的浏览器下打开<code>http://localhost:3000/</code></p>

<p>只要你想, 你可以使用Meteor内置的<code>Meteor deploy</code>命令来部署你的应用到Meteor自己的服务器上</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ Meteor deploy my-app-name.Meteor.com</span></code></pre></td></tr></table></div></figure>


<p>只要你更新保存了你的代码, 所有连接上的浏览器都会实时更新其页面.</p>

<h3>Developing the Chat App</h3>

<p>通过<code>Meteor create</code>命令生成的文件夹里, 你可以看到几个不同的文件. 如果你的系统设置了显示隐藏文件, 那还可以看到一个<code>.Meteor</code>文件夹. 这个文件夹包括的Meteor本身, 以及MongoDB数据库的文件.</p>

<p>在你的项目的根目录, 你可以看到的还有<code>chat.html</code> <code>chat.js</code> <code>chat.css</code>. 这三个文件自解释?的. HTML包含了这个应用的模板和视图, 并都通过<code>chat.css</code>来添加样式. 而这个JavaScript文件则包含了在客户端和服务端执行的代码. 这非常的重要&#8211;请不要把任何东西比如配置数据和密码都放在这里, 因为任何人都能通过查看你的应用程序的源文件看到.</p>

<p>用你最喜欢的文本编辑器打开<code>chat.js</code>. 我个人使用的是<a href="http://sublimetext.com/">Sublime Text 2</a>, 因为它很简洁并且有多光标功能.
你可以在<code>chat.js</code>看到下面这些代码</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">hello</span><span class="p">.</span><span class="nx">greeting</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="s2">&quot;Welcome to chat.&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">hello</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="s1">&#39;click input&#39;</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// template data, if any, is available in &#39;this&#39;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">console</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;You pressed the button&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Meteor</span><span class="p">.</span><span class="nx">startup</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// code to run on server at startup</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>分别注意到<code>if</code>语句里的<code>Meteor.is_client</code>和<code>Meteor.is_server</code>部分. 在这里边的代码分别只在客户端和服务端下执行. 这就是Meteor共用代码的能力了.</p>

<p>删除掉<code>Meteor.is_server</code>这段代码并把<code>if (Meteor.is_client)</code>里边的代码删除了,只留如下部分:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>注意到, 当你保存了你的脚本之后, 浏览器会马上重新加载这个新脚本.</p>

<h3>Creating the View</h3>

<p>在我们正式对这个脚本文件动工之前, 我们需要先新建一个视图用来展示聊天记录.
在编辑器里打开<code>chat.html</code>并删除<code>body</code>标签里边的代码. 包括名为hello的<code>template</code>标签.只留如下部分</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>chat<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>接着在<code>body</code>标签里添加下面这句</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>{{&gt; entryfield}}
</span></code></pre></td></tr></table></div></figure>


<p>Meteor使用的模板系统与<a href="http://mustache.github.com/">Mustache</a>很相似.大括号<code>{{}}</code>表示要呈现的内容. 通过简单地在两对大括号里添加内容如<code>{{hello}}</code>, 模板系统会用<code>hello</code>这个变量的值来替换它. 后面会更详细的介绍.</p>

<p>注意到了在<code>entryfield</code>这个词前面有个大于号<code>&gt;</code>了吗? 使用该符号来指定渲染哪一个模板.</p>

<p>接下来使用下面这段代码来新建一个名叫<code>entryfield</code>的模板</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;entryfield&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;name&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Name&quot;</span> <span class="nt">/&gt;</span> <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;message&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Your Message&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在这个例子中,<code>template</code>标签只有一个属性&#8211;用来表示这个template的名字. 也就是当我们渲染的时候需要用来指定的名字.</p>

<p>查看浏览器, 你会发现页面已经刷新了, 输入框已经呈现出来了.</p>

<p>接下来, 在body里边添加另外的一个mutache标签用以渲染讯息列表</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>{{&gt; message}}
</span></code></pre></td></tr></table></div></figure>


<p>最后, 我们还需要新建一个名叫<code>messages</code>的模板. 在<code>entryfield</code>模板下面添加下面这段代码</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;messages&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;p&gt;</span>
</span><span class='line'>        {{#each messages}}
</span><span class='line'>            <span class="nt">&lt;strong&gt;</span>{{name}}<span class="nt">&lt;/strong&gt;</span>- {{message}}
</span><span class='line'>       {{/each}}
</span><span class='line'>  <span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>注意到<code>each</code>子句. 在Meteor中你可以使用如下的语法来遍历一个数组模板</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>
</span><span class='line'>{{#each [name of array]}}
</span><span class='line'>{{/each}}
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>使用each循环时,上下文会有所改变. 当引用变量的时候, 实际上你引用的是每一个数组元素的值.
例如,在我们的chat应用中, 我们遍历了数组模板&#8221;messages&#8221;里边的每个元素, 该数组可以像下面这样,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">[</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello world!&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Hey, Andrew!&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>然后, 在each循环中, 你可以看到<code>{{message}}</code> <code>{{name}}</code>, 这会引用 每一个数组元素的值来替代(Andrew 和 Bob 替换 name, 以及各自的问候信息.)</p>

<p>当返回到你的浏览器, 你还看不到任何的改变. 因为讯息数组还没被传送到模板, 所以Meteor遍历不到任何东西来呈现.</p>

<p>你的<code>chat.html</code>最后应该是这样的</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>chat<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  {{&gt; entryfield}}
</span><span class='line'>  {{&gt; messages}}
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;entryfield&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;name&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Name&quot;</span> <span class="nt">/&gt;</span> <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;message&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Your Message&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;messages&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  
</span><span class='line'>    <span class="nt">&lt;p&gt;</span>
</span><span class='line'>      {{#each messages}}
</span><span class='line'>            <span class="nt">&lt;strong&gt;</span>{{name}}<span class="nt">&lt;/strong&gt;</span>- {{message}}<span class="nt">&lt;br/&gt;</span>
</span><span class='line'>        {{/each}}
</span><span class='line'>    <span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h3>The Javascript</h3>

<p>从现在开始, 我们处理的大部分代码都是客户端代码, 所以, 除非特别说明, 以下的代码都是在<code>if (Meteor.is_client)</code>代码块中.</p>

<p>在我们编写展示讯息的代码之前,让我们先新建一个<code>Collection</code>. 从本质上讲, 这是一组Models. 换句话说, 在这个chat应用的环境下, Messages collection保存着整个聊天记录, 而每条讯息记录是一个Model.</p>

<p>在if语句前, 添加如下代码来初始化Collection:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>因为我们希望这个Collection可以在客户端和服务端被创建, 所以我们把它写在了客户端代码块之外.</p>

<p>由于Meteor为我们做了大部分的工作, 要展示聊天记录是非常容易的. 只需要把下面的代码添加进if语句里边.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">messages</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span> <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">time</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>让我们拆开来分析这段代码:<br/>
<strong>Template</strong>.messages.messages = function(){ … }<br/>
第一部分<code>Template</code>表示我们正在修改一个模板的行为.<br/>
Template.<strong>messages</strong>.messages = function(){ … }<br/>
第二部分<code>messages</code>是模板的名字, 表示是在修改哪一个模板. 例如,如果我们想要对&#8221;entryfield&#8221;模板做些什么,   只需把代码改成<code>Template.entryfields.variable = function(){ … }</code>(在这里, 请别这么做)<br/>
Template.messages.<strong>messages</strong> = function(){ … }<br/>
第三部分的这个<code>messages</code>代表的是一个这个模板里的一个变量. 还记得我们的each循环遍历<code>messages</code>吗? 这就是那个mesaages.</p>

<p>当你打开浏览器时, 页面还是没有什么改变. 这是意料之中的事, 因为我们只抓取的讯息, 而没有展示出来.</p>

<p>此时,你的<code>chat.js</code>应该是这样的. 是否很惊讶就只需在服务器写这么些代码我们就能展示一个实时的聊天记录应用.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">messages</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span> <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">time</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Adding a Message through the Console</h3>

<p>这部分的内容是可选的, 当然它有助于你调试程序. 你可以直接跳过往下学习建立form来响应key press.</p>

<p>如果你想要测试你的讯息显示代码, 你可以手动插入一条记录到数据库. 打开你的浏览器控制台, 并输入如下:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Messages</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Andrew&#39;</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;Hello world!&#39;</span><span class="p">,</span> <span class="nx">time</span><span class="o">:</span> <span class="mi">0</span> <span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>这将会在数据库中新建一条记录, 如果正确的操作了的话,那浏览器就会即刻更新这条讯息在页面上.</p>

<h3>The Message Entry Form</h3>

<p>返回到<code>chat.js</code>, 我们即将要完成的是允许用户在输入框中提交聊天讯息到数据库. <br/>
在if语句里头最下面添加下面这段代码</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">entryfield</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;keydown #message&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">which</span> <span class="o">==</span> <span class="mi">13</span><span class="p">){</span>
</span><span class='line'>      <span class="c1">// Submit the form</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">Messages</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
</span><span class='line'>          <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">message</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">time</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>        <span class="nx">message</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这段代码比较多, 让我们一步步分析. 你应该还有印象, 紧跟<code>Template</code>之后的词表示我们即将要修改的template的名字. 跟前面修改的模板是<code>messages</code>不一样的是, 这里我们要修改的是<code>entryfield</code>.<br/>
template的<code>event</code>属性会包含有一个对象, 这个对象的keys的格式如下:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s2">&quot;[eventname] [selector]&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>比如, 如果我们想绑定了一个<code>click</code>事件给了ID为<code>hello</code>的按钮. 则需要像下面这样添加一个<code>events</code>对象</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s2">&quot;click #hello&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span> <span class="err">…</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在我们这个例子中,我们绑定了一个<code>keydown</code>事件给了ID为<code>message</code>的输入框. 这个输入框在我们一开始的<code>chat.html</code>已经建好.</p>

<p>在<code>events</code>对象里, 每一个key都有一个函数作为它的值. 当事件被触发的时候, 这个<code>event</code>对象会被作为第一个参数传给这个函数.在我们的chat应用, 每一次在输入框中按下一个按键(<code>keydown</code>), 这个函数都会被调用.</p>

<p>在函数里的代码非常简单. 首先, 我们先要检测按下的是否&#8221;enter&#8221;键(&#8220;enter&#8221;的keycode 是13). 接着,通过ID来得到两个输入框中的DOM元素. 最后, 我们检查确保输入框中的值不为空, 用户不允许发送空的名字和讯息.</p>

<p>下面的代码需要注意了, 它会被直接插入到数据库中</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Messages</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">message</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">time</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>你会发现,这其实跟我们直接在浏览器控制台中输入的代码很相似, 只是我们用DOM元素的值来替换固定值. 另外, 欧文木讷添加了时间值来确保是按照时间来排序.</p>

<p>最后,我们把两个输入框设置为空<code>''</code></p>

<p>现在, 你可以打开浏览器尝试在输入框输入名字和讯息. 按下&#8221;enter&#8221;后,输入框会被被清空, 而且这则讯息会立马出现在你的输入框下边. 使用另外一个浏览器窗口或者其他浏览器打开同样的链接(<code>http://127.0.0.1:3000</code>).    尝试输入一则新的讯息, 此时你就会看到Meteor的强大之处.无须单独写一行代码来更新讯息记录, 就可以实时同步在不同的客户端浏览器中.</p>

<h3>Conclusion</h3>

<p>While Meteor is pretty cool to work with and there are some pretty useful applications for it, like Derby.js, it is immature. For examples of this, just browse through the documentation and look for the red quotations. For example, the documentation states the following about MongoDB collections:</p>

<blockquote><p>Currently the client is given full write access to the collection. They can execute arbitrary Mongo update commands. Once we build authentication, you will be able to limit the client’s direct access to insert, update, and remove. We are also considering validators and other ORM-like functionality.</p></blockquote>

<p>对于任何一个产品而言, 用户拥有数据库的所有读写权限都是非常大的问题, 非常危险.</p>

<p>原文来自Andrew Munsell <a href="http://www.andrewmunsell.com/blog/introduction-to-realtime-web-Meteor-and-nodejs/#.UTyJZtHN-tv">Introduction to Realtime Web with Meteor and Node.js</a></p>

<p>另附上Tom的 Vimeo screencast(需FanQiang)<br/>
<video width='640' height='320' preload='none' controls poster=' http://b.vimeocdn.com/ts/278/431/278431171_960.jpg'><source src='http://av.vimeo.com/31624/419/93304834.mp4?aksessionid=d86b5b612c86d70bd2022ae1050aa1be&token=1362992353_ce10e413b18fa6f2d0e3483ef6b82894' type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'/></video></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Meteor基础与最佳实践]]></title>
    <link href="http://xguox.github.com/blog/2013/03/08/learn-meteor-fundamentals-and-best-practices/"/>
    <updated>2013-03-08T17:42:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/08/learn-meteor-fundamentals-and-best-practices</id>
    <content type="html"><![CDATA[<h2>引言</h2>

<p>想知道这个新奇又好玩的东西&#8212;Meteor是如何工作的?那就太好了,你来对地方了. 我会向你展示一个Meteor项目的方方面面 并会给你一些最好的提示让你应用在未来自己的Meteor项目当中.</p>

<h2>What is Meteor</h2>

<p>Meteor能让你打造非常动态的的网页同时代码量出乎意料之少. 记住一点,Meteor目前还在一个超级测试的版本(原文发布时候为 preview 0.3.8, 翻译时为 preview 0.5.7). 所以, 请不要因为工作的不够完美而感到意外.<br/>
Meteor是基于<a href="http://nodejs.org/">Node.js</a>, 因此, 你所写的大部分代码也将会是JavaScript. 这没什么好惊奇的. 如果你想要一些好的资源来快递提高你的JavaScript, 可以看一看 <a href="http://bonsaiden.github.com/JavaScript-Garden/">JavaScript Garden</a>.  <br/>
Meteor存储数据所使用的是MongoDB. 尽管如此, 实际上,Meteor使用的是minimongo作为接口.  它只是拥有相对完整的功能而非标准MongoDB的所有功能. 你并不需要确切地知道MongoDB是如何工作的, 但我还是建议你看一看Meteor 的<a href="http://docs.Meteor.com/#collections">Collections文档</a>以便知道你能做些什么.<br/>
Meteor目前使用的模板引擎只能是 <a href="http://handlebarsjs.com/">handlebars</a>. 但在未来支持使用别的模板引擎也是很有可能的.(翻译该文章时已经支持使用其他的如 Jade )<br/>
最后, 只要你开发网站, 了解 HTML 和 CSS 都是必须的.</p>

<h2>基础</h2>

<p>一个Meteor项目包含的大多都是JavaScript文件. 如果你放置任意一个 <code>*.js</code>文件在你的项目的任何位置, Meteor会自动帮你加载并运行之. 你在Meteor项目中写的每一个JavaScript文件都会被部署到服务端和客户端(额&#8230;也不完全是这样的,继续往下看吧!). 之所以Meteor这么,这么的cool,原因之一就是:当你写了一个JavaScript函数,在客户端和服务端都可以使用之!  <br/>
更cool的是, 比如,你在项目的任意一个地方放置<code>*.less</code>, 那么这些文件都会自动被编译并发送至客户端以及从而包含进页面当中.<br/>
有时候,可能你希望分离开服务端和客户端的代码. 幸运地是,<!-- more --> Meteor有这么一对标识可以帮你:<code>Meteor.is_server</code>和<code>Meteor.is_client</code> <br/>
下面的例子在浏览器的JavaScript控制台中会输出<code>Hi. I’m CLIENT</code>,而在服务端中则会输出 <code>Hi. I’m SERVER</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// This function is available on both the client and the server.</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">greet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Hi. I&#39;m &quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Everything in here is only run on the server.</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">greet</span><span class="p">(</span><span class="s2">&quot;SERVER&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Everything in here is only run on the client.</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">greet</span><span class="p">(</span><span class="s2">&quot;CLIENT&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这非常的简单. 在客户端和服务端共用代码使你能够做到最大化的代码复用,这大大地减少了开发时间.</p>

<h2>项目文档结构</h2>

<p>可能, 你无数次地希望不再服务端和客户端之间共享所有的一切. 比如你有一些私密的算法在服务端执行,而你绝不希望Meteor把这些算法发送至客户端让全世界都看得见. Meteor提供了两个&#8221;特殊&#8221;的目录来帮助分离客户端和服务端的代码:<code>[project_root]/client/</code>和<code>[project_root]/server/</code>. 在server目录的JavaScript只会在服务端执行而不会发送至客户端, 反之亦然. 这就使得我们无须在各个地方都使用<code>Meteor.is_client</code>  和 <code>Meteor.is_server</code>.取而代之, 对应的放置你的代码就OK了.</p>

<p>项目的文件结构非常重要, 尤其在考虑到文件的先后加载顺序的时候. 假定有两个文件, 其中一个依赖于另外一个, 你知道你的JavaScript的加载顺序吗?  其规则如下:</p>

<ol>
<li> <code>[project_root]/lib</code>里的文件会最先被加载. 显而易见的,  库需要放在这个文件</li>
<li>文件会根据目录的深度来进行加载排序,放在深一层的文件会先加载</li>
<li>同一级的文件会按照字母顺序来排序加载.</li>
<li> <code>main.*</code> 会最后加载, 当有代码需要在其他所有的库或脚本之后执行这会很有用.</li>
</ol>


<p>Meteor有一些特殊的目录来帮助你解决分离 <code>client/server</code>的代码以及加载的顺序:</p>

<ul>
<li><code>[project_root]/lib/</code>  该目录下的代码会在你的 client/server 代码执行之前加载</li>
<li><code>[project_root]/client/</code> 这个目录下的代码只会在浏览器端而不会在服务端执行</li>
<li><code>[project_root]/server/</code> 这个目录下的代码只会在服务端而不会客户端执行</li>
<li><code>[project_root]/public/</code> 静态文件放在这个目录下, 并且你可以很轻松地在你的html中指向 image.jpg</li>
<li><code>[project_root]/.Meteor/</code> 一些特殊的,和项目相关的的信息放在这里,  比如你安装的某些模块. 你几乎可以不用关心这里边的东西</li>
</ul>


<h2>响应(Reactivity)</h2>

<p>Meteor 通过 响应数据源(“reactive” data sources) 和 上下文(context) 帮你省去了当数据改变时手动替换页面的麻烦. 当响应数据源被更新后,响应上下文会重新运行(A reactive context is just a function that will get re-run if it contains a reactive data source that gets updated.) 刚开始的时候要把思维转换过来可能有些难, 下面的例子将为你解释清楚. <br/>
下面是一个html页面和一个叫<code>cool_dude</code>Meteor<a href="http://docs.Meteor.com/#templates">模板</a>, 以及一个在客户端运行的JavaScript函数&#8212;传一个<code>username</code>的值给模板用以渲染.
Liquid error: undefined method `join&#8217; for #&lt;String:0x007fc29b2db288></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;cool_dude&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;important&quot;</span><span class="nt">&gt;</span>{{ username }} sure is one cool dude!<span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// On the client:</span>
</span><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">cool_dude</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="s2">&quot;Andrew Scala&quot;</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>当页面被渲染的时候会输出 <code>“Andrew Scala sure is one cool dude!”</code></p>

<p>模板即是响应的上下文: 如果它依赖于响应数据源, 那么当数据源改变时它会重渲染自身. 客户端的<code>session</code>一种响应数据源. 它只会在客户端存储一些键值对, 且当页面刷新的时候被擦除.</p>

<p>让我们把上面的例子模板上下文改为响应数据源:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// When the app starts,</span>
</span><span class='line'><span class="c1">// associate the key &quot;username&quot; with the string &quot;Andrew Scala&quot;</span>
</span><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">startup</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">,</span> <span class="s2">&quot;Andrew Scala&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">cool_dude</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>现在,模板将会在<code>Session</code>里取到<code>username</code>的值. 在响应上下文我们有一个响应数据源. 如果存储在<code>Session</code>的<code>username</code>的值更改了, 模板会重新渲染新的值到页面上. 如给<code>username</code>设置一个新的值:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">,</span> <span class="s2">&quot;Bill Murray&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>只要执行了这行代码,不管在哪, 页面都会立马输出<code>Bill Murray sure is one cool dude!</code><br/>
在这里, 我会列出其他的响应上下文和数据源,你也可以到 Meteor的<a href="http://docs.Meteor.com/#reactivity">Reactivity文档</a>自行阅读.</p>

<h2>发布/订阅</h2>

<p><strong>Note: 在每一个项目的根目录下执行<code>$ Meteor remove autopublish</code>, 否则它会默认发布你的所有数据到客户端, 这显然不是个好的做法</strong></p>

<p>服务端发布数据给客户端使用, 同时,客户端向服务端订阅已发布的数据. 在刚开始, 想要明白服务端发布数据和客户端订阅数据的关系会有些困难. 常规的经验是这样的: <strong>客户端只能访问当前时间点需要操作的数据, 除此之外的均不能访问</strong>. 举个例子, 如果你有一个聊天应用, 客户端不能够接收你的网站上每一个频道的所有信息, 而只能是当前所访问的频道的信息. 同样的也不能够知道别的频道的用户.</p>

<p>下面这是一个关于 发布/订阅 的方面教材,  客户端可以看到数据库中的每一条信息:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>当在客户端<code>Messages.find({})</code>,可以得到数据库里的每一条信息.<br/>
我们可以指定一个参数使得在订阅的时候缩小范围只获取实际需要的信息(如在<code>"cool_people_channel"</code>频道中的信息)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">channel_name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">channel</span><span class="o">:</span> <span class="nx">channel_name</span><span class="p">});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;current_channel&quot;</span><span class="p">,</span> <span class="s2">&quot;cool_people_channel&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">autosubscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">Meteor</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">,</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;current_channel&quot;</span><span class="p">));</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://docs.Meteor.com/#Meteor_autosubscribe">Meteor.autosubscribe</a>是一个响应上下文, 意思是只要有响应数据源更新,所有在里头的东西都会重运行. 我们把当前所在的频道存储在Session的<code>"current_channel"</code>. 如果这个session值改变, 那么订阅(subscription)也就更新,
这样我们就能够访问其他的信息了. 如果用户想要加入<code>“breakfast talk”</code>这个频道. 我们可以运行<code>Session.set("current_channel", "breakfast_talk")</code>, 这会触发autosubscribe, 让我们可以且仅可访问<code>"breakfast_talk"</code>频道下的信息.</p>

<p>或许,你很多次都希望发布所有的collection到客户端. 仔细思考客户端实际需要的是什么. 比起发送所有的文档, 只发送特定领域会来得明智些.</p>

<h2>服务端方法</h2>

<p>由于客户端不允许查看数据库中有什么东西, 你一对会好奇客户端又是如何存储信息的. 解决办法是使用Meteor的<a href="http://docs.Meteor.com/#methods_header">服务端方法(Server Methods)</a>. 你在服务端定义了所有的函数用以一些危险的做法比如修改和更新数据, 然后让客户端像调用常规方法那样call这些函数并返回值. 客户端永远也不会看到具体的实现,也不会自己修改数据. 这些都是服务端做的事.<br/>
想要添加一个用户到数据库中, 假定有一个叫<code>create_user</code> 的方法&#8211;传入一个username并让服务端插入一条记录. 它会返回给客户端一个<code>ObjectID</code>这样客户端可以抓取到这个用户的信息并做任何接下来要做的事.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">methods</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">create_user</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">username</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;CREATING USER&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="kd">var</span> <span class="nx">USER_id</span> <span class="o">=</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="nx">username</span><span class="p">});</span>
</span><span class='line'>            <span class="k">return</span> <span class="nx">user_id</span><span class="p">;</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Remember, the client&#39;s browser only ever sees the code below:</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="s2">&quot;Andrew Scala&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;create_user&quot;</span><span class="p">,</span> <span class="nx">username</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">user_id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="nx">user_id</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在这个例子中我的 user_id被设置到客户端session中, 当任意模板使用到我的user_id
 的时候均立马可以得到更新.</p>

<h2>保护你的数据</h2>

<p>默认的, 你可以在客户端打开一个JavaScript 控制台并<strong>运行数据库查询</strong>.这非常的不安全.最糟糕的情况是, 当我们在访问你这么cool的Meteor应用时可以运行<code>Users.remove({})</code>来擦除你的所有数据.</p>

<p>Meteor即将会做一些措施来更好的保护你的数据, 但截至目前为止这是唯一的方法可以做到保护的. 这些代码被包含在了基于 Meteor的 <a href="http://madewith.Meteor.com/">madewith</a>网站中.这个代码片段阻止了从客户端进行insert/update/remove等操作. 把下面这段代码放在你的服务端代码中的任意位置:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// Relies on underscore.js. In your project directory:</span>
</span><span class='line'><span class="c1">// $ Meteor add underscore</span>
</span><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">startup</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">collections</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;collection_name_1&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_2&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">collections</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">collection</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s1">&#39;insert&#39;</span><span class="p">,</span> <span class="s1">&#39;update&#39;</span><span class="p">,</span> <span class="s1">&#39;remove&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">Meteor</span><span class="p">.</span><span class="nx">default_server</span><span class="p">.</span><span class="nx">method_handlers</span><span class="p">[</span><span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">collection</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>敬请关注</h2>

<p>准备好开发一个真实的Meteor项目了吗?一起期待吧, Part 2 就在路上了.届时将引导你完成一个完整的app!</p>

<p>原文来自Andrew Scala <a href="http://andrewscala.com/Meteor/">Learn Meteor Fundamentals and Best Practices</a>  <br/>
Ps:文章有点老,XD&#8230;不过就像该篇文章的作者所说, Meteor 现在还是处于一个 super-beta 阶段, 版本更新自然会相对来得快些. 据说1.0版本将会在不到一年的时间内发布.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A Look at a Meteor Template]]></title>
    <link href="http://xguox.github.com/blog/2013/03/06/a-look-at-a-meteor-template/"/>
    <updated>2013-03-06T14:40:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/06/a-look-at-a-meteor-template</id>
    <content type="html"><![CDATA[<h5>LEVEL: BEGINNER</h5>

<p>学习一门语言或框架的最好方法之一是从零开始开发一个应用程序.</p>

<p>但是,当你开发了N次的To-do list应用之后, 或许你会想要一些稍微新鲜的玩意. 所以这一次, 让我们来看看一些实际的应用的代码, 这里我们用的是 <a href="http://telesc.pe/">Telescope</a></p>

<p>Telescope是一个基于Meteor的开源社交新闻网站. <a href="http://reddit.com/">Reddit</a> or <a href="http://news.ycombinator.com/">Hacker News</a>的实时版本.</p>

<p>我们即将看到的代码是简化版的<code>post_edit</code><a href="https://github.com/SachaG/Telescope/blob/master/client/views/posts/post_edit.html">模板</a>及其<a href="https://github.com/SachaG/Telescope/blob/master/client/views/posts/post_edit.js">控制器(controller)</a>. 听名字你应该就知道, 这个模板的作用是提供一个简单的表单来编辑一篇已经存在的post. post有标题(title), 链接(URl), 主体(body), 以及一个或多个的类别(categories). 该程序实际的表单中还会有一些额外的东西, 但我们现在不需要关心那些.<br/>
<img src="http://theMeteorbook.com/images/telescope-post-edit.png" alt="" /></p>

<p>这篇文章的目的是让你对Meteor的模板有个大概的认识. 如果你在其他的环境下使用过模板系统就会感到很熟悉, 如果没的话,那就现在开始学习吧.</p>

<h2>Basic Organization</h2>

<p>Meteor模板系统有两个部分组成,分别是: HTML模板和JavaScript控制器. HTML部分只是纯粹的有变量占位符的哑巴模板, 所有的实际动作都是通过JavaScript产生的.</p>

<!-- more -->


<p>顺便说句, Meteor通过<code>template</code>标签的<code>name</code>属性来得到这个模板的名字(<code>&lt;template name="post_edit"&gt;</code>), 因此,建议使用同一名字命名所有相关的文件和模板本身, 如在这个例子中的<code>post_edit.html</code>和<code>post_edit.js</code></p>

<figure class='code'><figcaption><span>post_edit.html template</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;post_edit&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  
</span><span class='line'>  {{#with post}}
</span><span class='line'>    <span class="nt">&lt;form&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label&gt;</span>Title<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;title&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;{{headline}}&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label&gt;</span>URL<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;url&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;{{url}}&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label&gt;</span>Body<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        <span class="nt">&lt;textarea</span> <span class="na">id=</span><span class="s">&quot;body&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">class=</span><span class="s">&quot;input-xlarge&quot;</span><span class="nt">&gt;</span>{{body}}<span class="nt">&lt;/textarea&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label&gt;</span>Category<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        {{#each categories}}
</span><span class='line'>          <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&quot;checkbox inline&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;category_{{_id}}&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">value=</span><span class="s">&quot;{{_id}}&quot;</span> <span class="na">name=</span><span class="s">&quot;category&quot;</span> <span class="err">{{</span><span class="na">hasCategory</span><span class="err">}}</span> <span class="nt">/&gt;</span> {{name}}
</span><span class='line'>          <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        {{/each}}
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;form-actions&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;delete-link&quot;</span> <span class="na">href=</span><span class="s">&quot;/posts/deleted&quot;</span><span class="nt">&gt;</span>Delete Post<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/form&gt;</span>
</span><span class='line'>  {{/with}}
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>post_edit.js controller</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">post_edit</span><span class="p">.</span><span class="nx">helpers</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">post</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">categories</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Categories</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">();</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">hasCategory</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">));</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">categories</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;checked&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">post_edit</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="s1">&#39;click input[type=submit]&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">selectedPostId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">categories</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;input[name=category]:checked&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">categories</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">title</span><span class="o">:</span>         <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#title&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
</span><span class='line'>      <span class="nx">url</span><span class="o">:</span>           <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#url&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
</span><span class='line'>      <span class="nx">body</span><span class="o">:</span>          <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#body&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
</span><span class='line'>      <span class="nx">categories</span><span class="o">:</span>    <span class="nx">categories</span><span class="p">,</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">Posts</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">,</span> <span class="p">{</span><span class="nx">$set</span><span class="o">:</span> <span class="nx">properties</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">alert</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">reason</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s1">&#39;click .delete-link&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nx">confirm</span><span class="p">(</span><span class="s2">&quot;Are you sure?&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">selectedPostId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">Posts</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>代码看起来很多, 但是只要拆开来看,即使你从未看过Meteor的代码也会觉得很容易.</p>

<h2>Handlebars Tags</h2>

<p>首先来快速浏览下HTML部分. 你一定注意到这种奇怪的标签用法了吧. 这些都是<a href="http://handlebarsjs.com/">Handlebars</a>标签用来让我们展示动态数据.
先来看第一个handlebars标签<code>{{#with post}}</code></p>

<figure class='code'><figcaption><span>The &#8220;with&#8221; block helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;post_edit&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>  {{#with post}}
</span><span class='line'>    <span class="c">&lt;!-- do something with &quot;post&quot; --&gt;</span>
</span><span class='line'>  {{/with}}
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://handlebarsjs.com/block_helpers.html">block helper</a>是一种快捷的方式告诉我们要在哪个模板对象上工作. 在<code>{{#with post}}</code>block里, 我们的应用知道<code>this</code>代表一个<code>post</code>. <code>this</code>也是传说中方法的上下文.</p>

<h2>Template Helpers</h2>

<p>你可能会好奇,我们是从哪里得到<code>post</code>, 找到你的controller里的</p>

<figure class='code'><figcaption><span>The &#8220;post&#8221; template helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">post_edit</span><span class="p">.</span><span class="nx">helpers</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">post</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>在这我们要做的是添加一个<code>post</code><a href="http://docs.Meteor.com/#template_helpers">Template Helper</a>到我们的<code>post_edit</code>模板. Template helpers 是一些简单的JavaScript方法允许你使用 Handlebars template.</p>

<p>在这个例子中,不管任何时候我们的Handlebars模板调用<code>post</code>, 我们都能在我们的<code>Posts</code> collection 中找到current post并返回之. 要做到这样首先我们需要用到<code>selectedPostId</code>这个通过路由设置的Session变量(but that’s for another lesson)</p>

<h2>Object Properties</h2>

<p>继续往下, 我们将看到第二个handlebars标签<code>{{title}}</code></p>

<figure class='code'><figcaption><span>The &#8220;title&#8221; template helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>Title<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;title&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;{{title}}&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>尽管不能用什么方式告诉你这个<code>{{title}}</code>不是一个Template helper, 而是我们的<code>post</code>对象的属性之一. 无须任何其他的工作,Meteor很神奇地提供给了我们使用的.</p>

<h2>Nested Objects</h2>

<p>链接(URL)和主体(Body)表单域用的都是相同的模式, 而类别(Category)域则有些不同了.在这里, 我们希望通过类别检查展示一系列复选框给所有网站的预定义类别.</p>

<p>首先的工作是准备一系列的类别选择, 我们通过<code>{{#each categories}}</code>这个block helper来完成:</p>

<figure class='code'><figcaption><span>Looping over categories with the &#8220;each&#8221; helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>Category<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  {{#each categories}}
</span><span class='line'>    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&quot;checkbox inline&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;category_{{_id}}&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">value=</span><span class="s">&quot;{{_id}}&quot;</span> <span class="na">name=</span><span class="s">&quot;category&quot;</span> <span class="err">{{</span><span class="na">hasCategory</span><span class="err">}}</span> <span class="nt">/&gt;</span> {{name}}
</span><span class='line'>    <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  {{/each}}
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>这个helper完成了两件事: 遍历<code>categories</code>对象, 以及在代码块里使用<code>this</code>来表示每一个遍历结果.</p>

<p>或许你已经猜到, <code>categories</code>像<code>posts</code>那样是一个Template helper. 在这个例子中,我们只返回了在我们的数据库中的一系列类别(categories)</p>

<figure class='code'><figcaption><span>The &#8220;categories&#8221; template helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>  <span class="nx">categories</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Categories</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>还记得我说过block helper 会改变<code>this</code>的值吗?这就是为什么我们能看到<code>{{_id}}</code>而不会混乱. 因为这事在block helper里边, 因此可以知道,我们处理的是category的ID,而不是post的ID</p>

<h2>More Helpers</h2>

<p>到目前为止, 我们的helper简单地查询了我们的collections并返回了数据. 但helper却不仅限于此. 让我们一起看一看 <code>{{hasCategory}}{endraw}</code>这个helper</p>

<figure class='code'><figcaption><span>The &#8220;hasCategory&#8221; template helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">hasCategory</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">categories</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;checked&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>还记得吧, 我们是在block <code>{%raw%}{{#each categories}}</code>里调用了这个helper, 这就意味着这里<code>this</code>表示的是category</p>

<p>那么我们现在是首次得到我们的current post对象, 然后检查看current category是否包含在这个post的categories里.如果包含有, 则我们很容易地返回&#8221;checked&#8221;字符串用以标记我们这个复选框被选中.</p>

<p>你可能已经注意到, <code>_.contains()</code>是一个 <a href="http://underscorejs.org/">Underscore</a>方法. Underscore是一个非常有用的JavaScript工具包并被内置绑定到了Meteor里边.</p>

<h2>Template Events</h2>

<p>我们现在的代码足够用来加载一篇post的标题,URL,主体,以及类别了. 但还是需要一种保存这个表单的方法. 也就是下面的模板事件(template events)</p>

<figure class='code'><figcaption><span>Template events</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">post_edit</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="s1">&#39;click input[type=submit]&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// do something when the users clicks input[type=submit]</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s1">&#39;click .delete-link&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// do something when the users clicks .delete-link</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>如你所见, 定义 template events其实就是简单把事件和CSS选择器放在一起. 在这里我们有两个处理监听,一个是提交表单,另一个是删除post.<br/>
先来看看表单提交处理:</p>

<figure class='code'><figcaption><span>Our form submit handler</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s1">&#39;click input[type=submit]&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">selectedPostId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">categories</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;input[name=category]:checked&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">categories</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">title</span><span class="o">:</span>         <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#title&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
</span><span class='line'>    <span class="nx">url</span><span class="o">:</span>           <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#url&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
</span><span class='line'>    <span class="nx">body</span><span class="o">:</span>          <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#body&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
</span><span class='line'>    <span class="nx">categories</span><span class="o">:</span>    <span class="nx">categories</span><span class="p">,</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Posts</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">,</span> <span class="p">{</span><span class="nx">$set</span><span class="o">:</span> <span class="nx">properties</span><span class="p">});</span>
</span><span class='line'><span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>处理方法带有两个参数, event 和 template 实例. 现在, 我们可以忽略template 实例. 使用<code>e.preventDefault();</code>来开始你的处理可以很好的阻止浏览器执行默认的事件行为.</p>

<p>如你所见, 这里有大量的<code>$</code>符号. 除了Underscore, Meteor还绑定了jQuery. 看吧, 你已经了解了Meteor的一半了.</p>

<p>再来一次, 处理categories相较于其他的来说比较麻烦一些.  通过使用jQuery, we’re checking for checked checkboxes(敢不敢把这句话说上10次,LOL)并使用他们的ID来填充给一个数组.</p>

<p>接下来我们就能够建立我们的属性对象, 并使用Meteor的<a href="http://docs.Meteor.com/#update">update()</a>可以简单地提交我们的修改给数据库.</p>

<p>删除post更是简单</p>

<figure class='code'><figcaption><span>Our post delete handler</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s1">&#39;click .delete-link&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="nx">confirm</span><span class="p">(</span><span class="s2">&quot;Are you sure?&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">selectedPostId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">Posts</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>只需要简单地把要删除的ID传送给Meteor的<a href="http://docs.Meteor.com/#remove">remove()</a>方法就搞定.</p>

<h2>Other Callbacks</h2>

<p>Meteor给管理模板提供了一些其他的回调, 比如<a href="http://docs.Meteor.com/#template_created">created</a>和<a href="http://docs.Meteor.com/#template_rendered">render</a>回调</p>

<p>尽管我们在这里没有使用到, 但只要Meteor完成渲染一个模板, 那么<code>rendered</code>回调可以很容易的通过jQuery来做一些DOM操作.</p>

<h2>Conclusion</h2>

<p>CRUD (Create, Read, Update, Delete)操作经常就是组成网站的主要功能. Meteor能如此简单的完成这些工作显然是要大加分的.</p>

<p>更重要的是, Meteor代码所依赖的很多模式和库都是你所熟悉的.这意味着可以非常快的掌握,只需要一些JavaScript知识.</p>

<p>当然，随着您的需求的发展，你需要深入挖掘这个框架的复杂性。但是即使你只知道Meteor最基本的功能你也同样能作出一些东西来, 我想,这大概就是为什么Meteor非常好玩的原因之一.</p>

<p>原文来自 Sacha Greif  <a href="http://theMeteorbook.com/2013/02/20/a-look-at-a-Meteor-template/">A Look at a Meteor Template</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting Started with Meteor]]></title>
    <link href="http://xguox.github.com/blog/2013/03/05/getting-started-with-meteor/"/>
    <updated>2013-03-05T23:02:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/05/getting-started-with-meteor</id>
    <content type="html"><![CDATA[<h5>LEVEL: BEGINNER</h5>

<p>当你看到这,也就说明你听说了<a href="http://Meteor.com/">Meteor</a>这东西, 并对它产生一些好奇.<br/>
那就让我们创建一个最基本的应用来耍一耍吧. 希望能以此学习到一两样东西.</p>

<h2>准备工作: 安装Meteor</h2>

<p>要安装Meteor那就再简单不过了. 只需要执行下面这条命令<br/>
<code>curl https://install.Meteor.com | /bin/sh</code></p>

<p>只要你是在<a href="https://github.com/Meteor/Meteor/wiki/Supported-Platforms">支持的平台</a>上运行,跟着步骤来就基本没什么问题.</p>

<p>接下来让我们创建一个简单的app来确定是否安装成功.<br/>
<code>Meteor create forum</code>
如果安装成功, 那执行下面的步骤就可以把这个app跑起来了</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd forum
</span><span class='line'>Meteor</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<p>如果这一切都顺利的话, 那么在浏览器打开<code>http://localhost:3000</code>, 就会看到:
<img src="http://theMeteorbook.com/images/posts/bare-Meteor-app.png" alt="" /></p>

<h2>设置我们的forum</h2>

<p>这个使用Meteor生成的简单的应用程序并不能做些什么; 只是或多或少示范了如何呈现模板和响应事件.</p>

<p>而今, 我们只需要用浏览器的控制台(比如Chrome的Inspector)来捣鼓一些我们这个应用的数据. 因此,我们不必太过在意现有的用户界面. 一切从简. 在创建一个posts集合并在一个列表中一一展示前,我们先在 forum.html 这么干:</p>

<figure class='code'><figcaption><span>forum.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>Forum<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  
</span><span class='line'>  {{&gt; posts}}
</span><span class='line'>  
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;posts&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h1&gt;</span>Posts<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ul&gt;</span>
</span><span class='line'>    {{#each posts}}
</span><span class='line'>    <span class="nt">&lt;li&gt;</span>{{name}}<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    {{/each}}
</span><span class='line'>  <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>当编辑完成上面这段代码后, 你应该会看到浏览器自动重载了页面. 现在, 除了一个&#8221;Posts&#8221;标题,你应该什么也看不到. 为什么会这样呢?</p>

<p><img src="http://theMeteorbook.com/images/posts/empty-posts-list.png" alt="" /></p>

<p>我们刚刚使用了<code>{{ #each }}</code>这个helper来告诉Meteor创建了一个无序列表并且在其里边的每个li标签展示一条post. 但是在这里我们的posts为空. 所以页面中什么也没显示出来. 那么接下来让我们来生成一些posts吧.</p>

<p>在<code>forum.js</code>, 我们创建了一个叫<code>posts</code>的<code>Collection</code>, 并使用之前所建立的<code>posts</code>模板加载之:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Posts</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">isClient</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">helpers</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">posts</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这看起来只是一个简单的变化，但事实并非如此。 我们做的事是在客户端和服务端创建了一个叫作<code>posts</code>的Meteor <code>Collection</code>. 这是什么意思呢?</p>

<p>在服务端,当数据被添加进来之后, 会被插入写进到一个<a href="http://www.mongodb.org/">mongo</a>数据库(mongo内置包含在每个Meteor应用程序). 当执行查询的时候, Meteor会查找到这个数据库. 这样我们其实就已经把这些posts永久性的存贮起来了.</p>

<p>在客户端,<code>posts</code> 集合会自动连接到服务端并在浏览器,本地镜像或者缓存中创建这个服务端集合. 这样, 当在浏览器中新建posts,这些posts就会直达服务端从而插入到mongo数据库中,并传输到其他连接上的本地的<code>posts</code>集合. 很难理解是吧?你很快就会知道这一切是怎么回事.</p>

<p>添加完以上的js以后, 你不会看到我们的应用程序发生任何的改变; 这是因为我们还没添加任何一条的数据. 那么现在开始添加吧.</p>

<h2>在你的浏览器控制台中操纵数据</h2>

<p>让我们来仔细看看这个神奇的集合. 在这我们会使用到浏览器控制台, 尽管我们假定你一直跟着我们的步伐并使用了Chrome的Inspector, 但其他的一些浏览器控制台(如Firebug等)也一样可以完成.</p>

<p>首先, 让我们看看集合里有些什么东西. 运行下面的代码,我们会告诉<code>posts</code>模板查找该集合中的数据:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</span><span class='line'><span class="err">»</span> <span class="err">‣</span><span class="nx">LocalCollection</span><span class="p">.</span><span class="nx">Cursor</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Cursor</code>是一个匹配指定的查询(在本例中为空)所得到的Meteor数据源. 现在看起来不那么有趣, 让我们使用下面这条语句来提取数据:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">()</span>
</span><span class='line'><span class="err">»</span> <span class="p">[]</span>
</span></code></pre></td></tr></table></div></figure>


<p>由于还没有一条post, 这会返回一个空数组. 让我们添加上一条吧!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Posts</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;A Brand New Post&#39;</span><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>由于Meteor的响应式渲染( reactive rendering )使得HTML与底层的数据模型保持同步, 因此我们可以马上在页面上看到这条post
<img src="http://theMeteorbook.com/images/posts/single-post-inserted.png" alt="" /></p>

<p>等一等,现在我们能够在客户端中从这个集合里抓取到这条post</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">()</span>
</span><span class='line'><span class="err">»</span> <span class="p">[</span><span class="err">‣</span><span class="nb">Object</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>我们能够在本地集合中看到这篇post的存在. 对此没什么概念吗? 试试刷新页面;或者在一个新的tab打开<code>http://localhost:3000</code>,这篇post还在是吧!</p>

<p>为什么会这样呢?在程序内部,Meteor已经同步了这个post对象(<code>{name: 'A Brand New Post'}</code>)到服务端, 并将其存储到mongo数据库中,这样,在所有的客户端都能访问到这篇post.我们同样能够在mongo的控制台中查看到它;在命令行中运行<code>Meteor mongo</code>(该命令运行的同时必须把项目跑起来),你也可以使用相似的接口来查看到:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;A Brand New Post&quot;</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;a72d6722-262b-4dc5-80f6-564796a6cc95&quot;</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>花上一点时间想想这对你来说有多么的神奇 (with no work on your part!), 然后肆意地在浏览器的控制台操纵<code>insert</code>  <code>update</code>  <code>remove</code> 命令(<a href="http://docs.Meteor.com/#collections">文档在这</a>),同时在其他tab,其他浏览器甚至其他机器上(只要能看得到)看看同步的效果</p>

<p>原文转自 Tom Coleman <a href="http://theMeteorbook.com/2013/01/30/getting-started-with-Meteor/">Getting Started with Meteor</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[你应该在生产环境下使用JavaScript的严格模式（strict mode）吗？]]></title>
    <link href="http://xguox.github.com/blog/2013/02/08/should-you-use-strict-in-your-production-javascript/"/>
    <updated>2013-02-08T09:32:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/02/08/should-you-use-strict-in-your-production-javascript</id>
    <content type="html"><![CDATA[<p>ECMAScript 5 中引入了一种定义,可以切换让你的JavaScript代码是否在所谓的 <strong>严格模式(strict mode)</strong>下执行。因为在strict mode下，当浏览器遇到一些脚本中包含有不好的代码做法时，即使没有语法上的错误也会抛出runtime错误，因而常常被吹捧为一种显著有益于捕获程序员错误的方式。</p>

<h2><strong>在strict mode下运行被认为可以更少的出错</strong></h2>

<p>举个栗子，在定义一个变量时，缺少关键字“var”，如果在non-strict mode下会默认为该变量为全局变量，而在 strict mode下则会抛出一个runtime错误。</p>

<!--more-->


<p>Non-Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
</span><span class='line'><span class="p">}());</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; 1</span>
</span></code></pre></td></tr></table></div></figure>


<p>Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
</span><span class='line'><span class="p">}());</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; ReferenceError: x is not defined</span>
</span></code></pre></td></tr></table></div></figure>


<h2><strong>但strict mode太爱出风头了</strong></h2>

<p>有些时候这样的严格会是一把双刃剑。我们都希望知道在我们的代码中的这些无声的bug，但绝对不会希望看到这些bug在我们运营上线的网站上抛出runtime错误给了我们的最终用户。尤其是,当这些代码实际上都按我们的期望正常运行着的时候，只是这些代码有一些“bug”</p>

<h2><strong>可以同时使用两种方式吗？</strong></h2>

<p>你不会得到许多的同情，而应该开始抱怨JavaScript暴露了一个bug给你的用户而你自己却不知道，除此之外，你可能会想这可以有两全其美的方法-在测试代码下使用strict mode，而生产环境下不使用。但这个想法有几个问题，首先，这很可能会使你的生产代码运行起来比测试代码要慢的多（见下文），然后，这两种代码可能跑起来会有所不同（见下文）。</p>

<h2><strong>Non-Strict Mode 下代码可能跑得要慢一些</strong></h2>

<p>或许这会跟你的直觉相悖，可能你会认为更多的错误检测和一些额外的“事情”一定会使得引擎做得更多从而你的代码跑得更慢。但<a href="https://hacks.mozilla.org/2011/01/ecmascript-5-strict-mode-in-firefox-4/">Chris Heilmann</a>总结出了使用strict mode跑的更快的原因。他的解释如下:</p>

<blockquote><p>[Strict mode] 修复了那些误区使得JavaScript引擎性能得到优化: 相较于非strict mode而言,strict mode代码能跑的更快。 Firefox 4 还未优化strict mode ,但其后续版本会。</p></blockquote>

<p>也就是说是否去掉strict mode 在生产环境意义并不是那么的明显, 但如果没有令人信服的考虑,去掉strict mode的话你实际上是改变了你的代码的执行方式。下面是几个例子。</p>

<h2><strong>是否为Strict Mode,函数的上下文会有所不同</strong></h2>

<p>在non-strict mode,任意全局函数中,保留字“<code>this</code>”默认指向全局对象(对于浏览器而言,这个对象会是 <strong>window对象</strong>).而在strict mode,“<code>this</code>”默认则为<code>undefined</code><br/>
Non-strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'><span class="p">}());</span>
</span><span class='line'><span class="c1">//=&gt; Window</span>
</span></code></pre></td></tr></table></div></figure>


<p>Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'><span class="p">}());</span>
</span><span class='line'><span class="c1">//=&gt; undefined</span>
</span></code></pre></td></tr></table></div></figure>


<p>在一个函数中使用<code>call()</code>你可以设定<code>this</code>的指代,但在这两种不同的模式下,你用来充当上下文的值会巧妙地变得有些不一样。在Non-strict Mode，如果上下文的值是原始的（primitive），比如数字 <code>1</code>，那它将会被转换成一个对象，一个Number对象。而在strict mode ,这个原始的值 <code>1</code>, 将会被保留。<br/>
Non-strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">}.</span><span class="nx">call</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; Number {}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">}.</span><span class="nx">call</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; 1</span>
</span></code></pre></td></tr></table></div></figure>


<h2><strong>是否为Strict Mode,arguments对象的行为有所不同</strong></h2>

<p> <code>arguments</code>对象包含了引用函数的形参。在non-strict mode下，修改arguments对象的值同时也会修改对应的形参的值，而在Strict Mode之下，两者是独立的。<br/>
Non-strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
</span><span class='line'><span class="p">}(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; two two</span>
</span></code></pre></td></tr></table></div></figure>


<p>Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
</span><span class='line'><span class="p">}(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; one two</span>
</span></code></pre></td></tr></table></div></figure>


<h2><strong>为什么你无论如何也要移除严格模式</strong></h2>

<p>考虑到在你的代码中的所有可能的变更行为,你可能会认为有明确的理由不去除“use strict&#8221;,毕竟，你也不希望你的做法会改变代码原本的运行方式。对不?但事实上，你确实会遇上这些问题，即使你保留了&#8221;use strict&#8221;。这是因为，你的“use strict&#8221;在一些旧版本的浏览器下会直接被无视，<a href="http://caniuse.com/use-strict">它们不认识这句声明</a>。因此，对于你的其中一些用户，你还不如把“use strict&#8221;去掉更好。这样，他们也将得到同样的而在你想象的现代浏览器中不会得到的不严格行为。如果希望使用严格模式的同时支持旧版本的浏览器，你需要明白所有的严格模式下是否有效的副作用,然后避开对它们的依赖。</p>

<p>你可能会觉得兼容性胜利了以及最好从来都没有出现过什么“use strict&#8221;的效果。又或者，你可能 觉得你了解了所有的副作用影响并坚持使用“use strict&#8221;,但还有另外一个问题需要考虑到的。如果通过连接和压缩你在生产环境下的代码来优化了HTTP请求,你可能会遇到一个与“use strict&#8221;相关的问题。当在函数中声明了 “use strict&#8221; ， 它只适用于该函数的词法作用域(lexical scope )。但如果在函数外声明，则将会作用于整一个文件。How could this come back to bite you?让我举个栗子&#8230;</p>

<p>在我的一些工作项目中，我们有时候会引入第三方的实用工具库到我们的应用程序中。而且很有可能会引入多个。当然，我们自己的代码是 concatenation-friendly ,因为我们只使用了函数范围内的 严格模式,但假设一下如果某一个第三方库在文件顶部&#8211;不在任何函数域内声明了“use strict&#8221;。现在也想象一下另外一个第三方库不是严格的安全。通过串联这两个库你几乎可以肯定会得到不同的行为以及一些以往不会抛出的错误。</p>

<p>当然也有一些方法可以缓解这些问题：避免使用任何在函数域外声明“use strict&#8221;的库,或者你可以放弃连接使用这些库并且 take the HTTP request hit to performance.这些个看起来都有些局限性，不那么吸引人。</p>

<p>因此，不顾所有可能的移除严格模式副作用,在特定情况下，你可能会决定选择在生产环境下移除&#8221;use strict&#8221;。</p>

<p>原文来自Michael Mathews,<a href="http://scriptogr.am/micmath/post/should-you-use-strict-in-your-production-javascript?utm_source=javascriptweekly&amp;utm_medium=email">Should You &#8220;Use Strict&#8221; in Your Production JavaScript?</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[About My Translation]]></title>
    <link href="http://xguox.github.com/blog/2013/02/07/about-translation/"/>
    <updated>2013-02-07T18:05:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/02/07/about-translation</id>
    <content type="html"><![CDATA[<p><strong>First off</strong>，以俺目前的各种水平，想写出一些好的 technical articles 是有点难度的啦。于是乎，我选择了翻译国外一些好的文章。不管多么新鲜的技术，就算找不着中文资料，也一定没少英文文档。比如最近发现的几个挺不错<a href="https://cooperpress.com/">weekly</a>（其实也不是最近才发现，也订阅了有大半年吧，不过其实是只订不阅，或者阅的比较少。惰性心理啊。）以及一些国外牛人BLOG。Share下我的文章的主要来源吧.</p>

<ul>
<li><a href="http://www.smashingmagazine.com/">Smashing Magazine</a></li>
<li><a href="http://www.html5rocks.com/en/">HTML5ROCKS</a></li>
<li><a href="http://css-tricks.com/">CSS-Tricks</a></li>
<li><a href="http://javascriptweekly.com/">JavaScript Weekly</a></li>
<li><a href="http://rubyweekly.com/">Ruby Weekly</a>(最近几乎没怎么研究Ruby了)</li>
<li><a href="http://dailyjs.com/">DailyJS</a></li>
<li><a href="http://net.tutsplus.com/">nettus+</a></li>
<li><a href="http://paulirish.com/">Paul Irish</a></li>
<li><a href="http://blog.reybango.com/">Rey Bango</a></li>
<li><a href="http://javascriptissexy.com/">JavaScript.is(Sexy)</a></li>
</ul>


<p>Obviously, 不可能有一篇新的我就翻译一篇. 要是那样的话我精尽人亡都搞不过来. 而且, 尴尬 + 惭愧的是, 本身我自己的Google Reader里也是常年1000+ unread =. =</p>

<p>其实以前初初学Rails也是跟着全英文的<a href="http://ruby.railstutorial.org/ruby-on-rails-tutorial-book">Ruby on Rails Tutorial</a>，另外也尝试翻译过<a href="http://rubymonk.com/">rubymonk</a>以及近段时间翻的一些，本人的英文水平实在很渣，CET6不上300分的成绩也曾经考过。于是，都翻比较蹩脚。就好比之前那几篇，好些地方原本读原文还明白了, 翻译过后反而看不懂在讲什么。有些则是只会半句。好吧，的确尴尬！不过，会好起来的。</p>

<p>说到英文水平，尽管老早的就知道重要性，却从未好好学习过，只能现在硬着头皮自愿加强迫自己上，看英文的电视剧（尽量不跟着字幕），用英文的社交网站（圈多些国外的），阅读外文的文章（好吧，几乎也就是一些科技类的）, 听英文podcast(各种听不懂)&#8230;</p>

<p>PS，最近看<a href="http://linlis.me/">@linux</a>也经常翻译一些文章，不过他翻译的更多比较文学性的。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[你可能不知道的JSON.stingify()]]></title>
    <link href="http://xguox.github.com/blog/2013/02/01/what-you-might-not-know-about-json-dot-stringify/"/>
    <updated>2013-02-01T18:06:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/02/01/what-you-might-not-know-about-json-dot-stringify</id>
    <content type="html"><![CDATA[<p>几乎所有开发人员都会花一些时间在JavaScript上，有些时候是在使用JSON.stingify（以及与之相对应的，JSON.parse）。JSON - Javascript Object Notation - 已经成为许多开发人员理想的数据交换格式（the go-to data-interchange format）- 并且有许多语言支持序列化为JSON,而不仅仅只有JavaScript本身。如果哪天你半夜起来又无法入睡了，可以查一查关于<a href="http://en.wikipedia.org/wiki/JSON#History">JSON</a>的历史（tl;dr – Douglas Crockford is the brain behind it）</p>

<!--more-->


<p>在写JavaScript的时候，我们用<code>JSON.stringify</code>将某个值序列化为一个字符串值来表示一个对象。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Jim Cowart&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">country</span><span class="o">:</span> <span class="s2">&quot;Jimbabwe&quot;</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">// 输出结果:  &quot;{&quot;name&quot;:&quot;Jim Cowart&quot;,&quot;country&quot;:&quot;Jimbabwe&quot;}&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="s2">&quot;Oh look, a string!&quot;</span><span class="p">);</span>
</span><span class='line'><span class="c1">// 输出结果： &quot;&quot;Oh look, a string!&quot;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;open&quot;</span><span class="p">,</span><span class="s2">&quot;the&quot;</span><span class="p">,</span><span class="s2">&quot;door&quot;</span><span class="p">]);</span>
</span><span class='line'><span class="c1">// 输出结果： &quot;[1,2,3,4,&quot;open&quot;,&quot;the&quot;,&quot;door&quot;]&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>我不会反复地讨论关于序列化的规则，在<a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify">这里</a>你可以读到更多相关的。但最基本的，你需要知道下面这些：</p>

<ul>
<li><code>undefined</code> 值、函数或者XML值会被忽略，除非当&#8230;</li>
<li>如果你的数组当中含有 <code>undefined</code>值，函数或XML值，该数组中的这些值将会被当成 <code>null</code></li>
</ul>


<p>Let’s see about that:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">doStuff</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">},</span>
</span><span class='line'>    <span class="nx">doThings</span><span class="o">:</span> <span class="p">[</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span> <span class="kc">undefined</span> <span class="p">]</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">// 输出结果:  &quot;{&quot;doThings&quot;:[null,null]}&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>“太棒了，Jim。我知道了。它是一种数据交换格式。而行为是不会被序列化的。这些天我使用的大多数库都是在底层为我处理序列化(Most of the libraries I use these days handle serializing for me under the hood.)。那为什么要专门写一篇post关于 JSON.stringify 呢？”</p></blockquote>

<p>这个我知道，但是有一些实用的技巧迟早我们会需要用上的。Many of the larger applications I’ve worked on recently have had debug flags that can be flipped to enable various console logging from different components active on the page.
而我们明显不希望总是通过无数行<code>console.log</code>来筛选信息 - 但当这变得有需要的时候，让它的可读性更高是不是更nice呢？</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// what if this:</span>
</span><span class='line'><span class="s1">&#39;{&quot;name&quot;:&quot;Jim Cowart&quot;,&quot;location&quot;:{&quot;city&quot;:{&quot;name&quot;:&quot;Chattanooga&quot;,&quot;population&quot;:167674},&quot;state&quot;:{&quot;name&quot;:&quot;Tennessee&quot;,&quot;abbreviation&quot;:&quot;TN&quot;,&quot;population&quot;:6403000}},&quot;company&quot;:&quot;appendTo&quot;}&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// could be formatted like this, automagically?</span>
</span><span class='line'><span class="s2">&quot;{</span>
</span><span class='line'><span class="s2">    &quot;</span><span class="nx">name</span><span class="s2">&quot;: &quot;</span><span class="nx">Jim</span> <span class="nx">Cowart</span><span class="s2">&quot;,</span>
</span><span class='line'><span class="s2">    &quot;</span><span class="nx">location</span><span class="s2">&quot;: {</span>
</span><span class='line'><span class="s2">        &quot;</span><span class="nx">city</span><span class="s2">&quot;: {</span>
</span><span class='line'><span class="s2">            &quot;</span><span class="nx">name</span><span class="s2">&quot;: &quot;</span><span class="nx">Chattanooga</span><span class="s2">&quot;,</span>
</span><span class='line'><span class="s2">            &quot;</span><span class="nx">population</span><span class="s2">&quot;: 167674</span>
</span><span class='line'><span class="s2">        },</span>
</span><span class='line'><span class="s2">        &quot;</span><span class="nx">state</span><span class="s2">&quot;: {</span>
</span><span class='line'><span class="s2">            &quot;</span><span class="nx">name</span><span class="s2">&quot;: &quot;</span><span class="nx">Tennessee</span><span class="s2">&quot;,</span>
</span><span class='line'><span class="s2">            &quot;</span><span class="nx">abbreviation</span><span class="s2">&quot;: &quot;</span><span class="nx">TN</span><span class="s2">&quot;,</span>
</span><span class='line'><span class="s2">            &quot;</span><span class="nx">population</span><span class="s2">&quot;: 6403000</span>
</span><span class='line'><span class="s2">        }</span>
</span><span class='line'><span class="s2">    },</span>
</span><span class='line'><span class="s2">    &quot;</span><span class="nx">company</span><span class="s2">&quot;: &quot;</span><span class="nx">appendTo</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">}&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>事实上，JSON.stringify可以传入3个参数（JSON.stringify(value [, replacer [, space]])。其中，第三个参数 - “space” - 允许你指定一个字符串字符、或者使用缩进、或是一个数字。如果你传的是一个数字，那相应的空格数（最大为10）会被作为缩进量</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Jim Cowart&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">location</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">city</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Chattanooga&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">population</span><span class="o">:</span> <span class="mi">167674</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nx">state</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Tennessee&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">abbreviation</span><span class="o">:</span> <span class="s2">&quot;TN&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">population</span><span class="o">:</span> <span class="mi">6403000</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">company</span><span class="o">:</span> <span class="s2">&quot;appendTo&quot;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="c1">//如果你希望缩进量为2 个空格，</span>
</span><span class='line'><span class="c1">// 你可以这么干：</span>
</span><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'><span class="cm">/* produces:</span>
</span><span class='line'><span class="cm">&quot;{</span>
</span><span class='line'><span class="cm">  &quot;name&quot;: &quot;Jim Cowart&quot;,</span>
</span><span class='line'><span class="cm">  &quot;location&quot;: {</span>
</span><span class='line'><span class="cm">    &quot;city&quot;: {</span>
</span><span class='line'><span class="cm">      &quot;name&quot;: &quot;Chattanooga&quot;,</span>
</span><span class='line'><span class="cm">      &quot;population&quot;: 167674</span>
</span><span class='line'><span class="cm">    },</span>
</span><span class='line'><span class="cm">    &quot;state&quot;: {</span>
</span><span class='line'><span class="cm">      &quot;name&quot;: &quot;Tennessee&quot;,</span>
</span><span class='line'><span class="cm">      &quot;abbreviation&quot;: &quot;TN&quot;,</span>
</span><span class='line'><span class="cm">      &quot;population&quot;: 6403000</span>
</span><span class='line'><span class="cm">    }</span>
</span><span class='line'><span class="cm">  },</span>
</span><span class='line'><span class="cm">  &quot;company&quot;: &quot;appendTo&quot;</span>
</span><span class='line'><span class="cm">}&quot;</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="c1">// 如果你希望使用 tab 缩进，那么</span>
</span><span class='line'><span class="c1">// 你可以传入 \t 作为第三个参数</span>
</span><span class='line'><span class="c1">// 以此来告别空格缩进</span>
</span><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s2">&quot;\t&quot;</span><span class="p">);</span>
</span><span class='line'><span class="cm">/*输出结果:</span>
</span><span class='line'><span class="cm">&quot;{</span>
</span><span class='line'><span class="cm">    &quot;name&quot;: &quot;Jim Cowart&quot;,</span>
</span><span class='line'><span class="cm">    &quot;location&quot;: {</span>
</span><span class='line'><span class="cm">        &quot;city&quot;: {</span>
</span><span class='line'><span class="cm">            &quot;name&quot;: &quot;Chattanooga&quot;,</span>
</span><span class='line'><span class="cm">            &quot;population&quot;: 167674</span>
</span><span class='line'><span class="cm">        },</span>
</span><span class='line'><span class="cm">        &quot;state&quot;: {</span>
</span><span class='line'><span class="cm">            &quot;name&quot;: &quot;Tennessee&quot;,</span>
</span><span class='line'><span class="cm">            &quot;abbreviation&quot;: &quot;TN&quot;,</span>
</span><span class='line'><span class="cm">            &quot;population&quot;: 6403000</span>
</span><span class='line'><span class="cm">        }</span>
</span><span class='line'><span class="cm">    },</span>
</span><span class='line'><span class="cm">    &quot;company&quot;: &quot;appendTo&quot;</span>
</span><span class='line'><span class="cm">}&quot;</span>
</span><span class='line'><span class="cm">*/</span>
</span></code></pre></td></tr></table></div></figure>


<p>那么-第二个参数呢？在上面的例子中简单地传了一个<code>null</code>。关于 “replacer” 参数-它可以是一个数组或者是一个函数。如果是一个数组，它将只输出你在该数组中所想要包含的keys。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 假定 person对象是上一例子中的那个，</span>
</span><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;company&quot;</span><span class="p">],</span> <span class="mi">4</span><span class="p">);</span>
</span><span class='line'><span class="cm">/* 输出结果:</span>
</span><span class='line'><span class="cm">&quot;{</span>
</span><span class='line'><span class="cm">    &quot;name&quot;: &quot;Jim Cowart&quot;,</span>
</span><span class='line'><span class="cm">    &quot;company&quot;: &quot;appendTo&quot;</span>
</span><span class='line'><span class="cm">}&quot;</span>
</span><span class='line'><span class="cm">*/</span>
</span></code></pre></td></tr></table></div></figure>


<p>如果这 “replacer” 参数传入的是一个函数，那么这个函数需要有两个参数：key 和 value ：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// a bit contrived, but it shows what&#39;s possible</span>
</span><span class='line'><span class="c1">// FYI - 被序列化的值是第一个传给replacerFn的东西, 也即是这个对象的每一个key，因此需要检查key的真假。</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">replacerFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">key</span> <span class="o">||</span> <span class="nx">key</span> <span class="o">===</span> <span class="s1">&#39;name&#39;</span> <span class="o">||</span> <span class="nx">key</span> <span class="o">===</span> <span class="s1">&#39;company&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span><span class="p">;</span> <span class="c1">//返回 undefined 并忽略 </span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="nx">replacerFn</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</span><span class='line'><span class="cm">/* produces:</span>
</span><span class='line'><span class="cm">&quot;{</span>
</span><span class='line'><span class="cm">    &quot;name&quot;: &quot;Jim Cowart&quot;,</span>
</span><span class='line'><span class="cm">    &quot;company&quot;: &quot;appendTo&quot;</span>
</span><span class='line'><span class="cm">}&quot;</span>
</span><span class='line'><span class="cm">*/</span>
</span></code></pre></td></tr></table></div></figure>


<p>你可以使用替换方法来处理得到 <strong><em>黑名单</em></strong>成员的姓名（与此相对应的是，使用<strong><em>白名单</em></strong>数组作为“replacer” 参数）。我发现这种方法是有用的，尤其当我需要迅速并且有针对性的得到一个DOM元素的值，但我希望阻止一个序列化循环引用的异常（当我drank some antifreeze 或是试图做些荒谬的做法如JSON.stringify(document.body)的时候）。Feel free to browse <a href="http://jsfiddle.net/ifandelse/6Yj5h/">this fiddle</a> for a simple example of using a replacer function to blacklist based on member name(s).</p>

<p>当然，另一个得到自定义某个对象的JSON序列化的选择是在对象中使用“toJSON”方法</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Jim Cowart&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">location</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">city</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Chattanooga&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">population</span><span class="o">:</span> <span class="mi">167674</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nx">state</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Tennessee&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">abbreviation</span><span class="o">:</span> <span class="s2">&quot;TN&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">population</span><span class="o">:</span> <span class="mi">6403000</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">company</span><span class="o">:</span> <span class="s2">&quot;appendTo&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">booyah</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; , employer: &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">company</span>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 上面的toJSON返回的值</span>
</span><span class='line'><span class="c1">// 实际上被字符串化的:</span>
</span><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</span><span class='line'><span class="cm">/* produces:</span>
</span><span class='line'><span class="cm">&quot;{</span>
</span><span class='line'><span class="cm">    &quot;booyah&quot;: &quot;Jim Cowart , employer: appendTo&quot;</span>
</span><span class='line'><span class="cm">}&quot;</span>
</span><span class='line'><span class="cm">*/</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>“说真的，Jim。比起在控制台写更漂亮的JSON我们有更重要的事情要做。”</p></blockquote>

<p>You don’t have to convince me, I’m with you 110%. 但我会说，当你为了调试已发布的信息的可视性或者logging websocket payloads而 wire-tapping a message bus 的时候更好看的JSON格式化会让一切都不同。（囧 、o(╯□╰)o）能够通过白名单替换数组（或者黑名单替换函数）来有选择的序列化对象，可以很方便地在DOM元素/事件上帮助你跟踪问题，或者简单地让你在复杂的交互上有更好的可视化，without de-railing you with serialization exceptions.</p>

<p>原文来自 Jim Cowart ，<a href="http://freshbrewedcode.com/jimcowart/2013/01/29/what-you-might-not-know-about-json-stringify/?utm_source=javascriptweekly&amp;utm_medium=email">What You Might Not Know About JSON.stringify()</a></p>

<p>XguoX<br/>
- Actually，其实这个在Nicholas C.Zakas的《JavaScript高级程序设计》第20章关于JSON的介绍讲的也很详细。比我这蹩脚翻译要好得多。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Microsoft?Win8?WP8?死忠Nokia]]></title>
    <link href="http://xguox.github.com/blog/2013/01/27/nokia-microsoft-win8-wp8/"/>
    <updated>2013-01-27T19:48:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/01/27/nokia-microsoft-win8-wp8</id>
    <content type="html"><![CDATA[<p>打从开始用手机就是NOKIA，初初的<strong>7360</strong> -> <strong>5700</strong> -> <strong>N85</strong>。还行吧，这么多年来一直坚持着，也算个NOKIA死忠粉丝瓜。从85换到现今的撸妹820期间，用过一台塞班的c6和iOS的3GS，以及短暂的耍过一些低端android。最后选择了Windows Phone 8，有出于对其的看好，对metro的喜爱，还有他们说的，90后就是要个性，与众不同。</p>

<p>首先，简单说说<strong>撸妹820</strong>吧，系统运行的流畅程度的挺满意的。其实CPU、RAM的配置跟撸妹920一样的。尽管800 x 480在现今主流配置来说拖了后腿，尽管整台机器我最不喜欢的是这块屏幕，不过暂时对我来说已经很不错下，毕竟木有用过720P，更没用过传说中的1080P，所以理解不来分辨率倒退的落差。<!-- more -->拍照性能其实算的上挺强的吧。除了没有撸妹920的PureView外，但毕竟这也是蔡司认证滴。而且，花哨的拍摄功能也不少，不过如果是Instagram的粉丝可能就要失望了。貌似WP8的Instagram还不知道在不在娘胎里。但据说有个叫Lomogram的很不错下。（好像有5毛之嫌啊）因为自己有a77，所以，其实一直都对手机的拍摄性能不太关注，这也是促使我买了撸妹820而不是920的一大原因(我会告诉你其实真正原因是本屌丝缺钱买不起贵了千把块的920)。外观上，4.3的屏幕目前感觉良好，毕竟我的手也不是很大，再大到跟Note II 那样估计我就得每次掏手机都使双手了。比较欢乐的是这个后壳，各种颜色，满足了我一向colorful的style。好吧，偶不是专业硬件测评的，就扯这一点好了。</p>

<p>接下来看看WP8</p>

<p><img src="https://deivxa.dm1.livefilestore.com/y1pUR7NOwfw5jvpoQe2P98N2xpeRJpq-C11fPmZs9CqfptYzxkGe6dP-QuZYlBGtgoEQl1iPgprpNPRtgeoUhv1PhUYd0aOyuBB/wp_ss_20130127_0004.png?psid=1" alt="" /><br/>
很多人诟病WP8的app很少?这个个人真心不觉得。当然，比另外两大巨头要少那是必然的。不过鸽不算什么重度app玩家，手机基本都只装自己用的，游戏基本不装。目前的话我需要的都能找到，其实也就无非一些sns，rss，map，note，支付宝之类的app。好吧，最痛心还是没有Chrome(只有一个非官方版的)。尽管IE10进步不少，但依旧替代不了Chrome在我心中的地位。毕竟好多书签的说，只能靠一个叫Chrync的app同步书签了。</p>

<p>看看IE10下的简书<br/>
<img src="https://degncq.dm1.livefilestore.com/y1pN2VJhTzGZ0V_EWJ6JufFeIP2fUztsk1sH1Q1PQTQUGCsXcveg_VSO2ESbV-ciS9TnZsgQ24eE-XL2-LUNg8YMaHm9EU2i_kh/wp_ss_20130127_0003.png?psid=1" alt="" /></p>

<p>支付宝<br/>
<img src="https://dehd8g.dm1.livefilestore.com/y1p7L6VkMxxixDYU4HgVzgxnWudd6Amrtkt0exs4myItPQitoX3d0Spethc6oldwiE71Yj1XVQ6ckoAelnxe-Zl5h9Y82Pe_eEy/wp_ss_20130127_0001.png?psid=1" alt="" /></p>

<p>另一个比较关心的app是Google Reader。刚开始用一个叫RSS READER的，后来出现比较多的bug，也就果断卸了，目前正在试用一个 <strong>NEXTGEN READER</strong>，感觉挺不错下，12块也算比较值。<img src="https://deguua.dm1.livefilestore.com/y1prTYlFSVDtOv2e0zVS8Mm47mh8XYP3NsTp8LySQ8sg9wMHj-I7NWmBI5HOwY9LAAgpy3N2L9DwsHMgZe6ItkO_ViJQnrmFqEy/wp_ss_20130127_0002.png?psid=1" alt="" /></p>

<p><img src="https://dehyla.dm1.livefilestore.com/y1pwayuSgGoPFBpqWAUhgy2HYZCwgnkIVfCONgbq2sIgCdb-QEHGIGnqHvIG1ZsuF6iC6YmsAmoU_ryWEpptpK8BuG_B2ip26-y/wp_ss_20130126_0003.png?psid=1" alt="" /></p>

<p>当然，同样的某些也就只是某些app啦相较于iOS版本的来说没那么细腻这也是事实。不过这也只是取决于开发者所花的心思吧。现在的app开发者都一股脑热的涌向了iOS和Android。</p>

<p>说完WP8就转着说说Win8，据前些天看到的报道，Win8的份额正逼近ml。哎，虽然满大街都说Microsoft在走下坡路，但垄断地位还是不可撼动啊！关于Win8，其实，最近也有准备更换电脑，一直在Win8的触屏超级本和Air之间犹豫徘徊。考虑到开发的需要，所以目前还是更偏向于Air。Win8目前许多应用还不甚稳定，闪退现象比较多出现。</p>

<p>其实关于这个metro还有一个不得不说说的就是<strong>so.cl</strong> 。 其实早在11年刚推出微软那会我是不怎么看好并且也不怎么感兴趣的，在这个社交网站遍地跑的互联网再插一只脚进来，还是老样子的话也就没啥意思了。不过最近偶然间回去耍了耍，感觉还是有点看头的，偶尔也还上去耍耍，跟国际友人多些交流（貌似不用翻越那啥就可以上去的说）</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress' Rake New_post Doesn't Work With Zsh]]></title>
    <link href="http://xguox.github.com/blog/2013/01/04/octopress-rake-new-post-doesnt-work-with-zsh/"/>
    <updated>2013-01-04T20:06:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/01/04/octopress-rake-new-post-doesnt-work-with-zsh</id>
    <content type="html"><![CDATA[<p>原文&#8212;<a href="http://ryanarneson.com/blog/2012/04/07/rake-new-post-doesnt-work-with-zsh/">传送门</a></p>

<p> 近日，在医院先来无事写点东西，才发现，在<strong>zsh（oh-my-zsh）</strong>下，原本用于生成一篇Octopress Post的命令<code>rake new_post["My new post"]</code>不管用鸟，各种报错</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>zsh: no matches found: new_post[My new post]</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<p>如果你对个中缘由感兴趣的话，这有个<a href="https://github.com/imathis/octopress/issues/117#issuecomment-3707975">传送门</a></p>

<p>如果你木有兴趣知道，那想要解决也很简单，把命令换成<code>rake new_post\["My new post"\]</code></p>

<p>由传送门对面的讨论可知， <a href="https://github.com/imathis">imathis</a>准备把<strong>new_post</strong>命令更新成以下这样：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake new_post
</span><span class='line'>Enter a post title:</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[2013 new year]]></title>
    <link href="http://xguox.github.com/blog/2013/01/01/2013-new-year/"/>
    <updated>2013-01-01T17:42:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/01/01/2013-new-year</id>
    <content type="html"><![CDATA[<p>回看2011的最后一篇，2012的那个元旦，上一次的夜游白云山看那看不到的日出，想来，我的这两元旦都”不平淡“呀。只是这次的不平淡不太妙。<br/>
老规矩，跟上次那般先回顾一下这个2012。首先，庆幸一下这个世界还没到走到末日；接着，热烈祝贺中共18大胜利召开&#8230;(扯远了好伐)</p>

<p>看上那篇写着的，其实2011那会也就那么点东西而已，没多疯狂的，比起2012的简直小巫见大巫。这其实，2012，也没什么疯狂的，学会蛋定地看事情。<br/>
简单来个大小事件回顾：厦门义工旅，瑞卡初实习，奔赴大上海，参与简书，各种进医院，升大四&#8230;</p>

<!-- more -->


<p>我常说自己最大的缺点不是XX性格 || XX知识之类的，而是我的身体状况弱爆了。似乎，以前遇到的所有困难都不算什么，这一次却狠狠地阻挠了我一番。以至于我的所有计划都随之暂停。不过我的心态也算是得到一场小锻炼吧。就像前面所说，蛋定地看事情。</p>

<p>出600D入a77想来是个错误的决断，只怪那次东栅行太纠结折腾了以至于小冲动了。否则，差价上再存点小钱把linux的35L败过来也不错下。后来本是想入xpro1的(说实话现在也还想)奈何银子不甚充裕&#8230;&#8230;</p>

<p>不幸地还有在这患病的节骨眼撞上了大学毕业季，学校各种蛋疼的事有，据说各个校园正开展着各种招聘会啥的，话说到现在我一个都没去过，简历也没份像样的，正装也没一件。想来还没正正规规的为自己的毕业工作筹划一番。换句话说是不是在大上海过得太安逸了叻，又还能安逸多久呢？</p>

<p>大方向呢还是这么走着。还y大方向，说的很正经似的，说白了还不是写代码的。这一年，比较纠结的是linux方面没什么大进步，还是那么不入流。rails有些进步但不甚明显，最近在医院换口味玩儿sinatra，这方面的中文资料那就杠杠的比Rails的还少。JS写了不少，不过也只是仗着jQuery的易上手。前端设计很大程度是在依赖Bootstrap。</p>

<p>还有不足的就是阅读的不够多，包括书，和RSS。尤其RSS，也就订阅那么几个，好经常就爆了。</p>

<p>前面说的，蛋定地看事情。其实自己也不确定是否做到了，初初住院几天我甚至怀疑自己有间歇性的狂燥症。</p>

<p>曾经有某一天的某一刻，我脑海中忽然疑惑是否有“带”这个字，以至于我当时还不自觉的就在虚空种比划着。这些天恰巧在看KK的《失控》，其中，关于<strong>black patch psychosis（黑盲性精神错乱）</strong>的描述让我感觉自己搭上了（当然，其实我当时的条件并没有书中的实验来的残酷）。据传，一些人在极度无聊的时候出现了诡异的幻觉。没有互联网的世界的确失色很多，至少对我来说。</p>

<p>从昨晚到现在，好多人纷纷改签名发微博2012怎么滴2013怎么滴（也是今天1月1扣月租才上看到的，手机老早没流量了）。</p>

<p>2013，想有一些改变。<strong>首要的，当然是身体好起来。其次，希望自己的文字功夫有所提高，一直很欣赏那些写出语言平时而却寓意深远蕴味深刻的作家，虽然我也写了不少，但都是些流水帐，如果哪一天我不写代码，我希望自己会是摄影师&amp;作家，最平凡的文字最平凡的视角去刻画这一切。最后，Javascript至少要能实在地说自己熟悉。</strong></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Positive Energy]]></title>
    <link href="http://xguox.github.com/blog/2012/12/02/positive-energy/"/>
    <updated>2012-12-02T14:42:00+08:00</updated>
    <id>http://xguox.github.com/blog/2012/12/02/positive-energy</id>
    <content type="html"><![CDATA[<p>前天，新装了win8，还是因为技术各种不到位，结果原本的ubuntu活生生的被干掉了。于是乎，我就总安慰自己，哎，毕竟不是计算机专业的，是菜的啦。想来这是我第二次栽在了系统安装。不过这次ubuntu的丢失远不及上一次来的壮烈。目测这次最大的损失也就Octopress里的一些post。因为后来写的好几篇都没有push到github，于是，只好用最2的方式去还原了。</p>

<!--more-->


<p>也因此，才发觉距离写上一篇的时间都有两个多月了。以往一头半个月也能写上一两篇的。只是，这两个月也过得太&#8230;(压抑？好像不是。抑郁？也不算吧。总而言之，就是糟糕吧)因为这糟糕的身子。直到现在，看着自己不过百斤的体重，瘦削的身板。另一方面，<a href="http://jianshu.io">简书</a>正值冲刺时刻。再一方面，临近期末，临近毕业&#8230;总之，一切因为这场突如其来的恶疾而似乎变得糟糕了。<br/>
最大的可惜应该要数没能去RubyConf。门票开始发售的第一天就果断买了门票，接着，坐等11月17。接着&#8230;<br/>
再看着上一篇，还想着怎么怎么地计划，结果都变成了浮云&#8230;</p>

<p>尽管这么一切，但是近些天却也relax的一些。<br/>
似乎是因为去尝试了一些新东西，比如买了几本新书，当然了，不是技术类的。又或者，在学javascript，好吧，其实JS对我包括很多人一定不是什么新东西，但是，对我包括很多人，个中的一些、很多知识一定还是新鲜的。另外Larry说的，看一看Spine.js，还是很有兴趣的。还有Sinatra呀。  甚至乎，如这换了个主题，看着多了份舒适。（想来是不是之前那个配色有点不着调了）
尝试一些新鲜的事物，总会把一些喜悦感激发出来的。</p>

<p>Anyway，最近，有句话在我脑海闪过很多次。
如果若干年后事情对你已经不重要，现在何必为其不堪而难过。So，我回来写博客了。看着页面多了一篇新的post，舒服不少，尽管一如既往的流水。</p>

<blockquote><p>As The last ship sailed towards the distant horizon <br/>
I sat there watching on a rock 　　<br/>
My mind slowly drifting away 　　<br/>
Forming into my… Dreamtale</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[最近有感，关于玩]]></title>
    <link href="http://xguox.github.com/blog/2012/09/26/recently-feeling/"/>
    <updated>2012-09-26T11:32:00+08:00</updated>
    <id>http://xguox.github.com/blog/2012/09/26/recently-feeling</id>
    <content type="html"><![CDATA[<p>101假期临近了，前不久，Larry刚去了张家界回来，Linux也准备去青海，好是羡慕呀。时间再往前推一些，班级刚组织了一趟毕业旅游，是去阳朔的（小吐槽下，Y的身边的朋友的毕业旅游居然80%都是去阳朔漓江的，小数一下至少上10个个不同的班级。那边有这么的霸气么？），因为在上海这边不方便回去了，我也就错过了。 <!-- more -->
早之前，朋友们讨论过关于这个大学或者夸张点的说人生最后个暑假是该去找找实习工作还是好好地疯玩个够。哎，也没什么好刻意去选择的。正经事能干，不代表就一定要牺牲掉休闲的时光的撒，漫长两个月，还能做除了这两样之外更多的事啦!</p>

<p>关于旅行，之前，没什么钱在身可以去玩玩穷游，也小转了个厦门、香港、澳门的，好吧，如果上海也算的话，就加一个吧，其实也不用花费很多，要没时间的，逃课也没啥，现在总不能旷工去了。当然我知道请个一天半天加上个周末去relax一下老大们会给的，不过现在项目都还没正是上线，木有稳定下来，还是得放多点心再说吧。<br/>
不过上海有个不错的地方，以上海为中心幅射出去的能玩的地方还是很多的，都比较近，基本周末可以搞定。就好比上次跟小泡他们一起乌镇那样。</p>

<p>暂定给了自己一个小目标，尽快把海岸线的省份都去一趟。上海以南的都去了，接着就是往北了，江苏离上海近，找个周末基本没什么问题。山东的话，要不改天跟大双肥去也行。哇咔咔…
等海岸线游遍过后往内陆推进，咔咔咔咔咔….亲，YY够了！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[胡扯下钓鱼岛]]></title>
    <link href="http://xguox.github.com/blog/2012/09/19/with-the-diaoyudao/"/>
    <updated>2012-09-19T11:31:00+08:00</updated>
    <id>http://xguox.github.com/blog/2012/09/19/with-the-diaoyudao</id>
    <content type="html"><![CDATA[<p>最近的新闻头等大事莫过于 钓鱼岛，以及围绕钓鱼岛引发的各种大事小事，前不久还各种鸣防空警报，好像真的要打仗那样。昨天的9月18更是推到高潮了。<br/>
这边反日内边也憋不住喊着反华了。 各种游行，好不热闹。   就好比理解不了IE6的存在那样，我也真心理解不了那些打砸抢烧的人。思维构造都种麽了！！！有时候会在想，真要打起来了 ，这些游行的人又会在哪呢？ 刚看着各方报道其中有这么说到的一段</p>

<!-- more -->


<p>结合目前日本的国内政治气候，一种普遍的观点认为，钓鱼岛正在成为那些不负责任、只希望抓人眼球、耕耘“票田”的日本政治家的“秀场”。他们在经济上无法拿出长远的发展战略方案，外交上也只能配合美国而唱不了“主角”，内政上更是陷于无止无休的党争，因此无暇顾及大局，只能看眼前利益。这样，炒作钓鱼岛问题就成为他们手中一张牌，不时地要拿出来玩一玩。</p>

<p>再联系国内的大环境，更让我觉得这个政治世界的不靠谱。 前些天开发项目新功能的时候看到Linux随手加的那几篇鲁迅的文章。忽然想起，以前中学时代，课堂上听课时候一些关于鲁迅的文章，那时候教科书上以及老师们各种说鲁迅先生大胆揭露了封建思想什么的。那时看来，封建二字只是一个很单纯的词，在我的印象中脑海里根本就没一个真正的概念意识。或许，现在要是回头看看那些文章，会有更深更彻的感触。nimendongde</p>

<p>最后也说回来吧，眼见各种抵制日货甚至打砸抢烧的言论行动，我差点被凌乱了。<br/>
我最喜欢的动漫ONE PIECE，出自日本人尾田荣一郎；我最喜欢的并正在使用的程序语言Ruby，由日本人松本行弘发明；另外，最近刚看完了一本日本人写的书《版面设计原理》；最近买了一台手机给我妹，也是日本货，and，换月即将要败入的某日本牌子相机。（虽然日本是相机大国，不过偶最爱的Leica来自于德国，好吧，我承认我败不起） <br/>
相比起那些游行打砸抢抵日货的同胞们，我好像很不爱国。</p>
]]></content>
  </entry>
  
</feed>
