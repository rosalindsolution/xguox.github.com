<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[XguoX]]></title>
  <link href="http://xguox.github.com/atom.xml" rel="self"/>
  <link href="http://xguox.github.com/"/>
  <updated>2013-09-27T18:20:09+08:00</updated>
  <id>http://xguox.github.com/</id>
  <author>
    <name><![CDATA[XguoX]]></name>
    <email><![CDATA[golvinlu@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Back to Code]]></title>
    <link href="http://xguox.github.com/blog/2013/09/27/back-to-code/"/>
    <updated>2013-09-27T14:12:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/09/27/back-to-code</id>
    <content type="html"><![CDATA[<p>好多年以前，在「街头篮球」这款游戏看到过的一句，「一天不碰球，就一天没长进」。<br/>
而今，我是好几个月没真正意义的code，所以，这状态，想不roll back都难，更何求长进。</p>

<p>真心，重头来过也忽然无从下手。</p>

<p>打开Octopress准备更新，发觉连Git的一些命令的想了好久才想起来。</p>

<p>看到Git的提示里冒出有
 <code>
git bisect reset
</code>
这货功能很强大呀，昏了，之前怎么完全没印象有过着玩意的？又是学艺不精啊！</p>

<p>想把Octopress更新到2.1，一直略期待着，却一直在preview状态，今儿却才发现，2.1的branch挂了，倒是多了个 3.0的branch。</p>

<p>好吧，老规矩的话，那就换个新面孔好了。这不流行Flat-UI嘛。发现一个还不错的&#8212;<a href="https://github.com/alexharris/octopress-flat/">octopress-flat</a>。加上自己做一些些个修改。</p>

<p>and then 准备new_post的时候报了这玩意，奇葩了，之前zsh貌似不见报这错的啊？难道几个月不碰就变的面目全非了。
<code>
zsh: no matches found: new_post
</code></p>

<p>搜之，在~/.zshrc 里添加
<code>
alias rake="noglob rake"
</code></p>

<p>前些时间落下了好多东西，包括刚着手的翻译行当还有初尝Meteor。</p>

<p>在写简书那会，虽远远称不上精通全端、一锅端，但也绝不至于像现在这样什么都端不起来。
现在想再端起来，还要各种瞻前顾后的，连端啥都决定不好。</p>

<p>想来，回上海或者北漂几乎没啥可能，尽管我很enjoy上海那段日子。so，目测往后也是在珠三角荡悠。要是能找到一份remote job，那就更好不过了。说起来，一直很想去佛山那家创业公司。前年还是他家boss指引我才开始知道并用上Github。现在是更想去了，因为他们支持远程工作 XD</p>

<p>but,现在的我比起11年那会还不行。这情何以堪。</p>

<p>好吧。Anyway，一切都只能等痊愈再说！</p>

<p>消沉够了就要回到正轨奋斗了。好好利用这几个月。</p>

<p>接下来&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;..要不要，从HTML重新开始呢呢呢,不知道俺的Ruby/Rails 还剩几多斤两呢, 好吧,都不是, 从工具开始, 回归使用Vim好了&#8230;&#8230;&#8230;&#8230;&#8230;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[照片的故事]]></title>
    <link href="http://xguox.github.com/blog/2013/06/03/photos-and-stories/"/>
    <updated>2013-06-03T16:30:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/06/03/photos-and-stories</id>
    <content type="html"><![CDATA[<p><img src="http://farm8.staticflickr.com/7332/8942652946_af9121957f_n.jpg" alt="" />
<img src="http://farm8.staticflickr.com/7289/8942653776_bdfb3e28a3_n.jpg" alt="" />   <br/>
那时候，你们在想着什么，仅仅只是摆着姿势那么简单吗？<br/>
你说我穿的太colorful了，没有你那么忧伤  <br/>
要是我的最深处也这般colorful那该多好</p>

<p><img src="http://farm8.staticflickr.com/7432/8942651358_e04d1e5d94.jpg" alt="" />
<img src="http://farm4.staticflickr.com/3732/8942025755_d37f645d5d.jpg" alt="" /><br/>
不知道你是望着天空还是闭着眼睛，我自己也忘记了<br/>
草地不很舒服，但给的感觉却让人享受着可以睡去</p>

<!-- more -->


<p><img src="http://farm8.staticflickr.com/7350/8942022805_03c7825513.jpg" alt="" />
<img src="http://farm6.staticflickr.com/5346/8942644888_259c5a6e7e.jpg" alt="" /><br/>
背影总给人有沉重感，仿佛，这些年的影子都被呈现出来了。</p>

<p><img src="http://farm9.staticflickr.com/8538/8942627584_def59fc38f.jpg" alt="" />
<img src="http://farm4.staticflickr.com/3757/8942628346_e2ac194f1b.jpg" alt="" />
<img src="http://farm4.staticflickr.com/3723/8942002947_60ddc9872b.jpg" alt="" />
<img src="http://farm6.staticflickr.com/5328/8942627264_17b43443fa.jpg" alt="" />
<img src="http://farm9.staticflickr.com/8272/8942004051_e1ee9b1655.jpg" alt="" />
<img src="http://farm8.staticflickr.com/7387/8942626614_68f3ce0409.jpg" alt="" /><br/>
路，一个人走，两个人走&#8230;回头，总能望见你</p>

<p><img src="http://farm4.staticflickr.com/3722/8942006795_499d3efaf2.jpg" alt="" />
<img src="http://farm9.staticflickr.com/8136/8942630138_91654db5d7.jpg" alt="" />
<img src="http://farm4.staticflickr.com/3799/8942011361_e2d201dae8.jpg" alt="" /><br/>
路过的行人都不自觉就把我们设为焦点，或轻轻一笑，或心有所思，谢谢为我们合照的那个人。 <br/>
说自己垃圾，说自己病痨<br/>
我情愿被你们这么说<br/>
也不要自己自嘲</p>

<p><img src="http://farm3.staticflickr.com/2837/8942001679_4fb28efb7b.jpg" alt="" />
<img src="http://farm6.staticflickr.com/5335/8942002583_080e5a9e0d.jpg" alt="" /><br/>
低头，抬头，仰望，俯视，在同一个位置</p>

<p><img src="http://farm8.staticflickr.com/7348/8941980615_d394b6f30f.jpg" alt="" />
<img src="http://farm3.staticflickr.com/2850/8941978751_2d21c5ec0b.jpg" alt="" /><br/>
你说，车站总给人有一种说不出的感觉。<br/>
我说，等，等待，等车，等人&#8230;</p>

<p><img src="http://farm8.staticflickr.com/7359/8941984311_fd5057e945.jpg" alt="" />
<img src="http://farm8.staticflickr.com/7385/8942620208_e60bb022e2.jpg" alt="" /> <br/>
你想拥抱雨，正如我也那么想被雨穿透</p>

<p><img src="http://farm6.staticflickr.com/5464/8942610446_8b5ce4132e.jpg" alt="" />
<img src="http://farm4.staticflickr.com/3676/8941991289_ef499b456b.jpg" alt="" /><br/>
无力的文字已经不足以描述我有多爱这两张照片</p>

<p><img src="http://farm4.staticflickr.com/3665/8941981741_85e92f11b2.jpg" alt="" /><br/>
多谢路过的小师妹，一开始，因为我之前把ISO设置到了6400，还开着闪光灯，闪瞎了&#8230;折腾了几下才发现问题。<br/>
小师妹问，你们是大四的师兄吧？<br/>
我可以这么回答吗？我们还在读高中！</p>

<p>从未想过摘下腕带，尽管它们普通的甚至有些寒酸，也不是谁的珍贵礼物，只是我自己给自己的地摊货，但它们好像是替代你们看着我。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[负能量 - 从支纤镜说起 - 正能量]]></title>
    <link href="http://xguox.github.com/blog/2013/05/14/negative-energy/"/>
    <updated>2013-05-14T23:05:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/05/14/negative-energy</id>
    <content type="html"><![CDATA[<p>尽管日期标的是May，但是写的时候，是在April 27th - 并刚做完支纤镜 - 耳边塞着耳机，麻醉也还在，全身如喝醉酒那般，浑坨坨，当然只是轻度的，不然我也不可能写的出这些。<br/>
被病魔缠着也有半年了，目测还得继续治疗休养多半年。<br/>
说说这个支纤镜吧。第二次做。比起第一次，尽管有了些许经验(也正因为有经验)，做之前还是有些小紧张，表现主要有心跳略有加速。很重要的一点上次的医生没说而这次的医生教了，&#8221;(粤语)吞口水，无口水就做吞口水噶动作&#8221;。难受是必须的，在某个point我一个没忍着，口中就吐了一堆我自己也看不着啥，anyway，死不了。</p>

<p>耳机里播放着《仓颉》</p>

<!-- more -->


<p>只有我一个人在医院，不要问我爸妈在哪，他们比任何人想在我身边，只是我比较脑残，他们越是关心我我越不让，总会吼回去（脑残吼？呃，俺不是BL老大）关于这点我觉得我应该去看看心理医生。<br/>
好吧，其实我觉得不单这个我也要去找找心理医生。患病的这些日子以来，已被打磨的没有任何锐气了。<br/>
身上多了一道大疤痕，尽管日常情况下几乎看不到。但是要是裸身照着镜子还是会被吓呆。再加上，看着自己瘦得这副排骨身板，哎，同样的那么大的痕，在Luffy和Zoro身上怎么能那么酷！<br/>
身体的不堪，也让我辞去了工作的机会，好吧，实习。我坦然接受了，毕竟，我认识了 @linlis 他们，我的技术、认识也得到提高，好吧，我承认好久没碰过ruby/rails了。尴尬，连语法都生疏了。<br/>
所有的这些，比较尴尬的是工作吧，看着身边认识不认识的同学拿到好的坏的offer，而我…即使再过些时日痊愈了…赶脚被拉开距离了&#8230;</p>

<p>大四，大四下，是个奇葩的学期，各种琐事，课程重修，毕业体检，毕业照，毕业论文，外加这最麻烦的肺。心里头压根没法真正静下来学习（Front-End）。so，其实这些时间我只是在翻译一些国外的技术文，以meteor为主。</p>

<p>耳机里播放着《十面埋伏》</p>

<p>但是，一看到雅安的状况，我瞬间觉得自己更弱爆了，比起那儿的灾难，难道不是幸福的吗？我™还要愁毛线撒？<br/>
我是个会反思的人，这点必须赞自己，但是，在这个思之后，却似乎没有省。<br/>
我自我安慰，完全不用焦急任何的东西，身体最最最™重要。<br/>
我心里总对自己说，大不了晚毕业一年呗，反正本来就比同班的普遍小了一两岁。可是我会这么想，却不会这么去接受，总是心不甘。有点渴望离开校园。<br/>
某些时候，我会装的很孙子，而某些时候，却又一点都不肯示弱。</p>

<p>耳机里播放着《the dawn》</p>

<p>某一个晚上，石头酱开导我说，你不要辣嚒大的报复心(抱负)啦!  这个引发了我想了关于抱负好久。有很大的抱负吗？我没要去改变世界，撬动世界啊，就想安安乐乐的enjoy着写代码而已。 我原本是这么以为的。</p>

<p>写到这，麻醉也去了7788了，不过手上还是插着吊瓶的针。耳机里播放着《数码暴龙1 主题曲》，LOL，略脑残是伐？不单这首，还有，《One Piece》的所有OP，《龙珠》的某一部OP，还有几首以前翡翠台播的动画的主题曲。Anyway，Don&#8217;t u think they are fucking awesome and memorable？</p>

<p>在医院呆着其实也没什么不好的，至少的，我的作息正常的多，早睡早起，杠杠的，偶尔还能瞄瞄护士(看口罩是伐?) ，写到这我想起刚刚做完支纤镜荡回来的路上很巧的遇上，几个月前同一病房的病友的老婆，然后就混混沌沌的跟她扯了一会，尽管她戴着口罩(我居然还能认出来)，不过看得出比之前那会憔悴了许多，正如我家的两老也是。想来他老公会比我要承受稍大一些的心理压力，上有老，下有小&#8230;所以，横看竖看，我还是得跟自己说，不是什么大事。</p>

<p>写到这，换针水，鸽的血倒流出来了。a~ a~ a~ a~ 护士妹纸，快来啊！！！<br/>
写到这，耳机播放《其实我介意》<br/>
写出来，即使没人看见，也总比藏在心里舒服！！！</p>

<p>=================================================</p>

<p>May 14th</p>

<p>我不是一个适合传递正能量的人, 因为我身上似乎充满负能量， 或者很轻易就陷入进去。</p>

<p>这不是一次好的“散步”，我带去了不少负面情绪。与初衷背道而驰。</p>

<p>听到你妈妈对我讲的那些, 除了揪心还是揪心, 只因我也曾经深切的体会过那般剧烈的苦痛。因为有过切身体会，所以仅仅是几句简单的描述，足以让我想象得到那些场景。或许某些东西上你比我更痛苦。 那些我未曾经历的…</p>

<p>原来我们还会有这么个共同点，都有这样的坏毛病，都那么的不希望被担心。尤其是至亲。不到真正必要时刻绝不想麻烦他人，即使是至亲。即使躺在那张让人浑身不自在的病床也不愿落下看书。（这点毕竟还是你强悍啊，我之前也就床头边摆着《失控》或者《JS高程》，而你从床边到抽屉再到一书包的，各种书。）</p>

<p>正因为这么的相似，所以，那一刻，我真不知道该说什么回应这位悲伤的母亲。</p>

<p>今天这种尴尬不能再有！</p>

<p>咱不该比谁更悲惨，我也不该过多抱怨自己的这个悲剧，这都不应该。</p>

<p>但确实性格使然。</p>

<p>忽而发现我真的不知道如何去安慰一个人，因为我满脑充斥的都是负能量。</p>

<p>于是，决定解放自己，摆脱负能量，从自己开始。</p>

<p>祝福</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Repost]关于D一族的真相以及历史文本的分析]]></title>
    <link href="http://xguox.github.com/blog/2013/05/12/record-of-the-void-century-and-d/"/>
    <updated>2013-05-12T14:16:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/05/12/record-of-the-void-century-and-d</id>
    <content type="html"><![CDATA[<h2>关于D一族的真相：</h2>

<p>路飞等人，一出场就有了与众不同的名字，即在名字当中比所有的普通人都多了一个D字，而海贼里不像现实中的美国等国，有MiddleName这个属性，事实上除了D一族的人以外，漫画中还没有出现过三个名字的人物。这真的是D一族自古流传下来的特殊起名方式吗?</p>

<p>我的观点是，是流传下来的，但这个起名方式却是从800年前刚刚突然开始流传的。因为罗宾在读到海底森林的历史文本时，最后的署名是“乔伊波伊”，这个人物很明显与D一族息息相关但却没有D（该人物具体分析见后文）。</p>

<p><img src="https://uvqrqa.dm1.livefilestore.com/y2pfqTNQa7HcK__HqPl6n8RqzkF080dUaO13KHRGdeduPCn-y7geS-x6xcW98_F9QgJFV5HI9qMPiUUef_-3gpCxx8GRC1mKy-BgjZdoUiLP48/838ba61ea8d3fd1f45f53966314e251f94ca5fe9.jpg?psid=1" alt="" /></p>

<!-- more -->


<p>在漫画中，一个名字，两个名字的人物都数不胜数，而三个名字的人物只有D一族而已。我想D很可能是因为国家遭难后，被迫背井离乡的人们为了不忘记国家而特地加进名字当中的，而D很可能就是以前王国名字的缩写。这样一来乔伊波伊在历史文本的署名里没有D就很好理解了，因为800年前，他们的名字没有加入D，所以乔伊波伊留书给友人时不会平白加个D进去。</p>

<p>这里容许我先把D的真相先放一放，分析一下古代兵器 <br/>
古代兵器一共有3个，分别是冥王Pluton，海王Poseidon，以及天王Uranus。<br/>
其中的普鲁托和波塞冬的真相已经揭露，分别是一炮能轰掉一座岛的战船和能控制海王类的人鱼公主。天王乌拉努斯是什么呢？因为有了人鱼公主是波塞冬的先例，所以天王已经不局限于“兵器”的范畴里了，而且已经有了威力惊人的普鲁托，再有类似战斗力的兵器也有些多余，即便天王是所谓能在天空飞的船，用处似乎也不大（能源问题也无法解决），所以我认为天王不是真正意义上的兵器。<br/>
三个古代兵器都是D国的最高机密，但前两者都并非出自D国，如果三者都来自外界的话，D国似乎没什么理由成为独占这三个兵器秘密的国家。所以天王乌拉努斯应该来自D国，并且是人类。</p>

<p>推理到了这里，就回头来看一下D国的名字吧。波塞冬这个海王之名既然来自人鱼中的尼普顿（海神）一族，那D一族自然就是天神一族了。如此一来我脑海中就浮现了一个D开头的天神的词汇Deus迪乌斯。如果是这个词，我觉得一切都能串联起来了，在奥哈拉的时候，尾田特意安排不让教授说出该国的国名，就是知道提前泄露了这个国名的话，那D的神秘就被揭开了大半吧。</p>

<p><img src="https://gagqnq.dm1.livefilestore.com/y2p30ujb7bNrRXuFeG7IQpRLehjTwGrg8_sQOph6h1rbsnLp9LEnoZ-WjJZiTziIiAlKSsMXxZ_wLc_dl3490Z2GIvJyzUm2iwZL1BTpOIeC2k/e5f5bc3eb13533fa874a0872a9d3fd1f40345b9f.jpg?psid=1" alt="" /></p>

<h2>天王Uranus的真面目</h2>

<p>我觉得该“兵器”势必要有与“天”有关惊人的能力，并且该能力必须跟人鱼公主那样，是某个独有的能力。而漫画至今为止，满足这些条件的能力只有一个了，可能有不少读者知道我在说什么了，没错，指的就是目前只显示了冰山一角的，海贼王罗杰的“聆听万物之声”的能力。所以，我的结论就是，古代兵器天王乌拉努斯，以前是海贼王罗杰，而现在指的则是路飞。</p>

<p><img src="https://gagqnq.dm1.livefilestore.com/y2p5r9RVEDBkkC0Y9ym_wuy0OTM2RKLpUExNVT682E8JJDxfE4s7cdMWOyeRV0wLzmrGpBcyLO1UdyXg7-vvlqw9XEZiO7x6Gnu2sUvFqxiM4c/edf2a9ec8a136327e285586f908fa0ec08fac734.jpg?psid=1" alt="" /></p>

<p>有了这个结论之后，有很多东西都更为明朗了，比如我查阅之后发现，Uranus的含义不仅代表天空，还象征了希望与未来，这不正是路飞的特质么。</p>

<p><img src="https://tupdbg.dm1.livefilestore.com/y2p37k-nIzvb3mtO8Z1-_EVJCD1xtW8XyDozEOuxeai8BeXCpkHHTmG_mZHoPK3epkhEsDtAycuSGy9_2iTn557h6VmlqDIFv3KwsaHKQkOcAc/f2d91bd5ad6eddc47de02ea738dbb6fd52663310.jpg?psid=1" alt="" /></p>

<p>而在顶上战争中战国元帅的异常反应，以及之前表现出的对D的异常警觉，我觉得也得到解释了。要知道，在新世界里霸气不说烂大街，但也不是稀有到极点吧，多弗拉明戈啥的都有霸气了，而G5小兵们的反应，也没有像他这样夸张。那为什么见多识广的战国会对个霸气，对个D族海贼如此惊讶呢？我想是因为他还知道一个事实，那就是，D一族的人如果拥有霸气，就有成为天王乌拉努斯的可能（就像海王波塞冬的能力局限于王族的人鱼）。</p>

<p><img src="https://uvqkyq.dm1.livefilestore.com/y2p15mcfbDi0AFQMVedyw_k7fOfLCfrPX_h7tV43Re8ksYUEaFQc64bc3bFhl8-JTwyhgCDjpnbdw0v8twmvKM_rGFlA0_G4qOfpHNXbZIRs48/c8b6033b5bb5c9eab80698bfd439b6003bf3b3a7.jpg?psid=1" alt="" /></p>

<p><img src="https://uv8asw.dm1.livefilestore.com/y2pNpqBNJsn1eWkN8RVxH4Z0a87gH8M3t2o8bpQm5yVyCbdiyFOEGKRozsi2-FQzHXGjvQarc4OeXy3PKLJooDmEzPeM3JtzyUEVW6zDfq209U/e7f8ad6eddc451daacf196b7b7fd5266d0163210.jpg?psid=1" alt="" /></p>

<p>这也符合了战国对艾斯说的这一番话，这个资质，即不是指是个高手就有的霸王色霸气，更不是说能把武装色见闻色练到多强，指的其实是“聆听万物之声”这个能力。这里战国说的“海贼王”，指的就是“天王”，他不挑选四皇的任何一人（至少红发有霸气），而偏偏说艾斯会成为“海贼王”，不是说艾斯的能力或战斗潜力，而是因为他是D族，惧怕他成为“天王”。</p>

<p>就像在20年前，罗杰被冠上了“海贼王”的名号，就实力来说，也并没有说过罗杰就比金狮子，白胡子等人强了。只是去过拉夫德鲁就被封海贼王，是否有点不妥呢。我认为，这其实是知道真相的ZF高层赋予的名号，五老星清楚的知道，罗杰是古代兵器天王乌拉努斯，也惧怕他的意志，他的能力，于是把跟ZF敌对的“天王”冠上了“海贼王”的头衔，让普通民众去憎恨这样一个存在。</p>

<p><img src="https://tureeg.dm1.livefilestore.com/y2p7O7HYWQqHDu0JsNMBIjyeUEDlmwde9p7u8AnoAQAcE0lQOhAVNAYcnIP9mXllv9tI1NiZJAShA38sKTR3qt7Za7QY5J0o8_2NGcfcZqxKhY/ff165bb5c9ea15ce981b7b55b7003af33b87b2a7.jpg?psid=1" alt="" /></p>

<p>这种表达与真意有差别的说话方式，也是尾田这个老狐狸一直玩的把戏了。听起来就像是说艾斯实力会变强到成为海贼王啥的，知道内情的人才知道这是指天王的能力会觉醒。同时我也了解了为什么尾田一定要安排艾斯在这里死去，安排路飞非要在2年后才觉醒了这种能力。因为就像波塞冬一样，天王乌拉努斯在一个时代只会出现一人，这样一来，与路飞同样是D一族，性格相同，做法类似，同样意志的艾斯，很可能会先于路飞一步觉醒该能力，故事就变成艾斯传了。</p>

<p><img src="https://7nmmeq.dm1.livefilestore.com/y2pofDYf8635GNVnad1kvfQqCWcM7T9LoY0fwkxBmHi0rddBVhCZU1IgbLcs_Tfb9tru89yb-SBjc7D9hvO9beFWwFHqOz7Z46gkQoTF5DyzgM/21e951da81cb39db99c7fd0ad1160924ab183010.jpg?psid=1" alt="" /></p>

<p><img src="https://uv8hkg.dm1.livefilestore.com/y2pPA59Q5_rujOviWT4zGnOIHgkaQbxleenJ6iSOyORoCQHoZF5PFzFEyrgQJC_3b-jDtGilZBiPO8Lf8IHInnhU03V6FGx17nHEK6y9SpGlAs/adf781cb39dbb6fd625c7f7a0824ab18972b3710.jpg?psid=1" alt="" /></p>

<p>同样的，知道真相的白胡子在临死前说罗杰等的不是蒂奇，这也许是因为只是D族，只有霸气还不够吧，还需要继承D的意志，三个齐全了才能觉醒。</p>

<h2>一窥天王乌拉努斯能力的一角</h2>

<p><img src="https://gagqnq.dm1.livefilestore.com/y2pb4WHFN8IFVdQunF8Pa7k0LihzpIEp-k6sB-NEsL1WfQVXN_CaTWzmQ0giUEV-jUxOI29b8F5cD059paTGmrWpTnd_DUQlvIfY1HHvhcgW_Q/763e632762d0f703131d0f8009fa513d2797c5e9.jpg?psid=1" alt="" /></p>

<p>综合雷利的说法，他们不认识历史文本的文字，但在空岛上，罗杰切切实实的说将文字（而非石头本身）带去了目的地，并且在边上的黄金上留下也是这种文字！</p>

<p><img src="https://uv9q1g.dm1.livefilestore.com/y2pZhTd6h45qNcQCx5qEUXq-eigqS7TN45du1Gd7hkmgRttzwMtYqLGtddS-8oLIIs0mW7pvHxZLFZgDA_aPqZFL0RG9hJXm2Z3j9QQAnUZwfw/c52c213fb80e7bec812998bd2e2eb9389a506bad.jpg?psid=1" alt="" /></p>

<p><img src="https://uv9qna.dm1.livefilestore.com/y2ptCrdmtJMdUgzV_F96rOt-gPnE3dtZPF8IhQvijDMH1T971W5ZYu0SODxxIY5tvi7U5X70TW70WYsO4-ShTNGs74PbR084H3siIuVFXxKYGA/8fdd82025aafa40f0d885481aa64034f79f019c9.jpg?psid=1" alt="" /></p>

<p>再结合漫画中明确透露的该能力能听懂海王类的对话（无法像波塞冬对其进行召唤与命令）。我想，这个&#8221;聆听万物之声&#8221;的能力应该没有任何夸张，确实它能听到“万物”的声音，万物包括记录历史文本的石头。</p>

<p><img src="https://7nncyg.dm1.livefilestore.com/y2p1NgYDTVDAFfNw8XQEJfp1ocjLwTSES8qzGnEnHz2SG0c09KSxkSkBFMrRXNY6yFM78A9qnuJG6Xlucrm92CUnkWLWCDeWMFX-Bsem-EoKpY/44237bec54e736d1f85a17549a504fc2d46269cb.jpg?psid=1" alt="" /></p>

<p>这样一来，这块无法破坏的石头为什么能刻上文字也能说得通了，即便D国有在石头上刻字的技术手段，也应该不会让工匠来操作。更何况海王，冥王这种情报，我觉得应该是除了“王”以外不该泄露给任何人的信息。这样，能在石头上写上字的人乔伊波伊自然就是原初的“天王”，那该如何写字呢，石头无法破坏，罗杰更是不认识这种字。这里只能运用“听”的能力了，我认为，该能力能与万物进行“交谈与控制”，而石头黄金等物体会“听从”天王的命令，浮现他想记录的信息，也就是说，文本上的文字可以说是“石文字”，而罗杰那时就是靠这个能力，从石头那里“听到”了记录的内容，并“命令”旁边的黄金记录下该任务“已完成”的信息。</p>

<p><img src="https://gagqnq.dm1.livefilestore.com/y2pomnNI6dgcTcMvJ-uGVNkkmhPRnMLlnd9jhBQ0MBNh0mv1HGaPzyUud-97MO1N8W7r3MBaBa7rqitc3pGJZaGfKImXJbxVCC5JvwzWbdwF5A/b7d6fbedab64034f3283585aaec379310b551dc9.jpg?psid=1" alt="" /></p>

<p>能与石头进行对话的能力，从鱼人岛的谢罪文中也能一窥究竟。尼普顿很清楚的说了，这据说是写给人鱼公主的，但详细内容没流传下来，所以尼普顿不认识这些文字，国王都不认识了，很明显以前的王族都不会认识。但如果要写信的话，用大家都明白的文字写是常识吧。但偏偏石头上的还是这种鸟文，我想这也从侧面证明了石头上写字的人无法控制显示的字体，即无法人为的在这些石头上刻字。</p>

<h2>二十国攻打天神国的缘由及导火索</h2>

<p>在800年前，D国就拥有了三个古代兵器的助力，又有“天神”的国名，很可能属于君临天下的国度。应该是世界各国的领导者。可惜的是，这个国家的施政方针让一些国家的贵族，王族产生了不满。</p>

<p><img src="https://7npb7q.dm1.livefilestore.com/y2pug1GsjZunfwEXlFl2OLfdHfdFf6jokVuN2Pok_7MduOKj_0iv7SegR6Se4aSoeVENL8YjeePGGFawTavxUY_tftuu8cMr31i6zQPZGKPMtE/6202070828381f3086bb17f5a8014c086f06f0fe.jpg?psid=1" alt="" /></p>

<p><img src="https://gagqnq.dm1.livefilestore.com/y2pJGG2u-UJI7M2C_2w5grJoJpaLuNEPKJzraSbDYkIV6ZITmmG3CAHH1E5wWH0h6WXIZ_hhNi8NF4gKiHd90E8PIl5s6YDIR71J8j57O40ua0/fb2528381f30e924c806066d4d086e061c95f7fe.jpg?psid=1" alt="" /></p>

<p>就漫画中揭露的几个王族来看，可以清晰的看到两个极端，一种是像沙之岛和鱼人岛那样，王族与民众都相濡以沫，没有隔阂。一种就像天龙人，哥亚王国那样，尊卑分明，下等阶级被当做垃圾，当做奴隶。虽然各国有各国的做法，也算互不相干，但天神国作为世界各国的领导者如果这么做的话，问题就严重了，恰巧D国托付历史文本的两个国度都是没有明确的尊卑之分的国度，可以想象D国的王族也是类似这两个国家的。</p>

<p>一直以来，都是号称“君权神授”，君王总是以“天子”的姿态，让民众敬仰，崇拜，服从。但若是各国领导者的“天神”一族的天王要与民众们平起平坐的话，那阶级思想根深蒂固的国王们以后该如何服众？为了保住自己的地位，“王”决定要挑战“神”，于是20国的联合军出发将神一网打尽了。</p>

<p>而“神”虽然有冥王，有波塞冬相助，但如果他们以暴制暴，那就与初衷完全相悖了。于是他们选择了隐忍，将一众族人分送去世界各地，并留下了历史文本，希望D国逃难出去的人们能出现D意志的继承者，并能找到更好的方法来打破贵族与平民之间的鸿沟吧。与其说这是20国与D国的对抗，不如说是这个世界古旧的制度与新的思维之间的对抗，这就是一切的源头。</p>

<h2>导火索</h2>

<p>我认为就是将鱼人岛移去地上的这个决定。</p>

<p><img src="https://uvpnza.dm1.livefilestore.com/y2pvW7f8IKTfYROnqtR2bxZA3NFg64Btq_1Dt7ST_gCvH2nEPrZVlS3jeUCOt8SxvOtSlk_Qs8sthxTtSVIj1zPx0k7xJS2FBFvlJuyWg-N_W0/6310f8dcd100baa1d7c7dce74610b912c9fc2eb4.jpg?psid=1" alt="" /></p>

<p>罗宾在一开始就说了，鱼人岛的历史文本，是至关重要的。但如果仅仅是写给人鱼公主的私人信件的话，再怎么也重要不到哪里去。但是将各个线索串联起来看一下的话呢？</p>

<p><img src="https://7nolba.dm1.livefilestore.com/y2pPLCWFaY4K4stKt0-A09iSiTz7Uf1o4jgkSP6oDRYOUkfl3PdEvbZMoUsb_UXNaSZ664B1yuD0rWNd_u6DuRlsfVKMTdNimshGFSsz55BPq0/26994aed2e738bd4d5f7286da08b87d6267ff942.jpg?psid=1" alt="" /></p>

<p>奴隶制度，人鱼和鱼人被认为是鱼。在鱼人岛的偏偏是谢罪文，为何要谢罪，是因为无法完成约定。那也就是说，之前D国的乔伊波伊已经与尼普顿一族约定了要把鱼人岛移去地面上。但有波塞冬的力量，移动诺亚搬去海面不是轻而易举吗？为什么会做不到呢？</p>

<p>这里我能想到的就是世界会议了，在过去的世界会议上，身为盟主的天神国决定帮助鱼人岛移去地上，在当年的世界会议上提出了该提案，遭到了对鱼人深度种族歧视的国王们的反对和憎恨，并导致了接下来的灭国。于是才有了这封谢罪文。而这个约定，也致使对D国积累了诸多不满的20个国家的国王终于下定决心要灭掉这个危险的存在。</p>

<p>现在就期待着路飞，这个新时代的象征希望与未来的天王乌拉努斯，能亲自一个一个国家的进行调和，将D国的意志真正的融入到每个民众心中，一环一环的打破古老的枷锁，让世界的风向朝向自己。这样，一定能够打开崭新的局面吧。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Repost]与父亲在一起的日子 (组图)]]></title>
    <link href="http://xguox.github.com/blog/2013/05/11/repost-days-with-my-father/"/>
    <updated>2013-05-11T13:52:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/05/11/repost-days-with-my-father</id>
    <content type="html"><![CDATA[<p>昨天是父亲节。</p>

<p>半夜里，我突然想起来，曾经推荐过一个美国摄影师的作品。母亲去世后，他就拍他的父亲，还写下自己的感想。</p>

<p>这组作品，我看过多次，昨天再看，竟然又一次被感动了。儿子对父亲的关心、对老年人衰老和孤独的感慨，都在其中得到了细腻的体现，非常感人。</p>

<p>网上似乎还没有全文翻译，我就把它译了出来，再一次推荐给大家。</p>

<!-- more -->


<p>=============================================================</p>

<p>与父亲在一起的日子<br/>
作者：Phillip Toledano<br/>
译者：<a href="http://www.ruanyifeng.com/blog/2011/06/days_with_my_father.html">阮一峰</a> <br/>
原文网址：http://www.dayswithmyfather.com</p>

<p>1
<img src="http://image.beekka.com/blog/201106/bg2011062001.jpg" alt="" />  <br/>
这是一份日记，记录我的父亲。</p>

<p>2
<img src="http://image.beekka.com/blog/201106/bg2011062002.jpg" alt="" />  <br/>
我希望留下我和他在一起的日子。</p>

<p>3
<img src="http://image.beekka.com/blog/201106/bg2011062003.jpg" alt="" />  <br/>
2006年9月4日，母亲突然过世，将照顾父亲的重担一下子留给了我。父亲患有健忘症，经常不记得几分钟前发生的事。<br/>
我带着父亲参加了母亲的葬礼。但是回家后，每隔15分钟，父亲就问我母亲去了哪里。我不得不一遍遍地解释，她死了。父亲震惊极了，问我为什么没人告诉他？为什么不让他参加葬礼？为什么他从没去医院探望她？&#8230;&#8230;他全忘了。<br/>
于是，我改口说，母亲去巴黎照顾生病的舅舅了，暂时不回来。</p>

<p>4
<img src="http://image.beekka.com/blog/201106/bg2011062004.jpg" alt="" /><br/>
年轻时，父亲非常英俊，在好莱坞当电影演员。他不喜欢自己现在苍老的样子。<br/>
我让他看着镜子，想拍一张肖像。他看到镜中的自己，顿时变得非常不安。<br/>
你看，即使到了98岁，他还是有虚荣心。</p>

<p>5
<img src="http://image.beekka.com/blog/201106/bg2011062005.jpg" alt="" /><br/>
屋子里到处都是他留下的小纸条，上面写着&#8221;人都到哪里去了？&#8221;、&#8221;发生什么事了？&#8221;&#8230;&#8230;这显示了他内心深处的恐慌，他从不对我说这些。</p>

<p>6
<img src="http://image.beekka.com/blog/201106/bg2011062006.jpg" alt="" /><br/>
父亲握着我的妻子卡拉的手。<br/>
每当卡拉画眉毛或者穿新裙子，他都会注意到，他对细节很敏感。另一方面，他还赞美卡拉&#8221;身材好&#8221;，喜欢看卡拉穿短裙，我觉得很有意思。</p>

<p>7
<img src="http://image.beekka.com/blog/201106/bg2011062007.jpg" alt="" /><br/>
这是拉尔夫叔叔的照片。他是父亲的弟弟，去年死了，父亲还不知道。</p>

<p>8
<img src="http://image.beekka.com/blog/201106/bg2011062008.jpg" alt="" /><br/>
父亲经常对我说，他想死。他说是时候走了，他已经活得太长了。<br/>
很奇怪，我竟然有些赞同他的想法。他现在如此健忘，这样的生活根本不能叫做生活，而是一种折磨。但是，这个世界上，我的直系亲属只剩下他一个人了。</p>

<p>9
<img src="http://image.beekka.com/blog/201106/bg2011062009.jpg" alt="" /><br/>
这是我家的狗乔治。父亲不记得她的名字，就叫她&#8221;狗狗&#8221;。<br/>
晚餐时，父亲喜欢把菜扔到地上喂她（这总会吓到母亲）。当乔治朝着地上的菜窜过来，父亲就会很高兴，夸她可以去拍电影。</p>

<p>10
<img src="http://image.beekka.com/blog/201106/bg2011062010.jpg" alt="" /><br/>
每天，父亲待在厕所的时间很长很长。因为他健忘，所以他可以在那里待上几个小时。<br/>
他常常在厕所里刚系上裤子，就说&#8221;等一等，我要去上厕所&#8221;。这让人又恼火又伤心。我对他说，你已经在厕所里一个小时了，他就会用一付难以置信的表情看着我。</p>

<p>11
<img src="http://image.beekka.com/blog/201106/bg2011062011.jpg" alt="" />
我喜欢他看报纸的那些时刻。<br/>
有那么几分钟，他很清醒，一切看上去又回到以前。那时，我们就不再称母亲去了巴黎，而是说她去买吃的了，一会就回来。那是一天中的甜蜜时刻。</p>

<p>12
<img src="http://image.beekka.com/blog/201106/bg2011062012.jpg" alt="" /><br/>
吃饭总是一个大问题。我现在明白，为什么母亲去世之前，总是烧一模一样的菜，因为父亲只吃那个。<br/>
一般情况下，他只吃鸡蛋，炒鸡蛋、鸡蛋色拉、鸡蛋汤等等。奇怪的是，他的胆固醇一点也不高。</p>

<p>13
<img src="http://image.beekka.com/blog/201106/bg2011062013.jpg" alt="" /><br/>
父亲是一个幽默的人。我把两块饼干放在他的胸口，他说&#8221;快来看我的奶头&#8221;。这难道不好笑吗？</p>

<p>14
<img src="http://image.beekka.com/blog/201106/bg2011062014.jpg" alt="" /><br/>
父亲退休后，依然保持对艺术的热爱。他用大量的时间听歌剧、画画、雕塑。<br/>
虽然现在他不再画画了，但是依然向往艺术。他对日落很着迷，说这些色彩可以画出很多画。虽然身体不行了，他的心还是年轻的。</p>

<p>15
<img src="http://image.beekka.com/blog/201106/bg2011062015.jpg" alt="" /><br/>
父亲是讲故事的高手。从小我就喜欢听他的故事，他的表演可是奥斯卡级别的。<br/>
如果他心情不好，我就请他讲一个故事，他会很快进入角色，把自己忘了。</p>

<p>16
<img src="http://image.beekka.com/blog/201106/bg2011062016.jpg" alt="" /><br/>
今天，他过98岁生日。</p>

<p>17
<img src="http://image.beekka.com/blog/201106/bg2011062017.jpg" alt="" /><br/>
我让他拍一张我的照片。我想知道，他能看出我有多爱他吗。<br/>
我手上的戒指，是母亲去世那天戴的。</p>

<p>18
<img src="http://image.beekka.com/blog/201106/bg2011062018.jpg" alt="" /><br/>
今天是母亲的生日。我总是记不住这个日子，但是今天早上我梦到了她。她在笑。<br/>
要是她还活着，今天就是81岁了。<br/>
妈，生日快乐。</p>

<p>19
<img src="http://image.beekka.com/blog/201106/bg2011062019.jpg" alt="" />
父亲很在意别人给予他的关心。<br/>
每次我去看他，他都把这当做一件大事，总是说他有多爱我。在他眼里，我是一个天才，而卡拉也是我们家当然的一份子。<br/>
我真高兴，这段时间我们在一起。</p>

<p>20
<img src="http://image.beekka.com/blog/201106/bg2011062020.jpg" alt="" /><br/>
我总是被父亲爱母亲的程度震惊。他一直在谈她，对她充满感激，无比珍惜这段感情。<br/>
母亲很爱我，就像胶水一样，把我们这个家紧紧粘在一起。从小她就事事管着我，我有点嫌她啰嗦。有一次，她甚至打电话让我不要出门，因为外面风大危险。<br/>
现在她不在了，我才意识到，我一生都在抵制她对我施加影响。如今它不在了，我却想念了。她应该很高兴听到我这样说。</p>

<p>21
<img src="http://image.beekka.com/blog/201106/bg2011062021.jpg" alt="" /><br/>
父亲很注意健康。早在粗粮流行之前，他就开始吃了。每天早上，他都非常投入地做健身操，弯腰用手指触碰脚趾，还做仰卧起坐。<br/>
他还喜欢往橙汁里加生鸡蛋。他总是问我要不要一起喝，我说这种饮料很恶心，他就得意地哈哈大笑。</p>

<p>22
<img src="http://image.beekka.com/blog/201106/bg2011062022.jpg" alt="" /><br/>
最让父亲开心的，就是我取得成功。<br/>
每当他心情不佳的时候，我就立刻讲一个我职业上的最新突破。我告诉他，我正在为某本著名杂志或者某个大型项目，拍摄重要的作品。有时候，这是真话，有时候，这是假话。但是这不重要，重要的是我要尽可能让他开心。<br/>
他一听到我的这些话，脸上就会露出幸福的表情。他总说：&#8221;我必须让所有朋友都知道，我有一个著名的儿子。&#8221;</p>

<p>23
<img src="http://image.beekka.com/blog/201106/bg2011062023.jpg" alt="" />
有一天，我把父亲以前的电影借回家。那是一部30年代拍摄的《陈查理探案记》，我和他一起看。<br/>
他告诉我，那时太年轻，电影里的小胡子都是胶水粘上去的。看着父亲年轻时的形象，我感觉很奇妙。那时他完全不知道，未来会有母亲和我，我们会生活在一起，生活充满了各种可能。</p>

<p>24
<img src="http://image.beekka.com/blog/201106/bg2011062024.jpg" alt="" /><br/>
父亲又问母亲去哪里了，我还是说在巴黎。<br/>
他又问她现在干什么（除了照顾生病的舅舅），我就说她正在管理一个杂技团，然后做出把头放在狮子嘴里、荡秋千、跳火圈的动作。这让我们两个都笑起来了。</p>

<p>25
<img src="http://image.beekka.com/blog/201106/bg2011062025.jpg" alt="" />
有一次，我们说着说着，他就停下来了，什么话也不说，发出叹息，然后闭上眼睛。<br/>
就是从那时起，我明白他其实都知道，关于母亲，关于所有的事情。</p>

<p>26
<img src="http://image.beekka.com/blog/201106/bg2011062026.jpg" alt="" /><br/>
昨天，父亲去世了。<br/>
我整晚都和他在一起，握着他的手，听着他的呼吸声，想知道哪一口气是他最后的呼吸。他死在家中自己的床上，我和卡拉在他的身旁。<br/>
过去三年来，我一直害怕，他会在我不在家的时候去世。我不想让他孤单经历这一切，不想让他周围有陌生人。我知道，这样说可能不合适，但是我非常满意这件事发生的方式。<br/>
很幸运，过去三年我与他在一起，我们没有话没说，知道彼此深爱对方，知道他深深为我骄傲，而我也发现他竟是如此有趣。这是我的一份非常非常宝贵的礼物。</p>

<p>27
<img src="http://image.beekka.com/blog/201106/bg2011062027.jpg" alt="" />
感谢每一位读完这份日记的人，我从没想过其他人会对这件事有兴趣。我深感荣幸我有这么多读者，我读过你们的每一条留言、每一封电子邮件。<br/>
父亲如果知道我这样做，他会很开心。他希望别人知道他的故事。他的生命从无静止，他就像一条河流，一直在奔腾向前。  <br/>
上周是他99岁生日，我问他知道自己几岁吗？他笑着说：&#8221;22岁？&#8221;
现在，他去巴黎了，与母亲团聚了。</p>

<p>(完)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[如何在一年里周游世界]]></title>
    <link href="http://xguox.github.com/blog/2013/04/13/how-to-travel-around-the-world-for-a-year/"/>
    <updated>2013-04-13T21:54:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/13/how-to-travel-around-the-world-for-a-year</id>
    <content type="html"><![CDATA[<p>在我的上一篇文章<a href="http://www.aqee.net/traveling-writing-programming/">traveling, writing and programming</a>中, 涵盖了我前一年的旅行, 写作, 编程. 而在这一篇文章中, 将会具体地对整一个旅程进行规划,  包括航班, 费用, 活动, 住宿等. 我会向你展示一个廉价实惠的计划.</p>

<blockquote><p>Travel is fatal to prejudice, bigotry, and narrow-mindedness. (旅行是克服偏见、自大、狭隘的最好方法.) &#8212;- Mark Twain</p></blockquote>

<p>远途旅行, 开阔视野, 我觉得这对于常年呆在硅谷的人来说尤为重要. 旅行可以让你见识到人们真真切切遇到的一些问题, 并使你有这样的机会去想办法解决掉, 而不是满脑子都是一些在家的琐碎想法. 一个新的视角, 一个新的想法，也或许就在你的旅途之中诞生.</p>

<p><img src="http://stuckincustoms.smugmug.com/Portfolio-The-Best/your-favorites/i-n54tcJV/0/M/The-Patagonia-L.jpg" alt="" /></p>

<!-- more -->


<h2>选择去哪里</h2>

<p>在最开始, 选取目的地会是一件让人头疼的事, 尤其是当你又对其他的国家都一无所知的时候更是如此. 前年, 我在南非呆过三个月, 于是，我决定从那些熟悉的地方开始进入到我的旅行节奏.</p>

<p>在作出选择之前, 我参观了<a href="http://www.stuckincustoms.com/"> Trey Ratcliff 的 HDR 摄影博客</a>. 事实上, 下面的所有照片都是来自于Trey.  这家伙已经把全世界都游遍了, 甚至还到过许多不可思议的地方.  我只是简单地浏览了他所到过的地方, 然后把我觉得最美丽的列了个清单. 其中列表如下:</p>

<blockquote><p>南非, 香港, 新加坡, 马来西亚, 泰国, 柬埔寨, 越南, 日本, 澳大利亚, 新西兰, 夏威夷, 纽约, 旧金山, 哥斯达黎加, 巴拿马, 秘鲁, 玻利维亚, 阿根廷</p></blockquote>

<p>我的目标是尽可能多的在一年内游览完, 然后在未来某个时候把一些地方再细致地重游一遍.  如果你没有这么多的时间, 我的建议是, 专注于某一个区域, 比如亚洲. 关于下一次旅行, 我的计划是:</p>

<blockquote><p>从北京启程, 坐火车到西藏, 往下到尼泊尔, 环游印度, 直到孟买, 然后飞往东南亚,  穿越泰国北部，柬埔寨，越南和老挝。</p></blockquote>

<p>所以, 换句话说, 你想去哪取决于你的时间, 预算和意愿.</p>

<p><img src="http://stuckincustoms.smugmug.com/Portfolio-The-Best/your-favorites/2035748576c051526ca4o/742619174_op5RY-M.jpg" alt="" /></p>

<h2>安排航班</h2>

<p>相较之过去的种种麻烦, 现在的环游世界机票已经让旅行变成一件轻松的事了.  曾经, <a href="http://bhutanheartslife.co.uk/">我的祖父</a>与女王的信使搭乘一架破旧的飞机一同前往不丹. 在那次飞行中途, 飞机的一个引擎坏了, 结果只能紧急迫降. 更糟糕的是, 在进行了必要的维修后, 他们又得继续搭乘这架飞机继续行程. 如今时代变迁了.</p>

<p>你可以逐个逐个航班的预订, 这会给你更大的灵活性, 也可以直接预订环球机票一次性把所有事情搞定. 出于经济上的考虑, 我选择了后者, 因为很多我需要的航班如果单独预订的话要贵的多.</p>

<p>环球机票的价格范围一般在$3K 到 $7,5K USD 之间. 我的16个航班大概花了$7K. 但实际上, 还是取决于你有的时间, 你飞往的地区以及从哪开始旅程. 这里有个秘诀, 就是在一个不太富裕的国家开始和结束你的旅程, 因为那样的机票通常都会便宜的多.</p>

<p>我是在<a href="http://www.oneworld.com/">OneWorld(寰宇一家)</a>预订的机票, 他们的服务让我非常高兴. 他们的集团包括有美国航空, 英国航空, 国泰航空 和 澳洲航空等. 并且还提供了一个很方便的<a href="http://oneworldrtw.innosked.com/Default.aspx">在线预订工具</a>来计划你的旅程.  无须给旅游代理哪怕一点的佣金, 你可以自己规划你的旅程. OneWorld的一个很好的地方在于它允许你免费更改航班的日期. 但航班的地点更改不是免费的, 所以你必须在做决定前确定你的选择是正确的.</p>

<p>环球机票还有一些限制, 这跟点到点的航线有所不同. 有一些会限制你的飞行里程, 有些则是限制了实际的航班数量. 大部分都会限制你在一个地方只能飞一次, 并且航行的方向是一般固定不变(比如一路往东). 在每一个地方你必须呆至少两周的时间, 大部分的票也都会在一年后到期.  之所以有这些限制的原因是他们不希望有人利用他们来通勤 , 所以在买的时候请记住这些.</p>

<p>我建议你只买洲际的航班, 而短途的航班则只在需要的时候才买. 在亚洲和南美这些地方之间游玩不需要专门的乘坐飞机, 完全可以搭乘当地的公交, 旅游车, 又或者买一辆车(?), 或者徒步行走. <strong>强烈建议你尽量的减少空中的飞行, 更多的在陆上游玩, 这样你看到的, 经历的会更多.</strong></p>

<p><img src="http://stuckincustoms.smugmug.com/Portfolio-The-Best/your-favorites/i-75F2Bvs/0/M/The-Palace-L.jpg" alt="" /></p>

<h1>行装</h1>

<p>只带上一些你确实需要的, 尽可能轻装上阵, 只用你的背就能搞定那就最好了.  从安全的角度着想你也应该这么做. 因为你携带的越多, 你就必须多加一双眼看着.</p>

<p>我刚刚从ebay买了一个90L的背包. 然后在里边塞了一个星期的衣服, 一条毛巾, 一套相机设备. 而实际上我在马来西亚就已经把我的三脚架和潜水服寄了回来. 对我来说他们太过笨重了. 当你发现一些需要的东西忘了带可以直接在当地买. 事实上，我一直坚持<a href="http://guynameddave.com/100-thing-challenge/">这种简约</a>的生活方式, 同时这也是我喜欢旅行的其中一点.</p>

<h2>预算&amp;住宿</h2>

<p>住宿是件简单的事, 尤其当你在一些亚洲很便宜的地方游玩的话. 因为我自己本身有这个预算, 所以一般都住在酒店 - 不包括一些在亚洲或者南非的古怪的酒店. 好的酒店比较难找到, 这需要你专门的在网上做一些调查. <a href="http://hostelworld.com/">Hotel World</a>, <a href="http://www.lonelyplanet.com/">Lonely Planet</a>, <a href="http://wikitravel.org/en/Main_Page">Wikitravel</a>都是不错的选择. 有些地方的设施对旅客非常的友好便利, 例如新西兰, 而有些则相反, 比如夏威夷和日本.</p>

<p>酒店也是一个非常好的地方可以结识到朋友, 还可以从他们那得到一些游玩的建议.  另外你也会遇上一些有趣的人. 我曾经遇到过的有半导体芯片设计师，专业潜水员和量子加密专家&#8230;我结识了一些驴友并和他们建立友谊, 这都是旅行所带给我的乐趣.</p>

<p>整一年我的总预算大概是$15K, 包括我的所有食宿.  这个数目对我来说刚刚好, 我不必住在特别的廉价的地方. 当然, 在你的银行卡上有一定的缓冲预算是好的, 因为这样你可以有个更安心的行程.</p>

<p><img src="http://stuckincustoms.smugmug.com/Portfolio-The-Best/your-favorites/i-nWqB7Jc/1/M/Tree-in-the-Park-M.jpg" alt="" /></p>

<h1>现金与电子产品</h1>

<p>我去的每一个城市都有ATM, 所以取得现金不是什么大的问题.  但我的卡曾经三次因为被怀疑欺诈行为而被冻结了. 我建议你告诉你的银行你的行程, 以免有什么不必要的麻烦. 出于安全考虑, 把你的一些信用卡分别放在不同的地方. 最好使用一些不会收取国际交易费的卡, 否则这可能会是一比大的支出.  很多地方不支持刷卡, 所以现金在手是必须的.</p>

<p>我已经有将近一年没有使用手机了, 取而代之的是我的iPod和Skype. 这其实并没有你听起来那么疯狂, 跟全世界断开联系一段时间事实上感觉挺好的. 由你来选择人们能否联系上你. 如果你确实需要一台手机, 做好国际长途的计划, 并且随时盯紧 - 否则的话被盗那是瞬间的事.</p>

<p>我去哪都随身带着我的Macbook和Nikon单反, 另外还有其他的一堆电子产品. 坦白地说, 这个世界并不是像人们想象的美国西部那般纷乱. 你只需要用平常心去对待就可以了.  或许我是幸运地, 因为在我的旅途中没有一样东西被偷.</p>

<p>插头(插座)也是一些必备的东西之一. 在亚洲使用的插座都是相似的, 可能你经常会遇到插不上的情况. 同样的, 在拉丁美洲, 也是没有接地线的插座.  美式三角插是用不上的, 所以你需要一个国际插头适配器.</p>

<p>WIFI几乎无处不有(在我的印象中越南的网速比美国还要好的多). 网络问题只在一些非洲偏远的地方才会遇上. 如果你想要去一些特别偏远的地方, 那么可能还需要带上一个3G的无线网卡. 在当地购买通常是最好的选择.</p>

<p><img src="http://stuckincustoms.smugmug.com/Portfolio-The-Best/your-favorites/The-Rest-of-the-India-Story/976924259_m5R2b-M.jpg" alt="" /></p>

<h2>活动和规划</h2>

<p>不管做什么, 永远不要选择套票. 我一般初头的两晚呆在飞机抵达的城市, 接着从那启程.  有时候, 我甚至不会逗留. 你需要给你的计划一些容错空间, 不要试图计划好没一个细节.  通常地, 你的计划会在你抵达后从其他旅行者那得到一些建议因此而改变. 随机应变那是必须的.</p>

<p>我个人从不去使用一些指南书籍, 我的基本指南来自于<a href="http://www.lonelyplanet.com/">Lonely Planet</a>. 想便宜一些买到的话则在你登陆的国家买这些指南, 而不是在机场或者你自己的国家买.</p>

<p><a href="http://wikitravel.org/">WikiTravel</a>是我每天都用到的很棒的资源. 但是, 最好的资源还是来自当地人和驴友们的建议. 我曾经在一本黑色的小型笔记本上记下了所有他们给我的好的建议.  我记得我遇到的一个阿根廷人在我的书上画了一张南美洲地图, 并列出了在秘鲁和智利他所推荐去的地方.</p>

<p><img src="http://stuckincustoms.smugmug.com/Portfolio-The-Best/your-favorites/2919966075b29ae42d88o/742622054_3o94P-M.jpg" alt="" /></p>

<h2>同伴</h2>

<p>同行的伙伴是会相互牵扯住的.  所以我建议自己一个人旅行, 强迫自己在路途上遇到更多有趣的人和结识更多朋友. 如果你和其他人一同旅行, 那么请确定你们是非常好的朋友, 因为长时间的旅途会让人变得烦躁.</p>

<h2>签证</h2>

<p>如果你很幸运的是一名美国或者欧洲公民, 那签证将不会有什么大问题. 唯一一个在过境时没有给我签证的国家是越南. 我只好在柬埔寨一间酒店里给了点钱一个家伙让他帮我把签证送到越南大使馆并处理之. 这事情值得提前做一些研究，不过通常来说是没问题的.</p>

<h2>安全保险</h2>

<p>For health insurance I just used World Nomads. They&#8217;ve fairly competitive rates, and are one of the more dependable options.</p>

<p>That said, it&#8217;s often a case of staying lucky and not doing anything stupid. All the insurance in the world won&#8217;t help you if you have an emergency in a remote part of Africa.</p>

<h2>生活方式</h2>

<p>在离开之前我一般会在一个地方逗留上几天, 有时候最多会是一周.  当然, 基于那么频繁的转移, 偶尔的搁浅还是很舒服的.   每当产生那样感觉，我会停留在一个地方几个星期。比如, 为了使得我的书取得一些进展, 我在胡志明市停留了两周.</p>

<p>锻炼方面, 如果不去冲浪的话我会选择在海滩上跑至少半小时. 有更多的时间可以全身心地投入到你的健康, 是旅游的主要好处之一. 每天的冲浪和长跑, 持续几个月后换来的是我从未有过的强壮的身体.</p>

<p>同样的智力上的锻炼也是需要的, 我选择了写书来达到这个目的.  除此之外, 我还会做些阅读或者编程.  保持智力上的平衡是很重要的, 尤其在这么长时间的旅途中.</p>

<p>读完书后, 我会开始hack一些开源项目, 并开发了<a href="http://spinejs.com/">spine</a>. 事实上, spine的第一个版本是我在新西兰做长途车的时候写的. 插上耳机, 祛除杂念的专注于此, 很不可思议吧.</p>

<p>每当我旅行到一个新的城市,  就会提前在ruby邮件列表发帖看看是否有人有兴趣来个聚会什么的.
很多时候都是成功的, 我会和这些人一起聚会然后向他们请教一些问题. 在东京和香港我还做了技术演讲.  在悉尼和开普敦则和当地的ruby团队聚餐了.</p>

<h2>经验</h2>

<p>周游世界可以让你见识,经历到的比你想象中要多的多. 你可以获得国王般的口福, 从你不认识名字的马来西亚的美味水果, 到在阿根廷你所尝试过的最美味的牛排.  你可以在新西兰爬山, 以及秘鲁大峡谷徒步旅行.  还可以在哥斯达黎加难以忘怀的冲浪, 以及就像迎接世界末日那样的开party. 你会遇上一些令人惊奇的人, 改变生活的经历.</p>

<p>这一切都很简单，周游世界，将会是你做的最好的决定之一.</p>

<p><img src="http://stuckincustoms.smugmug.com/Portfolio-The-Best/your-favorites/Warm-Fisherman-in-Guilin/1043857172_py9xC-M.jpg" alt="" /></p>

<h2>总的开销</h2>

<p>整个行程的净成本大概是$22K, 我在为时一个月的事前咨询之前已经支付了其中的一大部分. 或许你会觉得这很夸张, 为了一年的旅行咨询一个月的时间. 我并没有刻意削减我的预算, 我知道有很多人可以花更少的钱完成这一切. 总而言之, 有志者, 事竟成.</p>

<p>边旅行边工作完全也可以成为一种新的生活方式. 如果你是一个程序员, 完全可以远程办公, 至少可以是一年之中的一部分时间远程.  你的客户不会关心你在哪里, 他们只关心你是否把事情做完. 要达到这样的位置所要付出的跟你成为一个成功的contractor是一样的. 那就是实践 和 网络.</p>

<p>坦白地说, 唯一要顾虑的事情只有一个, 时间不多了. 你身上的包袱, 顾虑会随着你的年龄的增加而增加, 在往上, 你想干这些事就更难了.  你应该丰富的是你的履历, 而不仅仅是金钱.</p>

<p>动力无非由两部分组成, 想的程度和可行性. 这些个东西我都完成了. 所以, 也希望看到更多的程序员远途的旅行.</p>

<p><img src="http://stuckincustoms.smugmug.com/Portfolio-The-Best/your-favorites/i-dLcWhrZ/0/M/The-Long-Road-in-NZ-M.jpg" alt="" /></p>

<p>原文来自Alex MacCaw <a href="http://alexmaccaw.com/posts/how_to_travel_around_the_world">How to travel around the world for a year.</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Repost]旅行，写作，编程]]></title>
    <link href="http://xguox.github.com/blog/2013/04/13/traveling-writing-programming/"/>
    <updated>2013-04-13T21:53:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/13/traveling-writing-programming</id>
    <content type="html"><![CDATA[<p>概括起来，今年到目前为止，我所做的事情包括：</p>

<blockquote><ul>
<li>花了10个月的时间做世界环游，途经非洲，东南亚，澳洲，中南美洲里的17个国家和地区。这次旅行的主题就是冲浪和摄影。</li>
<li>出席在香港，日本，美国和伦敦举行的会议</li>
<li>启程时给O’Reilly出版公司写了一本书，书名叫做<a href="http://bit.ly/uFbFJR">《JavaScript Web Applications》</a></li>
<li>另外写了一本关于<a href="http://arcturo.github.com/library/coffeescript/">CoffeeScript</a>的书，很快就会由O’Reilly公司出版。</li>
<li>写了大量的开源库，例如<a href="http://spinejs.com/">Spine</a>, <a href="https://spinejs.com/mobile">Spine.Mobile</a>, <a href="http://maccman.github.com/gfx">GFX</a>, 和 <a href="http://github.com/maccman/juggernaut">Juggernaut</a>.</li>
<li>筹划了一个创业公司的框架</li>
<li>出席伦敦2011<a href="http://futureofwebapps.com/london-2011/">FOWA</a>会议</li>
<li>最后，我在Twitter公司找到了一份工作</li>
</ul>
</blockquote>

<!-- more -->


<p>那么，让我从一年前开始，那是2010年9月，我刚好从一个我合作创办的公司里出来，尽管这段经历是很有价值的，但无休无止的长时间苦干让我精疲力尽。我回到了英格兰，需要对未来做一些思考。我一直有一个梦想——移居美国(几年就好)，所以，我在Google记事本上写了下面的话：</p>

<blockquote><p>人生的选择：
  去纽约哥伦比亚大学深造</p>

<pre><code>坏处 - 非常昂贵，并不一定能学到什么真正有用的东西，无聊?
好处 - 那是一个纽约的大学！
</code></pre>

<p>  写一本书，申请 01 签证</p>

<pre><code>坏处 - 需要大量的时间，有风险
好处 - 对事业有好处，有趣
</code></pre>

<p>  等待。去纽约度一次假(3个月)。等待创业签证。</p>

<pre><code>很容易 - 不是那么有趣
</code></pre>

<p>也许选第二个，不行就选3？</p></blockquote>

<p>最终我选择了2，我已经对JavaScript web应用研究了很久，我要写一本这方面的书，为什么不边做环游世界的旅行、边写书呢？这也是我一个梦想呀。我从oneworld买了一份环游世界的机票(比你们想象的要便宜)，决定下周去我的第一站，南非。</p>

<p><img src="https://lh5.googleusercontent.com/-H3VYHMYwDMk/TsRYhToP2CI/AAAAAAAABfE/7j5TikginMI/s640/rtw.png" alt="" /></p>

<p>如果你从来没有到过非洲，你应该去一次。那里的景色原始而美丽，对那些没有体验过这种景色的人，你很难用言语描绘明白。几年前我就喜欢上了南方，那时我在东海岸做了一个为期3个月的冲浪旅行。这次，我只有一个月的时间，穿越特兰斯凯，从开普敦到德班。当我在南非旅行时，我的写作也开始了，把早期向O’Reilly提交的书的框架里的数章填充了材料。</p>

<p>特兰斯凯是南非非常具有乡野特色的地方，到处是连绵的小山，一些小村庄和土堆的茅屋。他们仍然沿袭着酋长制度，有一个首领，大多数的当地人靠捕鱼为生。我们在高低不平的土路上颠了两天才到达我心仪的地方，一个美丽的海湾，叫做咖啡湾(Coffee Bay)。在那里，我休整了一下，从网上下载了一些相关资料，为更远的海湾远征做准备。</p>

<p>我还清晰的记得我们走了数里地来到那个未开垦的海滩，我们从那些一个个被黄沙和小丘孤立的村庄穿行而过。有一个地方，我们要过一条大河，我们需要游过去，我把背包举过头顶，以免里面的相机和iPod遇到水。非洲是一个让你脱离尘世的地方，解放你的思想，重新认识人生最重要的东西是什么。</p>

<p><img src="https://lh6.googleusercontent.com/-t9Ja-8BnWvM/TOzGcHEVcLI/AAAAAAAAA_I/Gbk7HpkAlyE/s640/DSC_0164.jpg" alt="" /></p>

<p>下一站是香港，在那里，我度过了我的21岁生日，接着，我从陆路由新加坡到越南河内。很多人不相信香港70%的面积由自然公园覆盖，我徒步走了几条精彩的景观路线，非常的精彩壮观，比如：香港龙脊。有几天，我在boot.hk这个网站上闲逛，这是一个协作工作的网站，我顺便教了一个同行的游客如何使用ruby。然后，到了夜里，我跟Soho里的一些<a href="http://couchsurfing.org/">冲浪爱好者</a>狂欢到凌晨。</p>

<p><img src="https://lh5.googleusercontent.com/-w4dOtoMx8FQ/TP92f1yaUgI/AAAAAAAAA_I/CkWZJTnj24s/s640/DSC_0032.jpg" alt="" /></p>

<p>从泰国到柬埔寨到越南是我这次旅行中做喜欢的部分，如果你从没有到过亚洲，你绝对应该去一次。这些国家非常的漂亮，气候非常的好，食物美味可口，人们非常友善。吴哥窟是世上最神奇的地方之一，每个人都应该去看看。是<a href="http://stuckincustoms.com/">Trey Ratcliff</a>的照片把我吸引到了那里，我的很多其它旅游目的地也是受了他的影响。那个家伙是很多旅游地的第一宣传者。</p>

<p><img src="https://lh6.googleusercontent.com/-bLvyRFra6DE/TShMHEaRv5I/AAAAAAAAA_I/cOGMjy8WTyU/s640/DSC_0031.jpg" alt="" /></p>

<p>在一些无名的小博客中，我听有人说过一个很远的美丽的小岛，在柬埔寨的海边。说小岛的Sihanoukville这个地方有个酒吧，说只能坐小渔船到那里。我，还有几个非常好的朋友，乘坐晚上的大巴，开始寻找这个传说中的酒吧。搜索差不多进行了一整天，每一个问过的酒吧都把我们指向另外一个酒吧。最终，我们问了出来，并在第二天早晨做短程巴士去了那个地方。</p>

<p><img src="https://lh5.googleusercontent.com/-dyNjvQtn4GA/TTZ6x3dT0WI/AAAAAAAAA_I/PMQbesSbknU/s640/DSC_0039.jpg" alt="" /></p>

<p>上面的照片上是海岸边一个10美元一晚的小木屋。从当地居民区离开后，我们的队伍像小岛上唯一的人，我们随性自由的奔跑。白天我们懒懒的躺在海滩上，吃着岛上厨师准备的鲜美可口的水果沙拉，在夜晚，我们在到处是浮游生物的海里游泳。</p>

<p><img src="https://lh4.googleusercontent.com/-lLhNdn4DxvY/TTZ74Z7MhEI/AAAAAAAAA_I/TZBf2T5pADg/s640/DSC_0115.jpg" alt="" /></p>

<p>下一站是越南，我们沿着湄公河支流来到一个边界上的小镇，我们是这里唯一的西方人，交流成了最大的问题。幸运的是，我们发现一个也许是镇上唯一会说英语的人，他骑车当我们的向导。当我的信用卡被那里的一个自动取款机吞掉了后，他提供了我很大的帮助！</p>

<p><img src="https://lh6.googleusercontent.com/-r629c1pOE2E/TVCwrLAdL2I/AAAAAAAABBY/r48a8WSsTS0/s640/DSC_0059.jpg" alt="" /></p>

<p>我们的队伍分成了几路，在我到达越南时，我的书正在按计划完成，进行的非常顺利。此时，我在西贡多待了几周，让我在书的好几章上有了重大的进展，正好是中国旧历新年，气氛非常的壮观热闹。</p>

<p>接着是日本，澳大利亚，新西兰和夏威夷。我很难把我所有的感受都在这篇文章里写出来，但说这是此生难忘的一段历程是不为过的。把如此多的美景都放到一个国家里，太让人赞叹了,我说的正是新西兰。我最喜爱的一段记忆是沿着Wanaka的一个湖边在阳光下跑步，还有就是背着食物和生活用品，徒步数天穿越Routeburn的大山。在这个国家的旅途中，我结识了好几个值得一生相伴的好友。这是一个真正的天堂。</p>

<p>就在我环绕新西兰的南部岛屿时，我的书终于完成了，提交给了技术编辑校对。</p>

<p><img src="https://lh3.googleusercontent.com/-hVGczAgcsxw/TZqg8ATYqkI/AAAAAAAABLk/OYT0p-Cq4L0/s640/DSC_0096.jpg" alt="" /></p>

<p>接下来是纽约和旧金山，这两个神奇的地方到处是天才的程序员，有些人我很幸运的认识。Techcrunch Disrupt办的很精彩(我高度推荐hackathon)。</p>

<p>在从纽约到旧金山的中途停留期间，我在各种公司了进行了不少的求职面试，最终在Twitter公司找到了一份做前端开发的工作。要在那里和杰出的团队一起工作，我不能不高兴的颤抖，而去旧金山，同样也是我此生的一个梦想。</p>

<p>当签证的事办下来了后，我去了中、南美洲旅行，同时开发了我的一个小工程：一个JavaScript MVC框架库，叫做Spine。我到了哥斯达黎加，巴拿马，秘鲁，Bolvia，和阿根廷。 秘鲁是我的最爱，尽管那里的海拔给我带来了不少麻烦，我大部分的时间都在探险。下面的图片是哥斯达黎加传说中神奇猎鹰，是在我爬下世界最深的峡谷时拍到的。</p>

<p><img src="https://lh3.googleusercontent.com/-kQInzZ5DQC0/TsXiz712K7I/AAAAAAAABfk/8GfSq98ccwU/s640/DSC_0027.jpg" alt="" /></p>

<p>当我在哥斯达黎加时，微博上有个叫Roberto的家伙给我发了条信息，说他读了我的书，问我是否有兴趣一起冲浪。我欣然同意，坐上去圣何塞的汽车，在几天后和他会了面。那天我们一起在他海边的公寓里开发Spine和Ruby项目，使用移动硬盘，用汽车电源给笔记本充电。当电量不足后，让太阳能板补充能量，我们去冲浪。</p>

<p><img src="https://lh5.googleusercontent.com/-ydIJPFqgspY/TsXgVzCENyI/AAAAAAAABfY/nkOE1Y0N-X4/s640/DSC_0300.jpg" alt="" /></p>

<p>我推荐大家去写一本书，特别是边旅游边写书。可以想象，如果我不去旧金山去看一看，我可能还在旅途中，做顾问，去创业。当作家并不能让你直接的挣到很多钱，但它绝对能提升你的身份地位，给你带来很多潜在的机会。事实上，写作过程让我真正享受的是，我可以认真深入的研究一个题目。</p>

<p><img src="http://ittopic.gotoip1.com/qee/wordpress/wp-content/uploads/2011/12/DSC_0069.jpg" alt="" /></p>

<p>这一年是我这辈子目前为止最好的一年，而我感觉今后的一年会更好。当我如今定居下来后，我并没有感觉旅行对我的吸引力减少了；我始终把签证放到一个口袋里，而另一个口袋里装着钱包，当召唤降临，随时准备离开。</p>

<p>可是，这篇文章并不是关于我的旅行，它是要发送一个信号：</p>

<p>对于程序员来说，有个得天独厚的条件，就是这种职业可以远程工作或边旅游边工作，这是其它职业办不到的。当然，也不都是这样，在我的旅途中，我没有碰到第二个跟我的做法相似的程序员。这种情况让人悲哀。我想向程序员们送出的信息是，不要再找借口了，行动起来，你可以做到。一个人只有一生，我可以向你保证，这样的生活才不枉世间走这一遭。</p>

<p>就像我，我感到极度的幸运，能这样的生活，去发现我的热情所在，去做每天我喜欢做的事情。你可以看出，大部分我现在的境遇并非偶然或侥幸，这是计划，追求，工作的结果。</p>

<p>一份汗水，一份收成。</p>

<p>这篇文章的目标不是做一些自我陶醉似的炫耀和大话，而是向大家演示如何立下目标，鼓励大家去做相似的事情。想清楚你现在的处境，这一年内你想得到什么，制定出一系列具体的能让你到达这些目标的步骤。追随你的梦想。</p>

<p>原文来自Alex MacCaw <a href="http://alexmaccaw.co.uk/posts/traveling_writing_programming">Traveling Writing Programming</a><br/>
本译文出自外刊IT评论 <a href="http://www.aqee.net/traveling-writing-programming/">旅行，写作，编程</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[扯点Sublime]]></title>
    <link href="http://xguox.github.com/blog/2013/04/11/jabber-sublime/"/>
    <updated>2013-04-11T18:33:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/11/jabber-sublime</id>
    <content type="html"><![CDATA[<h2>Fxxk Jabber</h2>

<p>回想起初初接触编程语言的时候, 特喜欢折腾IDE的玩意, 什么visual studio啊, Eclipse啊, Netbeans, Aptana的会不会用好不好用都不管了, 装进PC再说, 怎么说, 很傻13的觉得我的PC里有这些工具我就牛13了, 熟不知真正的编程知识却木有学到, 后来搞Ruby开始放弃笨重的IDE改玩Vim和Sublime Text, 当时Textmate被捧上天不过木有Mac耍不起. <br/>
换了Mac了, Textmate2也开源了, 于是也装上耍了耍. 没多久又继续用Sublime Text了.  OOXX来来去去, 这两货其实真没差多少. 好吧, 是我用的都不够透彻. (T . T)</p>

<h2>Theme</h2>

<p>有时候蛋疼起来可以折腾某个主题某个配色好长的时间, 即使这对我的编程技能木有任何实质性提高.  强推一款theme - <a href="https://github.com/thinkpixellab/flatland">Flatland</a>,  随着Flat UI的兴起, ST的主题肿么能落后啊.  附带的icon更是比Sublime原本的霸气的不是一点两点啊. 貌似在哪见过, 想不起来了.
<img src="http://farm9.staticflickr.com/8392/8636887917_4db9f0f2b7_b.jpg" alt="" /></p>

<p>这UI还行吧? 我自己也懒得再去调了, 额外的把cursor换了个色就是了(原本的灰色真心不够骚啊, 老是眼瞎找不着)</p>

<!-- more -->


<p>说到theme就想起这个正在用着的<a href="https://github.com/aziz/knockdown">Knockdown</a> Package -Markdown文件专属的主题, 再配上Sublime Text的<strong>Enter Distraction Free Mode</strong> 用写静态Blog很带感叻, 对不对.  有时候, 巨爱这个模式. 舍不得Sublime的原因之一<br/>
<img src="http://farm9.staticflickr.com/8264/8638936015_31cde7d54f_b.jpg" alt="" /></p>

<p>之前也试用过<a href="https://github.com/ttscoff/MarkdownEditing">MarkdownEditing</a>, MarkdownEditing的高亮做的没Knockdown那么好(说实话, Knockdown的代码块的高亮配色不怎么符合我的style, 太过偏暗偏沉, 但总比木有高亮来得强), 挺喜欢ME的默认放在center这一点, 但是, 在<strong>Enter Distraction Free Mode</strong>下, 这个优点也就荡然无存了.</p>

<h2>Packages</h2>

<p>每个用Sublime新手老手都会介绍强推的<a href="http://wbond.net/sublime_packages/package_control/installation">Package Control</a> 插件管理就不再累赘啦.
Actually, 想装啥插件可以直接在里头搜, 或者网页版搜索, 一般都会给出相应的github开源链接. 装什么插件就更是因人而异的.  比如如果从来不写Markdown的那就木有必要装我上面说的那货.  又比如, 如果是重度Hacker News 用户的话, 直接搜hacker news(其实在&#8221;Install Package&#8221;上输入hack就已经跑出来一堆相关让你选择), 当然也不是啥都有的, 如果搜的是reddit就没看到结果了.</p>

<p>个人用的目前装着的packages有:</p>

<ul>
<li><a href="https://github.com/alienhard/SublimeAllAutocomplete">All Autocomplete</a> 这货是在已打开的文件的基础上拓展匹配的</li>
<li><a href="https://github.com/aziz/knockdown">knockdown</a></li>
<li><a href="https://github.com/nathos/sass-textmate-bundle">Sass</a> Sass的高亮, 补全&#8230;</li>
<li><a href="http://xavura.github.io/CoffeeScript-Sublime-Plugin/">CoffeeScript</a>  CoffeeScript高亮,补全, Compile等&#8230;</li>
<li><a href="https://github.com/dzhibas/SublimePrettyJson">Pretty JSON</a> 经常看到一些个JSON文件一坨坨的, 有了这货看着也舒服多了</li>
<li><a href="https://github.com/uipoet/sublime-jshint">JSHint</a> 检查Javascript的语法规范, 要先在装了node, 然后<code>npm install -g jshint</code></li>
<li><a href="http://emmet.io/">Emmet</a> 前身Zen Coding, 貌似所有的packages之中排在最前的. 几乎被吹捧成为神器中的神器了.</li>
<li><a href="">HTMLpretty</a> 个人觉得解决缩进等格式问题的神器, 好吧, 即使木有这个偶本身也是具有良好编码规范的.</li>
<li><a href="https://github.com/kemayo/sublime-text-2-git">Git</a></li>
<li><a href="https://github.com/sokolovstas/SublimeWebInspector">Web Inspector</a> 纯属贪新鲜装上耍耍, 取代浏览器的inspector不太可能.</li>
<li><a href="https://github.com/eddorre/SublimeERB">ERB Insert and Toggle Commands</a> 快速输入<code>&lt;%= %&gt;</code>或者<code>&lt;% %&gt;</code></li>
<li><a href="https://github.com/dotty/HackerNews-SublimeTextPlugin">Hacker News</a> 不常用, 而且要自己改改shortcut, 否则会占用了显隐侧边栏的快捷键.</li>
<li><a href="https://github.com/aziz/PlainTasks">PlainTasks</a> TODO插件一枚. 配合Sublime的各种快捷键各种操控很nice</li>
</ul>


<h2>Settings-User</h2>

<p>先把custom的show一下, 也没啥的, 都是些无关痛痒的修改. 个人爱好吧. 有个必须有的就是<code>"scroll_past_end": true,</code> 经常写了一大车页面布满了, 下面的就滚不起来, 眼睛老要往下瞄很不爽. 设置以后就可以自由控制底部显示.<br/>
基本上自己看着Settings - Default 还是老规矩按需修改啦.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;theme&quot;</span><span class="o">:</span> <span class="s2">&quot;Flatland.sublime-theme&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;color_scheme&quot;</span><span class="o">:</span> <span class="s2">&quot;Packages/Theme - Flatland/Flatland.tmtheme&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;tab_size&quot;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;font_options&quot;</span><span class="o">:</span>
</span><span class='line'>    <span class="p">[</span>
</span><span class='line'>        <span class="s2">&quot;bold&quot;</span>
</span><span class='line'>    <span class="p">],</span>
</span><span class='line'>    <span class="s2">&quot;font_face&quot;</span><span class="o">:</span> <span class="s2">&quot;Courier New&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;font_size&quot;</span><span class="o">:</span> <span class="mf">20.0</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;bold_folder_labels&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;hot_exit&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;open_files_in_new_window&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;create_window_at_startup&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;scroll_past_end&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;wide_caret&quot;</span><span class="o">:</span> <span class="kc">true</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Key Bindings - User</h2>

<p>快捷键同样跟Settings可以多看Default绝对比看路边3322的像我这些要靠谱, 完整的多. 忘了在哪学到的<code>{ "keys": ["ctrl+command+r"], "command": "reveal_in_side_bar" }</code> 挺实用的, 直接在侧边栏显示当前的文件所在的目录.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">[</span>
</span><span class='line'>  <span class="p">{</span> <span class="s2">&quot;keys&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;ctrl+command+r&quot;</span><span class="p">],</span> <span class="s2">&quot;command&quot;</span><span class="o">:</span> <span class="s2">&quot;reveal_in_side_bar&quot;</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="s2">&quot;keys&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;command+shift+.&quot;</span><span class="p">],</span> <span class="s2">&quot;command&quot;</span><span class="o">:</span> <span class="s2">&quot;erb&quot;</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="s2">&quot;keys&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;super+v&quot;</span><span class="p">],</span> <span class="s2">&quot;command&quot;</span><span class="o">:</span> <span class="s2">&quot;paste_and_indent&quot;</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="s2">&quot;keys&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;super+shift+v&quot;</span><span class="p">],</span> <span class="s2">&quot;command&quot;</span><span class="o">:</span> <span class="s2">&quot;paste&quot;</span> <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Shortcut</h2>

<p>列一些个老是忘记用快捷键的操作, (有时候又无故发现一些快捷键)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">focus</span><span class="err">到侧边栏</span><span class="o">:</span> <span class="s1">&#39;ctrl + 0&#39;</span>
</span><span class='line'><span class="nx">Command</span> <span class="o">+</span> <span class="nx">D</span><span class="err">：选择词。重复按下可以增加选择下一相同的词。按下</span> <span class="nx">Ctrl</span> <span class="o">+</span> <span class="nx">Command</span> <span class="o">+</span> <span class="nx">G</span> <span class="err">可选中所有相同的词。</span>
</span><span class='line'><span class="nx">Command</span> <span class="o">+</span> <span class="nx">Option</span> <span class="o">+</span> <span class="err">/：块注释。</span>
</span><span class='line'><span class="nx">Control</span> <span class="o">+</span> <span class="nx">M</span><span class="err">：跳转到对应的括号。</span>
</span><span class='line'><span class="nx">Control</span> <span class="o">+</span> <span class="nx">Shift</span> <span class="o">+</span> <span class="nx">M</span><span class="err">：选中当前括号内的内容，重复按下可增加选择括号本身。</span>
</span><span class='line'><span class="nx">Command</span> <span class="o">+</span> <span class="nx">Shift</span> <span class="o">+</span> <span class="nx">J</span><span class="err">：选中当前缩进级别下的所有代码。</span>
</span><span class='line'><span class="nx">Command</span> <span class="o">+</span> <span class="nx">Option</span> <span class="o">+</span> <span class="p">.</span><span class="err">：闭合</span> <span class="nx">HTML</span> <span class="err">标签。</span><span class="p">(</span><span class="err">说常用也不常用</span><span class="p">,</span> <span class="err">但又貌似有用</span><span class="p">)</span>
</span><span class='line'><span class="err">按住</span><span class="nx">option</span> <span class="err">拖拽多列</span>
</span><span class='line'><span class="err">按下</span> <span class="nx">Control</span> <span class="o">+</span> <span class="nx">Shift</span> <span class="o">+</span> <span class="err">方向键，可以选中矩形区域的文本。</span>
</span><span class='line'><span class="err">选择数行文本末端，选中区域然后按下</span> <span class="nx">Shift</span> <span class="o">+</span> <span class="nx">Command</span> <span class="o">+</span> <span class="nx">L</span><span class="err">。</span>
</span></code></pre></td></tr></table></div></figure>


<h2>PS:</h2>

<p>官方的symlink貌似有点不妥,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">ln</span> <span class="o">-</span><span class="nx">s</span> <span class="s2">&quot;/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl&quot;</span> <span class="o">~</span><span class="err">/bin/subl</span>
</span></code></pre></td></tr></table></div></figure>


<p>稍作修改为:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">ln</span> <span class="o">-</span><span class="nx">s</span> <span class="s2">&quot;/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl&quot;</span> <span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">local</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">subl</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Understanding Publications and Subscriptions]]></title>
    <link href="http://xguox.github.com/blog/2013/04/10/understanding-publications-and-subscriptions/"/>
    <updated>2013-04-10T14:22:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/10/understanding-publications-and-subscriptions</id>
    <content type="html"><![CDATA[<h5>LEVEL: INTERMEDIATE</h5>

<p>Publications &amp; subscriptions 是在Meteor里最基本也是最重要的概念之一, 但同时也是最难理解的. 很大程度上是由于这其中跟传统的构建web的方式有很大的不同.<br/>
过去, 我们习惯思考,定义API用在客户端和服务器之间进行数据传递, 而在Meteor中, 客户端和服务端的数据是同步的. 我们使用publications来精确地控制如何同步. <br/>
最初人们觉得这个概念有一些难以理解的部分原因是由于Meteor像&#8221;魔术&#8221;那样为我们做了这一切. 这些&#8221;魔术&#8221;都非常有用, 而具体发生了什么则都被掩盖封装起来了(就如魔术为何如此奇幻一样). 那么, 现在就让我们拨开这些魔术表层的面纱一探究竟. 在此, 我们将会学习到一到两个窍门.</p>

<h2>Defining Publications</h2>

<p>从本质上讲, <strong>publication</strong>(使用<strong>subscription</strong>与之相连)是从服务端(源)collection到客户端(目标)collection的传递数据方法. 同时, 把subscription想象成一个漏斗连接着标准的数据存储(与mongodb数据库交互的源集合)与客户端缓存(目标集合, 相应数据的备份或者子集).</p>

<p><strong>subscription</strong>精确地控制着哪些数据该通过这个漏斗, 同时负责同步两端的数据. 通过添加多个<strong>subscription</strong>到服务端数据存储, 我们就可以实时地, 有效地, 安全地保持各个客户端的数据同步.</p>

<!-- more -->


<p>这里头所用的隧道协议叫作 <strong>DDP</strong>(Distributed Data Protocol). 想要了解更多关于DDP可以观看Matt DeBergalis(Meteor的founder之一)在(<a href="http://2012.realtimeconf.com/video/matt-debergalis">The Realtime Conference</a>上的演讲. 又或者是 Chris Mather的<a href="http://www.eventedmind.com/posts/meteor-subscriptions-and-ddp">这个视频</a>更详细的为你介绍DDP的概念.</p>

<p>现在, 我们了解了基础部分, 让我们往更深层探个究竟吧.</p>

<h2>Autopublish</h2>

<p>当你创建了一个最基本的Meteor应用之后(比如使用 <code>meteor create</code>), 它会自动的启用 <strong>autopublish</strong>这个package. 首先的, 我们先来看看它究竟为干了些什么.</p>

<p><strong>autopublish</strong>是移除了对subscriptions的需要还是只为你保管subscriptions 这取决于你如何看待它. <strong>autopublish</strong>所做的是自动地把服务端的所有数据镜像到客户端.
<img src="http://www.themeteorbook.com/images/book/autopublish@2x.png" alt="" /></p>

<p>这是怎么做到的呢? 假设你在服务端有个<code>posts</code>的集合. 那么 <strong>autopublish</strong>会自动把在Mongo 的posts 集合所找到的每一个post发送到客户端给一个也同样叫posts 的集合.</p>

<p>所以, 如果你使用<code>autopublish</code>, 你就不用再去管subscriptions了. 数据在哪都可以访问, 所有事情变得各种简单. 当然, 很明显这是有问题的, 你不可能在每一个用户的机器上都缓存有你的整个app的数据库备份.</p>

<p>出于这个原因, <strong>autopublish</strong>只适合用在你的app刚起步还没考虑到subscriptions的时候.</p>

<h2>Publishing Full Collections</h2>

<p>当你移除掉autopublish以后, 很快你就会发现你的数据都会在客户端消失不见. 有一种方法可以很简单地取回这些数据, 那就是简单的复刻<code>autopublish</code>, 并把一个collection全部publish. 例如:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;allPosts&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://www.themeteorbook.com/images/book/fullcollection@2x.png" alt="" /></p>

<p>同样地, 我们也还是把整个collection都publish了, 所不同的是, 现在对哪个collection进行publish是可控的. 在上边这个例子, 我们publish了<code>posts</code> collection, 而<code>comments</code> collection没有被publish.</p>

<h2>Publishing Partial Collections</h2>

<p>更高一级的粒度控制是只publish某个collection的一部分. 比如, 只作用于属于某个author的posts:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;somePosts&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s1">&#39;author&#39;</span><span class="o">:</span><span class="s1">&#39;Tom&#39;</span><span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://www.themeteorbook.com/images/book/partialcollection@2x.png" alt="" /></p>

<p>代码都很简单, 但是究竟在底层发生了些什么呢?</p>

<p>如果你有读过<a href="http://docs.meteor.com/#publishandsubscribe">Meteor的文档</a>, 可能会对<code>added()</code>和<code>ready()</code>在客户端设置记录的属性感到惊讶,  and struggled to square that with the Meteor apps that you&#8217;ve seen that never use those methods.(I am so sorry 这句没想着怎么翻译好)</p>

<p>这其中的原因是, Meteor提供了一个非常重要的便利 - <code>_publishCursor()</code>方法. 可能你从没见过它的使用? 因为有可能不是直接的调用，但如果你在调用一个publish函数并返回一个<strong>游标(cursor)</strong>(例如: <code>Posts.find({'author':'Tom'})</code>), 那么这就是<code>_publishCursor</code>.</p>

<p>当Meteor看到<code>somePosts</code>这个publication返回来一个游标(cursor), 则表明它自动调用了<code>_publishCursor()</code>publish这个cursor. 下面这是<code>_publishCursor()</code>所做的事情:</p>

<ul>
<li>在服务端查找这个名字的collection</li>
<li>从cursor中取得所有匹配的documents并发送到客户端的同名集合(在这用到的是<code>added()</code>)</li>
<li>只要某个document被增删改, 都会被同步到客户端(在cursor上使用<code>.observe()</code>, 并使用<code>.added()</code> <code>.updated()</code> <code>.removed()</code>来完成)</li>
</ul>


<p>那么,在上边的例子, 我们就可以很简便地确保只有用户感兴趣的posts(written by Tom)会出现在他们的客户端缓存之中.</p>

<h2>Publishing Partial Properties</h2>

<p>在上边我们已经看到了如何publish我们的一部分posts, 但是我们还可以做的更精确一些. 下面看看如何publish特定的记录吧. <br/>
<img src="http://www.themeteorbook.com/images/book/partialproperties@2x.png" alt="" /></p>

<p>跟前边的一样, 我们先用<code>find()</code>得到一个cursor, 不过这一次我们会排除掉一些</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;allPosts&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span><span class="nx">fields</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">author</span><span class="o">:</span> <span class="kc">false</span>
</span><span class='line'>  <span class="p">}});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>当然的, 我们还能够结合这两种技巧. 比如我们想要返回所有来自Tom的posts同时, 可以这么写</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;allPosts&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s1">&#39;author&#39;</span><span class="o">:</span><span class="s1">&#39;Tom&#39;</span><span class="p">},</span> <span class="p">{</span><span class="nx">fields</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">author</span><span class="o">:</span> <span class="kc">false</span>
</span><span class='line'>  <span class="p">}});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>总结</h2>

<p>现在, 我们已经知道了如何publish从所有collections的所有documents的所有属性(通过<code>autopublish</code>)到特定collections的特定documents的特定记录.</p>

<p>这包括了你能用Meteor的subscription所能做的所有基本东西, 而这些简单的技巧应该</p>

<p>有时候, 你可能会需要更深层的组合, 联接, 合并 publication, 而这些我们将会再找个时间详谈.</p>

<p>原文来自Tom Coleman <a href="http://www.themeteorbook.com/2013/04/05/publications-and-subscriptions/">Understanding Publications and Subscriptions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[继续折腾 -- Hexo版Blog]]></title>
    <link href="http://xguox.github.com/blog/2013/04/08/hexo-blog-node-octopress/"/>
    <updated>2013-04-08T22:51:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/08/hexo-blog-node-octopress</id>
    <content type="html"><![CDATA[<p>早之前就听说了<a href="http://zespia.tw/hexo/">Hexo</a>,  也就是Octopress的node.js版本, 不过是源自台湾.  setup的话其实中文英文都无妨吧.  尽管阅读起来肯定是较之中文困难, 不过也基本习惯了.</p>

<p>基本上按照官方给出的guide很容易搭建好. 不过还是不准备现在就撤出Octopress奔赴Hexo, 尽管基于node.js的Hexo在generate, deploy的时候有一定的执行速度优势, 不过目前post不太多, so有感觉出差距, 但不大.</p>

<p>因为不熟node, 还是遇上了麻烦, root下的db.json就不太明白. 导致在修改tags的时候死活修改不了, 查了一下github上以前的issue才知道得把db.json这货rm掉.  否则不管怎么generate, 怎么deploy都只会有增无减.</p>

<p>另一个跟Octopress比较不同的是Markdown的解析器. Octopress用的是Liquid, 而Hexo用的是Marked. 大部分情况下都没什么差别. 而之所以发现这个不同是因为刚开始的generate的时候不断报错</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>undefined:11
</span><span class='line'>if ((typeof _context !== "undefined" && typeof _context.&gt; posts !== "undefined
</span><span class='line'>                                                        ^
</span><span class='line'>SyntaxError: Unexpected token &gt;
</span><span class='line'>    at Object.Function (unknown source)
</span><span class='line'>    at createRenderFunc (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/swig/lib/swig.js:44:10)
</span><span class='line'>    at createTemplate (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/swig/lib/swig.js:96:14)
</span><span class='line'>    at getTemplate (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/swig/lib/swig.js:124:20)
</span><span class='line'>    at Object.exports.compile (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/swig/lib/swig.js:186:14)
</span><span class='line'>    at file.read.async.waterfall.compiled.replace.options.gutter (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/lib/plugins/processor/index.js:128:27)
</span><span class='line'>    at async.iterator.fn (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/async/lib/async.js:573:34)
</span><span class='line'>    at async.waterfall.wrapIterator (/usr/local/Cellar/node/0.8.20/lib/node_modules/hexo/node_modules/async/lib/async.js:489:34)
</span><span class='line'>    at process.startup.processNextTick.process._tickCallback (node.js:244:9)</span></code></pre></td></tr></table></div></figure>


<p>用尽各种蛋疼的办法才发现原来是有一篇文章里头的一段underscore代码块解析出了问题</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  
</span><span class='line'>{{ &gt; posts}}
</span><span class='line'> </span></code></pre></td></tr></table></div></figure>


<p>
吐血啊, 找了我老久.  原来是这个东西忘了套上 &#8220;{ % raw % }&#8221; &#8220;{ % endraw % }&#8221;<br/>
在Octopress(Liquid)里没套上的话则直接无视掉, 而Hexo(Marked)则直接嘣掉.</p>

<p>现阶段的plugins自然还是跟Octopress有些差距的,  不过挺看好的. 虽然暂时不撤往Hexo. 但还是弄了个<a href="http://xguoxlu.github.io/">github pages</a>, 喜欢折腾吧&#8230;</p>

<p>另外也顺带把404页面改成扣扣的公益页面了. 尽管知道不太可能起到什么作用&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[最近在折腾 -- deploy Meteor on heroku]]></title>
    <link href="http://xguox.github.com/blog/2013/04/06/deploy-meteor-on-heroku/"/>
    <updated>2013-04-06T23:42:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/04/06/deploy-meteor-on-heroku</id>
    <content type="html"><![CDATA[<p>貌似有好一段时间没有在这儿小发一些闷骚或者情感泛滥什么的, 都是用自己蹩脚的英语水平翻译些英文post. 这些天想部署个Meteor app玩一玩, 结果一玩就各种出事了.</p>

<p>vps退货, godaddy的莫名失单, 部署各种卡壳&#8230;</p>

<p>因为最近比较多的关注前端的东西,  同时在自己local耍着<a href="https://github.com/SachaG/Telescope">SachaG / Telescope</a>这个基于Meteor的项目. 于是也就顺手搭了<a href="http://frontn.com">FrontN</a>这么个类似HN, Reddit的玩意. 原本是准备直接把HN,Reddit clone 成中文版的, 不过<a href="http://news.dbanotes.net/">Fenng</a>貌似已经这么干了, 所以, 我也就不再造这个轮子了.另外原本也想专门作为<a href="http://jianshu.io">简书</a>的评论系统. 不过想想也不是很妥, 就&#8230;</p>

<p>Meteor的系统是超级alpha的, 所以很多问题遇上了也没人帮忙, 解决. 比如之前在<a href="http://stackoverflow.com/questions/15654637/same-helper-for-different-template">Stack Overflow</a>. 而部署这一块, 是我比较陌生的. 包括以前搞rails那会, 也没真正意义的整一整部署. 绝大部分时间都在本地跑啊跑. 所以, 在Meteor, 也是这一块最让我头疼.</p>

<!--more -->


<p>从vps到appfog到heroku, 各种转了一圈, 最终还是选定了heroku.  原因之一就是资料相对多, 出错情况也较少.</p>

<p>秉承流水帐作风, 待我慢慢道来.</p>

<p>幸得以前一直搞得是ruby/rails. 所以装heroku的时候没啥压力, 不然可能这又得搞上一会. 直接下载了官方的<a href="https://toolbelt.heroku.com/">heroku toolbelt</a>无压力安装, login, clone&#8230;</p>

<p>and then 跟着 <a href="https://github.com/oortcloud/heroku-buildpack-Meteorite">Heroku buildpack for Meteorite</a> 这个buildpack完成接下来的:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku create --stack cedar --buildpack https://github.com/oortcloud/heroku-buildpack-Meteorite.git</span></code></pre></td></tr></table></div></figure>


<p><strong>Please note: 在这如果你想把你的项目名改成想要的比如我改成了<a href="frontn.herokuapp.com">frontn.herokuapp.com</a>, 在heroku的项目页面上修改名字的同时, 记得把repo的git remote 也相应的更改</strong></p>

<p>否则就会报错</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku !  Resource not found</span></code></pre></td></tr></table></div></figure>


<p>好吧, 很明显我自己傻13了才会知道要这么做的.</p>

<p>接着到了最关键的push了.  当我<code>git push heroku master</code>的时候, bla,blah blah&#8230;下来还以为这次会真的很顺畅. 结果oops的一嘣</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">...</span>
</span><span class='line'><span class="p">...</span>
</span><span class='line'><span class="o">-----&gt;</span> <span class="nx">Launching</span><span class="p">...</span> <span class="o">!</span>     <span class="nx">Heroku</span> <span class="nx">push</span> <span class="nx">rejected</span><span class="p">,</span> <span class="nx">Please</span> <span class="nx">verify</span> <span class="nx">your</span> <span class="nx">account</span> <span class="nx">to</span> <span class="nx">install</span> <span class="k">this</span> <span class="nx">add</span><span class="o">-</span><span class="nx">on</span>
</span><span class='line'><span class="nx">For</span> <span class="nx">more</span> <span class="nx">information</span><span class="p">,</span> <span class="nx">see</span> <span class="nx">http</span><span class="o">:</span><span class="c1">//devcenter.heroku.com/categories/billing</span>
</span><span class='line'><span class="nx">Verify</span> <span class="nx">now</span> <span class="nx">at</span> <span class="nx">https</span><span class="o">:</span><span class="c1">//heroku.com/verify</span>
</span></code></pre></td></tr></table></div></figure>


<p>纳尼,  原来这货还要用到一个mongo的数据库插件, 在这里是Mongohq, 原本没注意看以为直接
<code>heroku addons:add mongohq:sandbox</code>就OK
(sandbox是免费餐)</p>

<p>结果毫无疑问的继续嘣&#8230;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Adding</span> <span class="nx">mongohq</span><span class="o">:</span><span class="nx">sandbox</span> <span class="nx">on</span> <span class="nx">frontn</span><span class="p">...</span> <span class="nx">failed</span>
</span><span class='line'> <span class="o">!</span>    <span class="nx">Please</span> <span class="nx">verify</span> <span class="nx">your</span> <span class="nx">account</span> <span class="nx">to</span> <span class="nx">install</span> <span class="k">this</span> <span class="nx">add</span><span class="o">-</span><span class="nx">on</span>
</span><span class='line'> <span class="o">!</span>    <span class="nx">For</span> <span class="nx">more</span> <span class="nx">information</span><span class="p">,</span> <span class="nx">see</span> <span class="nx">http</span><span class="o">:</span><span class="c1">//devcenter.heroku.com/categories/billing</span>
</span><span class='line'> <span class="o">!</span>    <span class="nx">Verify</span> <span class="nx">now</span> <span class="nx">at</span> <span class="nx">https</span><span class="o">:</span><span class="c1">//heroku.com/verify</span>
</span></code></pre></td></tr></table></div></figure>


<p>Google之才知道原来Heroku在装插件前得通过传说中的credit card卡认证, 我辣时就更嘣了. 对于我等无产阶级而言, credit card仿佛就跟神一般滴遥不可及. 你想买3刀的godaddy域名?不好意思, 请出示credit card; 你想用name.com买域名? 不好意思, 请出示credit card; 你想买linode的vps?有credit card吗? 亲&#8230;正当我开始准备放弃heroku这条路时, 忽然无意中发现了虚拟信用卡这货, 顺藤摸瓜发现, 柳暗花明又一村.</p>

<p><strong>工行国际e卡 + entropay</strong>(怎么觉得我像在拍广告的)</p>

<p>虽然门路是找着了, 不过弄得我好不蛋疼.<br/>
因为mac上工行网银不支持插U盾, 于是又启动了以前的那台老爷机, 一卡一顿的, 唉, 为了搞到手就忍忍吧&#8230;结果成功申请后唬弄半晌才知道原来要先用软妹b买美刀才能花, 而且至少买50刀. 我现在要50刀搞毛线撒&#8230;没法子, 只得照办了. 然后是entropay的虚拟卡>>><br/>
OOXX一轮下来总算是把heroku的验证给通过了, 感动啊&#8230;</p>

<p><code>heroku addons:add mongohq:sandbox</code></p>

<p><code>git push heroku master</code></p>

<p>好吧, 总算是成功了. 我容易吗&#8230;</p>

<p>最后总结, heroku相对的来说除了出错情况较少, 可用资料多之外, 管理上也比自己搭vps要方便些, feel了一下MongoHQ的那个插件还不错&#8230;这样, 也就可以花更多的时间的app的开发上. 而不是折腾这出错那无解.  好吧, 尽管咱都爱折腾, 不过, 往你想的地方折腾不更好吗? 其实这些也就都是Paas的优势啦, 专注核心开发, 减少运维成本&#8230;</p>

<p>其他的待续吧, 相比rails, 或许底层它怎么干还没搞透, 但起码的知道它干了什么, 可Meteor我还真不知道它都干了些什么, 比rails更magic.</p>

<p>不管是否热爱前端的亲, 欢迎做客<a href="http://frontn.com">FrontN</a>. 有Bug那是必然的啦, 欢迎Feedback.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[5 Use Cases for Icon Fonts]]></title>
    <link href="http://xguox.github.com/blog/2013/03/25/5-use-cases-for-icon-fonts/"/>
    <updated>2013-03-25T15:48:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/25/5-use-cases-for-icon-fonts</id>
    <content type="html"><![CDATA[<p>Icon fonts非常的强大:</p>

<ul>
<li>You can CSS the crap out of them and they don’t mind.</li>
<li>在任何的显示器和分辨率上看起来都很不错</li>
<li>无论多大的icons集都只需要一次HTTP请求</li>
</ul>


<p>下面来看看5个典型的icon fonts用例.</p>

<h2>在开始之前</h2>

<p>为了让代码保持整洁和高可读性, 我们将不会用到浏览器前缀. 我们会用到的东西诸如animations, transitions, and transforms, 所有的这些为了确保更好的浏览器支持一般都需要添加hack前缀. 在这里你想如何处理浏览器前缀问题<a href="http://css-tricks.com/how-to-deal-with-vendor-prefixes/">由你自己决定</a>.</p>

<!-- more -->


<p>正如你在例子中可以看到的, 我使用的是icon fonts托管服务<a href="http://weloveiconfonts.com/">weloveiconfonts.com</a>. 这是一个我自己的项目&#8211;原本想写一篇文章关于icon-fonts, 搜索发现没有免费的icon fonts托管服务, 于是就新建了这么个项目来完成这篇文章.</p>

<h2>1. CSS Loader</h2>

<p>现今有许多<a href="http://codepen.io/stuffit/pen/vlfyA">很棒的</a>, <a href="http://codepen.io/FWeinb/pen/BeJLo">纯</a>CSS Loader, 你也可以在<a href="http://cssload.net/">cssload.net</a>上创建你自己的Loader. 而除此之外我们还可以使用<a href="http://css-tricks.com/flat-icons-icon-fonts/">icon fonts</a>来完成. 你可以使用一个看起来像Loading的符号,然后用CSS让其<a href="http://docs.webplatform.org/wiki/css/properties/animation/animation">动起来</a>.</p>

<p>以下这是基本的HTML. 开始是三个loader, 他们都是<code>div.wrapper</code>的子元素. 第四个(<code>div.complex</code>)是由两个icons组成.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-spin1&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-spin3&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-spin5&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;complex&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-emo-devil&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-spin4&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>导入icon font <a href="https://github.com/fontello/fontelico.font">Fontelico</a>到你的CSS之中.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">fontelico</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;fontelico-&quot;</span><span class="o">]</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;fontelico&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>给元素添加名为<code>load</code>的动画, 使得这些元素360度旋转, 可适当做一些调整或者更改颜色.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="c">/* Normal (left) */</span>
</span><span class='line'><span class="nt">span</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
</span><span class='line'>  <span class="k">text-align</span><span class="o">:</span> <span class="k">center</span><span class="p">;</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">5em</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">load</span> <span class="m">1.337s</span> <span class="n">infinite</span> <span class="n">ease</span><span class="o">-</span><span class="n">out</span> <span class="n">reverse</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c">/* Fast (center) */</span>
</span><span class='line'><span class="nc">.wrapper</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">2</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">load</span> <span class="m">.5s</span> <span class="n">infinite</span> <span class="n">linear</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c">/* Steps (right) */</span>
</span><span class='line'><span class="nc">.wrapper</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">3</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">load</span> <span class="m">1.25s</span> <span class="n">infinite</span> <span class="n">steps</span><span class="p">(</span><span class="m">18</span><span class="o">,</span> <span class="n">end</span><span class="p">)</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">load</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>    <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">10</span><span class="o">%</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">20</span><span class="o">%</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">30</span><span class="o">%</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">120</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">40</span><span class="o">%</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">50</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">180</span><span class="n">deg</span><span class="p">)</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>    <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">120</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">360</span><span class="n">deg</span><span class="p">)</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>    <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>将最后的那个loader(<code>div.complex</code>) 的两个icons堆叠在最上层. 第一个子元素为devil形状的icon(用的是名为<code>rotate</code>的动画), 第二个子元素为spin icon(使用名为<code>scale</code>的动画).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.complex</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">1</span><span class="o">),</span>
</span><span class='line'><span class="nc">.complex</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">2</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c">/* Devil icon  */</span>
</span><span class='line'><span class="nc">.complex</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">1</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">load</span> <span class="m">1.25s</span> <span class="n">infinite</span> <span class="n">steps</span><span class="p">(</span><span class="m">18</span><span class="o">,</span> <span class="n">end</span><span class="p">)</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c">/* Spin icon */</span>
</span><span class='line'><span class="nc">.complex</span> <span class="nt">span</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">2</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">3em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">left</span><span class="o">:</span> <span class="m">-.35em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">top</span><span class="o">:</span> <span class="m">-.35em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">3</span><span class="p">);</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">devil</span> <span class="m">3s</span> <span class="n">infinite</span> <span class="n">linear</span> <span class="n">reverse</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">devil</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">-1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">50</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">-1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">-1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="FCsHe" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<h2>SocialCount meets Style</h2>

<p>人们都喜欢在他们的网站上使用一些社交分享按钮, 从而使得访问者可以轻易的传播他们的内容. 但是当你如果添加Facebook, Twitter, Google+, 那么你将要面临的是大约309KB的空缓存负载量. 这就是<a href="https://github.com/filamentgroup/SocialCount">SocialCount jQuery plugin</a>所存在的原因. SocialCount是渐进增强的, 并且可以lazy loaded以及对移动设备比较友好.</p>

<p>它的默认样式很简单且在iframe中包含的buttons也很少. 下面, 让我们为这些buttons添加一些CSS花样.</p>

<p>以下的HTML是由<a href="SocialCount%20markup%20generator">SocialCount markup generator</a>所创建. 其实也就是一些包含着链接和icons的无序列表.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;ul</span>
</span><span class='line'>  <span class="na">class=</span><span class="s">&quot;socialcount&quot;</span>
</span><span class='line'>  <span class="na">data-url=</span><span class="s">&quot;http://www.google.com/&quot;</span>
</span><span class='line'>  <span class="na">data-counts=</span><span class="s">&quot;true&quot;</span>
</span><span class='line'>  <span class="na">data-share-text=</span><span class="s">&quot;Google is a search engine&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;facebook&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://www.facebook.com/sharer/sharer.php?u=http://www.google.com/&quot;</span> <span class="na">title=</span><span class="s">&quot;Share on Facebook&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;count entypo-thumbs-up&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/a&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;twitter&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://twitter.com/intent/tweet?text=http://www.google.com/&quot;</span> <span class="na">title=</span><span class="s">&quot;Share on Twitter&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;count entypo-twitter&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/a&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;googleplus&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://plus.google.com/share?url=http://www.google.com/&quot;</span> <span class="na">title=</span><span class="s">&quot;Share on Google Plus&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;count entypo-gplus&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/a&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>接着在CSS中导入icon font(Entypo)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">entypo</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;entypo-&quot;</span><span class="o">]</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font</span><span class="o">:</span> <span class="m">2.5em</span><span class="o">/</span><span class="m">1.9em</span> <span class="s1">&#39;entypo&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>然后是重写SocialCount提供的默认样式:</p>

<ul>
<li>加入transition</li>
<li>缩放iframe</li>
<li>给buttons设定自定义的背景</li>
</ul>


<blockquote><p>Editor&#8217;s note: 以下的CSS所使用的是SASS的一种格式SCSS.  包括后边的也是. 如果你想要使用标准的CSS, 可以跳转到下边的CodePen 演示链接,  在CSS编辑框头部点击&#8221;SCSS&#8221;, 然后就可以看到经过编译后的标准CSS</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='sass'><span class='line'><span class="nc">.socialcount</span> <span class="err">{</span>
</span><span class='line'>  <span class="o">&gt;</span> <span class="nt">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">width</span><span class="o">:</span> <span class="mi">33</span><span class="kt">%</span><span class="err">;</span>
</span><span class='line'>    <span class="na">border-radius</span><span class="o">:</span> <span class="mi">0</span><span class="err">;</span>
</span><span class='line'>    <span class="na">transition</span><span class="o">:</span> <span class="n">all</span> <span class="mf">.3</span><span class="kt">s</span> <span class="n">ease-in-out</span><span class="err">;</span>
</span><span class='line'>    <span class="na">cursor</span><span class="o">:</span> <span class="no">pointer</span><span class="err">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="na">&amp;</span><span class="o">:</span><span class="n">hover</span> <span class="p">[</span><span class="n">class</span><span class="o">*=</span><span class="s2">&quot;entypo-&quot;</span><span class="p">]</span><span class="o">:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="na">opacity</span><span class="o">:</span> <span class="mi">0</span><span class="err">;</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">iframe</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">transform</span><span class="o">:</span> <span class="nf">scale</span><span class="p">(</span><span class="mi">1</span><span class="mf">.65</span><span class="o">,</span> <span class="mi">1</span><span class="mf">.65</span><span class="p">)</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.button</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">top</span><span class="o">:</span> <span class="mi">50</span><span class="kt">%</span><span class="err">;</span>
</span><span class='line'>    <span class="na">margin</span><span class="o">:</span> <span class="mf">-.75</span><span class="kt">em</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="err">;</span>
</span><span class='line'>    <span class="na">height</span><span class="o">:</span> <span class="mi">2</span><span class="kt">em</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.facebook</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">background</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">59</span><span class="o">,</span> <span class="mi">89</span><span class="o">,</span> <span class="mi">152</span><span class="o">,</span> <span class="mf">.7</span><span class="p">)</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">&amp;</span><span class="nc">.like</span> <span class="nc">.facebook</span> <span class="nt">iframe</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">width</span><span class="o">:</span> <span class="mi">8</span><span class="kt">em</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.twitter</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">background</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">172</span><span class="o">,</span> <span class="mi">237</span><span class="o">,</span> <span class="mf">.7</span><span class="p">)</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.googleplus</span> <span class="err">{</span>
</span><span class='line'>    <span class="na">background</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">172</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mf">.7</span><span class="p">)</span><span class="err">;</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="Czfyu" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<h2>3.Enhanced lists</h2>

<p>下边的三个例子都基于下边这个简单的HTML</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h2&gt;</span>Title<span class="nt">&lt;/h2&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li</span> <span class="na">data-text=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Text<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li</span> <span class="na">data-text=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Text<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li</span> <span class="na">data-text=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Text<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>导入 icon font (Font Awesome)到你的CSS</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">fontawesome</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;fontawesome-&quot;</span><span class="o">]</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;FontAwesome&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>为列表, 列表元素, <a href="http://css-tricks.com/almanac/selectors/a/after/">伪元素</a>以及button添加默认样式. 在这里我们不使用class来设定列表元素下的icon的样式, 取而代之是我们改变元素的<code>content</code>属性来创建一个伪元素.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nt">ul</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">list-style</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
</span><span class='line'>  <span class="k">padding</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="k">position</span><span class="o">:</span> <span class="k">relative</span><span class="p">;</span>
</span><span class='line'>    <span class="k">min-height</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>    <span class="k">padding</span><span class="o">:</span> <span class="m">.3em</span> <span class="m">.3em</span> <span class="m">.3em</span> <span class="m">1.5em</span><span class="p">;</span>
</span><span class='line'>    <span class="n">transition</span><span class="o">:</span>
</span><span class='line'>      <span class="k">background</span> <span class="m">.3s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span><span class="o">,</span>
</span><span class='line'>      <span class="k">color</span> <span class="m">.3s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span><span class="o">,</span>
</span><span class='line'>      <span class="n">box</span><span class="o">-</span><span class="n">shadow</span> <span class="m">.1s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span><span class="o">,</span>
</span><span class='line'>      <span class="k">height</span> <span class="m">.25s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span>
</span><span class='line'>   <span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">button</span> <span class="err">{</span>
</span><span class='line'>      <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>      <span class="k">left</span><span class="o">:</span> <span class="m">1.45em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">bottom</span><span class="o">:</span> <span class="m">.35em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">opacity</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">height</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">border</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
</span><span class='line'>      <span class="k">font-size</span><span class="o">:</span> <span class="m">.8em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
</span><span class='line'>      <span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">.4s</span> <span class="n">ease</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">out</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>      <span class="k">top</span><span class="o">:</span> <span class="m">.425em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;FontAwesome&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'>      <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">.35em</span> <span class="m">0</span> <span class="m">-1.35em</span><span class="p">;</span>
</span><span class='line'>      <span class="k">vertical-align</span><span class="o">:</span> <span class="k">bottom</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">button</span> <span class="err">{</span>
</span><span class='line'>        <span class="k">opacity</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>        <span class="k">height</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>        <span class="k">right</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>        <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">2</span><span class="o">.</span><span class="m">5</span><span class="o">,</span> <span class="m">2</span><span class="o">.</span><span class="m">5</span><span class="p">)</span> <span class="n">translate</span><span class="p">(</span><span class="m">-.25em</span><span class="o">,</span> <span class="m">.15em</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="o">&amp;</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>        <span class="k">content</span><span class="o">:</span> <span class="n">attr</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="k">text</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3.1 Stuff You Love</h3>

<p>第一个示例很简单. 使用的是一个心形而不是默认的列表样式加特定的hover: icon会被移到右侧, 另外<code>::after</code>伪元素得到data-text这个<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedding-custom-non-visible-data-with-the-data-*-attributes">data-attribute</a>的文本</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.love</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-heart */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f004&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:before</span><span class="o">,</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">20</span><span class="o">,</span> <span class="m">20</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">background</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">20</span><span class="o">,</span> <span class="m">20</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">after</span> <span class="err">{</span>
</span><span class='line'>        <span class="k">width</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>        <span class="k">right</span><span class="o">:</span> <span class="m">.445em</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3.2 Downloads</h3>

<p>这是一个自定义列表下载扩展标记: 每个列表元素有一个链接和一个icon. 按钮被隐藏了, 只有当hover的时候才显示.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.downloads</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="k">border-bottom</span><span class="o">:</span> <span class="m">.15em</span> <span class="k">solid</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">3</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-download-alt */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f019&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">50</span><span class="o">,</span> <span class="m">50</span><span class="o">,</span> <span class="m">50</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">background</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">140</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">7</span><span class="p">);</span>
</span><span class='line'>      <span class="k">height</span><span class="o">:</span> <span class="m">4em</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">after</span> <span class="err">{</span>
</span><span class='line'>        <span class="k">right</span><span class="o">:</span> <span class="m">.35em</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">2</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3.3 Your account</h3>

<p>用户菜单的UI. 当你hover在一个列表元素上的时候, icon移动到右侧并且box-shadow填满整个背景. 基于<code>:nth-child</code>选择器和<code>content</code>属性, 每个列表元素都有一个自己的icon.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.account</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">padding</span><span class="o">:</span> <span class="m">.75em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">border</span><span class="o">:</span> <span class="m">.15em</span> <span class="k">solid</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">2</span><span class="p">);</span>
</span><span class='line'>  <span class="k">background-color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">7</span><span class="p">);</span>
</span><span class='line'>  <span class="k">background-image</span><span class="o">:</span> <span class="n">radial</span><span class="o">-</span><span class="n">gradient</span><span class="p">(</span><span class="k">center</span><span class="o">,</span> <span class="n">ellipse</span> <span class="n">cover</span><span class="o">,</span> <span class="n">rgba</span><span class="p">(</span><span class="m">104</span><span class="o">,</span><span class="m">104</span><span class="o">,</span><span class="m">104</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">6</span><span class="p">)</span> <span class="m">0</span><span class="o">%,</span><span class="n">rgba</span><span class="p">(</span><span class="m">23</span><span class="o">,</span><span class="m">23</span><span class="o">,</span><span class="m">23</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">7</span><span class="p">)</span> <span class="m">100</span><span class="o">%</span><span class="p">);</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="k">inset</span> <span class="m">0</span> <span class="m">0</span> <span class="m">.35em</span> <span class="m">0</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">2</span><span class="p">);</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>  <span class="n">backface</span><span class="o">-</span><span class="k">visibility</span><span class="o">:</span> <span class="k">hidden</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">li</span> <span class="err">{</span>
</span><span class='line'>    <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&amp;:</span><span class="n">nth</span><span class="o">-</span><span class="n">child</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-heart-empty */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f08a&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">2</span><span class="o">)</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-glass */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f000&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">3</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">margin-bottom</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-comment */</span>
</span><span class='line'>        <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f075&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">4</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">margin-bottom</span><span class="o">:</span> <span class="m">.5em</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-cog */</span>
</span><span class='line'>         <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f013&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">5</span><span class="o">)</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>      <span class="c">/* fontawesome-signout */</span>
</span><span class='line'>      <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;\f08b&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>      <span class="k">padding-left</span><span class="o">:</span> <span class="m">1.5em</span><span class="p">;</span>
</span><span class='line'>      <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="k">inset</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">10em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&amp;:</span><span class="n">before</span> <span class="err">{</span>
</span><span class='line'>        <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>        <span class="n">transform</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="err">}</span>
</span><span class='line'>  <span class="err">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="tcklJ" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<h2>4. Emocons.js jQuery Plugin</h2>

<p><a href="https://github.com/TimPietrusky/emocons">Emojons.js</a>是一个搜索元素里特定字符序列内容的jQuery插件. 所有匹配上的都会用一个<code>span</code>和相应的icon HTML class来替换.<br/>
例如, 一个聊天app:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;chat&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    :D :) ;) :&#39;( :o :/ :( B) :P :|
</span><span class='line'>    :beer: :devil: :shoot: :coffee: :thumbsup: :angry: :ueber-happy:
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>接着在你的元素上调用 Emocons.js 插件的方法</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.chat&#39;</span><span class="p">).</span><span class="nx">emocons</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>现在, 所有在聊天时候的元素都会被转换成这样:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;fontelico-emo-grin go&quot;</span> <span class="na">title=</span><span class="s">&quot;:D&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在CSS中导入icon font(Fontelico):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">fontelico</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;fontelico-&quot;</span><span class="o">]</span><span class="nd">:before</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;fontelico&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>当 Emocons.js 把一个字符串转换成表情符号时, 会给<code>span</code>元素增加一个<code>go</code>类(添加一个动画效果).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.go</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">hey</span> <span class="m">.55s</span> <span class="m">1</span> <span class="n">linear</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">hey</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">50</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">.</span><span class="m">85</span><span class="o">,</span> <span class="m">-1</span><span class="o">.</span><span class="m">85</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">transform</span><span class="o">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>一些表情符号会有特殊的样式(如颜色的改变)或者通过<code>::after</code>伪元素添加一些东西</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.fontelico-emo-devil</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span><span class="n">rgba</span><span class="p">(</span><span class="m">180</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">9</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.fontelico-emo-beer</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span>
</span><span class='line'>    <span class="m">-.475em</span> <span class="m">.75em</span> <span class="m">0</span> <span class="m">.275em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">220</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">1</span><span class="p">)</span><span class="o">,</span>
</span><span class='line'>    <span class="m">-.185em</span> <span class="m">.675em</span> <span class="m">0</span> <span class="m">.175em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">220</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">1</span><span class="p">)</span>
</span><span class='line'>  <span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.fontelico-emo-coffee</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span>
</span><span class='line'>    <span class="m">-.475em</span> <span class="m">.78em</span> <span class="m">0</span> <span class="m">.235em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">222</span><span class="o">,</span> <span class="m">184</span><span class="o">,</span> <span class="m">135</span><span class="o">,</span> <span class="m">1</span><span class="p">)</span><span class="o">,</span>
</span><span class='line'>    <span class="m">-.215em</span> <span class="m">.715em</span> <span class="m">0</span> <span class="m">.155em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">222</span><span class="o">,</span> <span class="m">184</span><span class="o">,</span> <span class="m">135</span><span class="o">,</span> <span class="m">1</span><span class="p">)</span>
</span><span class='line'>  <span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.fontelico-emo-shoot</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">.15em</span><span class="p">;</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="m">.315em</span> <span class="m">.525em</span> <span class="m">0</span> <span class="m">.1em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.fontelico-emo-angry</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">.15em</span><span class="p">;</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="m">-.695em</span> <span class="m">.455em</span> <span class="m">0</span> <span class="m">.085em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">220</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="KloGD" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<h2>5. Parallax Movie #1337</h2>

<p>最后的这个例子只是为了好玩吧. 它只是一个试验, 使用一个icon font来创建一个无穷的parallax movie. 创建场景的HTML包含有许多的元素.</p>

<ul>
<li>The setting: sky, ground, night and sun</li>
<li>Fixed element: bicycle</li>
<li>Animated elements: Trees, giraffe, shopping cart, buildings and heliport</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;night&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;sun&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;maki-fast-food&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;sky&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-bicycle&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-tree-1&quot;</span> <span class="na">data-child=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-tree-1&quot;</span> <span class="na">data-child=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-tree-1&quot;</span> <span class="na">data-child=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-giraffe&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-grocery-store&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-commerical-building&quot;</span> <span class="na">data-child=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-commerical-building&quot;</span> <span class="na">data-child=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;maki-heliport&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ground&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在CSS中导入 icon font(Maki):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">weloveiconfonts</span><span class="nc">.com</span><span class="o">/</span><span class="nt">api</span><span class="o">/?</span><span class="nt">family</span><span class="o">=</span><span class="nt">maki</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;maki-&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="m">#fff</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;maki-&quot;</span><span class="o">]</span><span class="nd">:before</span><span class="p">{</span>
</span><span class='line'>  <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;maki&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">*</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">top</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">right</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">content</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">-1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>整个场景旋转 &#8220;-3度&#8221;.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.wrapper</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">140</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">120</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">-3</span><span class="n">deg</span><span class="p">)</span> <span class="n">translate</span><span class="p">(</span><span class="m">-10</span><span class="o">%,</span> <span class="m">-15</span><span class="o">%</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>当日落西山后, 场景变换为夜晚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.night</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">5</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">night</span> <span class="m">45s</span> <span class="n">infinite</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">night</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%,</span> <span class="nt">30</span><span class="o">%,</span> <span class="nt">100</span><span class="o">%</span> <span class="p">{</span><span class="k">background</span><span class="o">:</span><span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="p">);}</span>
</span><span class='line'>  <span class="nt">55</span><span class="o">%</span> <span class="p">{</span><span class="k">background</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>sky与ground都用的是同样的<code>background-position</code>动画, 只是速度有所不同.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.sky</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">relative</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">background</span><span class="o">:</span> <span class="sx">url(http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/bedge_grunge.png)</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span><span class="o">-</span><span class="n">bg</span> <span class="m">25s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.ground</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">background</span><span class="o">:</span> <span class="sx">url(http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/blackorchid.png)</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span><span class="o">-</span><span class="n">bg</span> <span class="m">7s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">forwards</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">rollin-bg</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://lea.verou.me/2012/02/moving-an-element-along-a-circle/">沿着圆周移动一个元素</a>(the burger-sun)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.sun</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">left</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">top</span><span class="o">:</span> <span class="m">10</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">4em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">line-height</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="k">circle</span> <span class="m">45s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span> <span class="m">3.85em</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.sun</span> <span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="s2">&quot;maki-&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">240</span><span class="o">,</span> <span class="m">180</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">2</span><span class="p">);</span>
</span><span class='line'>  <span class="k">text-shadow</span><span class="o">:</span> <span class="m">0</span> <span class="m">0</span> <span class="m">.35em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">240</span><span class="o">,</span> <span class="m">240</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">7</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.sun</span> <span class="o">&gt;</span> <span class="nt">div</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">inner</span><span class="o">-</span><span class="k">circle</span> <span class="m">45s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">circle</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">from</span> <span class="p">{</span> <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">0</span><span class="n">deg</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">to</span> <span class="p">{</span> <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">360</span><span class="n">deg</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">inner-circle</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">from</span> <span class="p">{</span> <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">0</span><span class="n">deg</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>  <span class="nt">to</span> <span class="p">{</span> <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">-360</span><span class="n">deg</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>以下这个是唯一一个没有使用动画效果的元素, 但它看起来还是在移动.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.maki-bicycle</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">left</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">4</span><span class="p">;</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-.85em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">-.5em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">30</span><span class="o">,</span> <span class="m">30</span><span class="o">,</span> <span class="m">140</span><span class="o">,</span> <span class="o">.</span><span class="m">95</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这里全都是使用同样的滚动动画, 但速度不一的元素.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.maki-tree-1</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">5</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">5s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">2.4em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">110</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">8</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-tree-1</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">85</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">12s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">1.6em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">110</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">5</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-tree-1</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">25</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">17s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">1.2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">110</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">3</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-giraffe</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">.25em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">6</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">12s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">reverse</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">10em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">10</span><span class="o">,</span> <span class="o">.</span><span class="m">9</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-giraffe</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">right</span><span class="o">:</span> <span class="m">-3em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">content</span><span class="o">:</span> <span class="s1">&#39;\e82a \e82a \e82a \e82a \e82a&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font</span><span class="o">:</span> <span class="m">.2em</span> <span class="s1">&#39;Maki&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'>  <span class="k">letter-spacing</span><span class="o">:</span> <span class="m">.2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">3em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">.</span><span class="m">6</span><span class="p">);</span>
</span><span class='line'>  <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span>
</span><span class='line'>    <span class="m">0</span> <span class="m">.45em</span> <span class="m">0</span> <span class="m">.75em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">4</span><span class="p">)</span><span class="o">,</span>
</span><span class='line'>    <span class="m">1em</span> <span class="m">.35em</span> <span class="m">0</span> <span class="m">.75em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">4</span><span class="p">)</span><span class="o">,</span>
</span><span class='line'>    <span class="m">2.25em</span> <span class="m">.25em</span> <span class="m">0</span> <span class="m">1.05em</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="m">255</span><span class="o">,</span> <span class="o">.</span><span class="m">4</span><span class="p">)</span>
</span><span class='line'>  <span class="p">;</span>
</span><span class='line'>  <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">50</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="n">transform</span><span class="o">:</span> <span class="n">translate</span><span class="p">(</span><span class="m">2.3em</span><span class="o">,</span> <span class="m">.55em</span><span class="p">)</span> <span class="n">rotateY</span><span class="p">(</span><span class="m">-180</span><span class="n">deg</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-grocery-store</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-.35em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">5</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">22s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">4em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">220</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">10</span><span class="o">,</span> <span class="o">.</span><span class="m">7</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-commerical-building</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">3</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">6s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">7em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">120</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="o">.</span><span class="m">8</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-commerical-building</span><span class="o">[</span><span class="nt">data-child</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">]</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-1em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">14s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">4em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="m">120</span><span class="o">,</span> <span class="o">.</span><span class="m">4</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.maki-heliport</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">margin</span><span class="o">:</span> <span class="m">-3.5em</span> <span class="m">0</span> <span class="m">0</span> <span class="m">2em</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">30</span><span class="o">,</span> <span class="m">30</span><span class="o">,</span> <span class="m">30</span><span class="o">,</span> <span class="o">.</span><span class="m">45</span><span class="p">);</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">1.25em</span><span class="p">;</span>
</span><span class='line'>  <span class="n">animation</span><span class="o">:</span> <span class="n">rollin</span> <span class="m">26s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">reverse</span> <span class="m">2s</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">@keyframes</span> <span class="nt">rollin</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span><span class="k">margin-left</span><span class="o">:</span><span class="m">105</span><span class="o">%</span><span class="p">}</span>
</span><span class='line'>  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span><span class="k">margin-left</span><span class="o">:-</span><span class="m">15</span><span class="o">%</span><span class="p">;}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<pre class="codepen" data-height="300" data-type="result" data-href="ELuiG" data-user="TimPietrusky"><code></code></pre>


<script async src="http://codepen.io:/assets/embed/ei.js"></script>


<p>原文来自 Tim Pietrusky <a href="http://css-tricks.com/five-use-cases-for-icon-fonts/">5 Use Cases for Icon Fonts</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Improving UX Through Front-End Performance]]></title>
    <link href="http://xguox.github.com/blog/2013/03/20/improving-ux-through-front-end-performance/"/>
    <updated>2013-03-20T11:39:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/20/improving-ux-through-front-end-performance</id>
    <content type="html"><![CDATA[<p>想象一下,你正在一个马路口等待着过马路. You push the button to call the walk signal, and you take out your phone. 你想要完成某件事: 可能是查看邮件, 可能是给你的to-do列表添加一条item,又或者是阅读你的twitter. 你仅有有限的时间来完成这其中的一件事.</p>

<p>这所要花的长短取决于用户在你的网站上完成他们想做的事情的时长.这很重要.</p>

<p>据Google的一项研究, 用户的搜索结果页面每增加半秒会致使营业额和广告收入减少20%. 另外一篇来自Amazon的<a href="http://www.websiteoptimization.com/speed/tweak/psychology-web-performance/">类似报道</a>发现, 每增加额外的100毫秒加载时间, 销售额则会减少1%. 用户期望在两秒以内加载完整个页面, 否则第三秒后,高达40%的用户会<a href="http://www.gomez.com/pdfs/wp_why_web_performance_matters.pdf">选择离开</a>.</p>

<p>你能保持这样的速度? 如果你的网站包含有丰富的内容, 许多动态元素, 更大的JavaScript文件和复杂的图形, 那么我们当中的很多人的回答可能会是 &#8220;no&#8221;.</p>

<p>现在,是时候让我们把性能优化作为如何为各种设备设计, 搭建, 测试每一个我们创建的网站的基本组成部分了.</p>

<!-- more -->


<h2>Designing for performance</h2>

<p>网站的性能优劣从网站设计开始.权衡一个设计选择对你的网页速度的影响 你的网站的转化率. 你真的需要8个深浅不同的蓝色吗？这个宽度为1000px的背景图片还需要加什么值吗? 使用icon font来取代sprite会导致页面变得更重,渲染更慢, 还是会比使用原始图片更快呢?</p>

<p>并非所有的设计决策都是有利于性能的. 我发现一个略微减慢了页面速度的button样式可以提高转化(conversions), 对于仅需要牺牲小小的页面速度来说, 这是值得的.</p>

<p>但有时候, 我们更需要关注的是性能. 我曾经重新设计一个登录页面, 需要在上边为其添加大量的图片, 我不确定性能上变差了是否会对转化带来负面影响, 于是我在一个 <a href="http://alistapart.com/article/a-primer-on-a-b-testing">A/B test</a> 上为一小部分的用户推出了这个新的设计来看看会有什么样的反响. 新的设计加载时间是之前的两倍, 我看到了一个很高的 exit rate 和更低的转化率, 于是我们沿用了之前的轻量级设计. 犯错了没关系 &#8211; 它能给你一个参考的基准.</p>

<p>在另外一次试验, <a href="http://dyn.com/">dyn.com</a>主页上着重介绍的一个缩略图部分, 需要在10个图槽内交替显示26张图片.</p>

<p><img src="http://d.alistapart.com/371/dyncomhomepage.jpg" alt="dyn.com homepage." /></p>

<p>于是我的teammate把这26张的图片放到一个sprite里头, 结果:</p>

<ul>
<li>CSS,JavaScript,以及images的体积有所变大, 主页的总大小增加了<strong>60k</strong></li>
<li>请求数减少了<strong>21%</strong></li>
<li>页面总加载时间减少高达<strong>35%</strong></li>
</ul>


<p>这也就证明了这个试验是值得的: 我们也不确定这是否能给页面带来提速, 但我们都觉得这是值得学习的试验.</p>

<h2>Coding for performance</h2>

<p>清理你的HTML, 或许其他的一切也会跟着变好.</p>

<p>首先, 重命名你的HTML中的非语义化元素. 这可能会是最艰难的, 但只要你开始依据像<code>nav</code>,<code>article</code>这样的语义而不是通过图样或者网格来思考主题, 就会有显著的进展. 通常情况下, 我们是通过更复杂的CSS选择器来得到非语义化名称, 这样的话我们就会添加了不必要的ID和元素到HTML当中, 这反而会造成我们的CSS不够简洁, 同时也难以正确的使用某些特性.</p>

<p>其次, 就是整理你的CSS. 第一件事要做的是清除无效的选择器. 我在<a href="http://writegoodcode.com/">writegoodcode.com</a>中的<a href="http://dyn.com/how-we-got-dyndns-com-to-load-faster-and-how-you-can-learn-from-it">一次研究</a>发现, 在一个CSS文件中添加一些无效的选择器实际上会致使页面的加载时间增加<code>5.5%</code>. 更有效的CSS选择器也因为在样式表中更易阅读且有语义从而更易于将来的重设计和自定义样式. 多用途,可编辑的代码通常可以带来高性能. 在前面提到的那个研究中, 通过整理CSS文件我节省了<code>39%</code>的文件大小.</p>

<p>再次, 重点维护你的<code>div</code>. 通常你的标记越整洁, 那么你的CSS就会越小, 将来编辑,重设计也就更容易. 这不仅仅是提高了你的页面加载时间, 同时也为你节省了开发的时间.</p>

<p>最后, 专注于开发多用途的代码, 这样可以节省时间且减少CSS和HTML的大小. 更少的CSS和HTML可以明显地提高将来代码的可维护性和可重构性, 更轻的页面对加载速度有着积极的影响.</p>

<h2>Optimizing requests</h2>

<p>请求是指浏览器获取某样东西比如一个文件或者一个DNS记录. 你的标记越简洁, 浏览器也就更少的发出请求, 同时用户花在等待数据在客户端和服务端来回的时间就更少.</p>

<p>除了简洁的标记外, 还要做的是最小化JavaScript请求 &#8211; 只在确实需要的时候才加载之. 如果某一文件不是确实需要, 则不必在每一个页面都加载之. 不要在响应式设计中加载某一个只在大屏幕下才需要用到的JavaScript文件. 例如, 使用<a href="http://www.zurb.com/article/883/small-painful-buttons-why-social-media-bu">简单的链接来取代使用社交脚本</a>. 你也可以异步加载JavaScript从而不会导致所有的内容都被JavaScript给屏蔽掉.</p>

<p>尽管, 通常情况下响应式设计需要更多的CSS和图片(页面更重), 但还是可以通过减少请求来得到更快的页面加载速度.</p>

<h2>Optimizing images</h2>

<p>同样的, 尽你所能的减少图片的请求. 首先, 我们可以<a href="http://alistapart.com/article/sprites/">建立sprite</a>. 在 writegoodcode.com 的 研究中, 我发现一个案例使用icons sprite 后减少了<code>16.6%</code>的加载时间. 我喜欢通过创建一个背景重复的sprite来整理图片. 可能你需要创建的是水平重复或者垂直重复的.</p>

<p>接下来, 创建一个no-repeat backgrounds 的透明sprite. 这个sprite可以包含你的logo和icons. 如果你希望更先进一些, 可以使用像<a href="http://filamentgroup.com/lab/grunticon">Grunticon</a>这样的工具, 它可以使用SVG icon和background images,并基于用户浏览器的兼容性计算得出如何最好的为之服务.</p>

<p>在整理好所有新的图片后, 通过像<a href="http://imageoptim.com/">ImageOptim</a>这类的优化器运行. 同样的, retina-sized 的图片可以通过使用<a href="http://blog.netvlies.nl/design-interactie/retina-revolution/">extensive compression</a>使之变小, 不过最终结果不是特别显著.</p>

<p>现在, 看一看哪些图片你可以使用CSS3的渐变来替代. 这样做不仅仅是为了减少加载时间, 而且还可以使得在将来编辑页面变得极其简单, 因为开发人员无须找到原始图片进而编辑,生成,优化等.</p>

<p>最后, 来看看使用<a href="http://www.greywyvern.com/code/php/binary2base64">Base64 encode</a>, 它可以让你在CSS文件中嵌入图片而不是通过调用一个单独的URL. 通常看起来的结果如下:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nf">#nav</span> <span class="nt">li</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">content</span><span class="o">:</span><span class="sx">url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAI0lEQVQIW2P4//8/w8yZM//DMIjPAGPAMIiPWxCIMQQxzAQAoFpF7lGFr24AAAAASUVORK5CYII=)</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在一个小圆圈内随意添加一些字母和数字在很多地方都可以看到, 包括 dyn.com . 每次当你想要在你的设计中使用这类嵌入的图片, 可以让你节省一次图片请求. 这么嵌入图片会使你的CSS文件变得更大, 因此你需要测试嵌入前后的页面加载时间确保是有意义的.</p>

<h2>Measuring performance</h2>

<p>下面这部分比较有趣一些: 确认你的努力是否得到了回报.</p>

<p>Google的<a href="https://developers.google.com/speed/pagespeed/">PageSpeed</a>和Yahoo!的<a href="http://developer.yahoo.com/yslow/">YSlow</a>都而可以为你提供一些可以提高你的页面速度的建议, 包括确定哪个元素阻塞了页面渲染, 页面中不同的组件如HTML以及CSS的大小.</p>

<p>同时, 我也推荐YSlow的拓展 <a href="http://www.phpied.com/3po/">3PO</a>. 它可以检查你的网站所集成的一些流行的第三方脚本比如Facebook, Twitter, Google+等. 这个插件可以给你提高建议来进一步优化你的页面上的这些社交脚本进而提升页面速度.</p>

<p>自从我使用了PageSpeed 和 YSlow的建议来提高页面性能以后, <a href="http://webpagetest.org/">WebPageTest.org</a>已经成为我首选的基准参考工具. 它非常详细地给出关于请求, 文件大小, 时间等信息, 并且提供不同地方不同浏览器的测试.</p>

<p>确定基准可以在你设计的时候帮助你排除故障. 测量性能并分析结果可以帮助你的页面在大屏幕或者小屏幕上提速. 你可以测试或者定位像<a href="http://adactio.com/journal/5414/">conditional loading of images</a>这类技术从而在开发中更轻松应对性能问题.</p>

<h2>The impact of web performance</h2>

<p>网页的性能影响着你的用户&#8211;这意味着了解, 测量,提高性能问题是每个人的工作. 所有的这些技术都可以提高页面的加载速度. 进而可以显著的提高你的网站的用户体验.</p>

<p>用户更高兴了也就意味着更高的转化率, 无论你是按照什么来衡量, 或是收入, 注册数, 回访数, 还是下载数. 在更快的页面速度下, 用户可以使用你的网站在短时间内完成他们想要做的事&#8211;即使可能只是在等待红绿灯.</p>

<p>原文来自Lara Swanson <a href="http://alistapart.com/article/improving-ux-through-front-end-performance">Improving UX Through Front-End Performance</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[5 Meteor Misconceptions]]></title>
    <link href="http://xguox.github.com/blog/2013/03/14/5-meteor-misconceptions/"/>
    <updated>2013-03-14T16:52:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/14/5-meteor-misconceptions</id>
    <content type="html"><![CDATA[<p>由于某些原因，关于Meteor一直都有着各种各样的误解。或许是因为Meteor刚正式推出的时候， 缺失很多重要的功能。而很多不知道的是，这些缺陷在后来早就被修复了。</p>

<p>为了给Meteor正名，下面列举的是5个最常见的误解。</p>

<h2>误解#1：“Meteor的数据不安全”</h2>

<p>在Meteor的第一个Demo推出之时， 数据安全和用户权限这些东西是没有的。任何客户端的用户都能够访问，修改数据库的数据然后发送返回到服务端。</p>

<p>但这第一个版本只是作为一个提示告诉大家Meteor来了， 并不意味着它可以被用来打造一个真实的应用产品。 打那之后， 现在的Meteor已经有了一个内置的身份认证包（authentication package）。</p>

<!-- more -->


<p><strong>造成误解的另一个原因是， 许多新手为了更容易地快速上手常常在创建Meteor应用的时候， 遵循默认的把所有的数据发布给客户端。</strong></p>

<p>正如Meteor的开发者之一 <strong>Avital Oliver</strong>在<a href="http://stackoverflow.com/questions/10099843/how-secure-is-Meteor">StackOverflow上的回答</a>那样</p>

<blockquote><p>当你使用Meteor的命令行工具创建一个应用的时候， 默认的会包含有两个packages：<strong>AUTOPUBLISH</strong>和<strong>INSECURE</strong>. 这两个packages能使得每个客户端都拥有所有的服务器数据库读写权限效果。这是非常好的原型工具（目的只为了开发），但通常这不适合用于应用的生产环境。当你需要发布到生产环境的时候，请去掉这两个packages</p></blockquote>

<p>类似地，也因为Meteor可以共享服务端和客户端的代码，但实际上，这并不意味着所有的代码都可用于客户端.</p>

<p>所有放在<code>server/</code>目录下的东西都是只能在<a href="http://docs.Meteor.com/#structuringyourapp">服务端</a>执行使用的, 同时Meteor也让你可以定义<a href="http://docs.Meteor.com/#methods_header">服务端安全方法</a>，这些方法可以在客户端调用。</p>

<h2>误解#2：“Meteor对SEO不友好”</h2>

<p>与传统的网页应用不一样，Meteor不会在服务端搭建HTML页面。取而代之， 服务端只发送数据， 然后在客户端决定如何渲染之（这就是Meteor的“data on the wire”原则）</p>

<p>这种做法的缺点就是， 当JavaScript被禁用的话， 你的网站几乎跟一个空白页面无异。</p>

<p>你或许会觉得这会迷惑搜索引擎。但幸运地是， Meteor有解决的方案，那就是使用<a href="http://docs.Meteor.com/#spiderable">Spiderable</a> Package.</p>

<p><img src="http://theMeteorbook.com/images/phantomjs.png" alt="" /></p>

<p>这个package使用的是<a href="http://phantomjs.org/">PhantomJS </a>在服务端预渲染后提供给网络爬虫。实际上网络爬虫得到的网页跟你看到的是一样的。</p>

<h2>误解#3：“Meteor不支持第三方packages”</h2>

<p>有很多的讨论是关于Meteor所用的不是Node的标准包管理&#8211;NPM. 而事实上， Meteor压根就没有不允许使用第三方程序包.</p>

<p>And it’s true that the vanilla install of Meteor does not come with a package manager. 但庆幸的是， <a href="http://theMeteorbook.com/">本书</a>的合著者之一Tom Coleman， 同时也是Meteor包管理器<a href="https://github.com/oortcloud/Meteorite">Meteorite</a>和packages资源库<a href="http://atmosphere.Meteor.com/">Atmosphere</a>的开发者。</p>

<p>尽管当下Meteorite 和 Atmosphere还不是Meteor的官方部分， 但它们已经得到广泛的使用并将会在未来被合并到Meteor的核心部分。事实上，这方面的工作已经在Meteor的核心代码的<a href="https://github.com/Meteor/Meteor/tree/engine">engine</a>分支中开展，预期会被很快解决。</p>

<h2>误解#4：“Meteor是完全封闭的(walled garden)”</h2>

<p>一个密切相关的异议是,Meteor可以支持第三方packages,但这些第三方packages却严格地限制于流星的生态系统。</p>

<p>为什么有成千上万的Node packages 在那还要使用自定义的package呢？这又是否与开源精神相悖呢？</p>

<p>首先，需要意识到一点很重要的就是， 在Meteor中可以任意的使用node packages。尽管在当下这么做可能还会有一些棱角使得接口不那么顺利，但这种情况在<code>engine</code>分支添加<a href="https://groups.google.com/forum/?fromgroups=#!topic/Meteor-talk/b6zQrgk8lYo">Node support</a>
并发布后将得到很大改善。</p>

<p><img src="http://theMeteorbook.com/images/npm.png" alt="" />
其次，Meteor不仅仅是Node.js的一个框架， 更是一种全新的网站应用开发方式和构想.</p>

<p>换句话说，想知道为什么Meteor不使用NPM无异于问为什么它不能使用Ruby Gems. 有很多人建议所有的JavaScript代码应该都用NPM来管理， 但这么做的话会有一些细节上的问题， 正如核心开发者<a href="https://github.com/Meteor/Meteor/pull/516#issuecomment-12919473">解释说</a>.</p>

<h2>误解#5：“Meteor只适用于原型”</h2>

<p>“Meteor非常适用于小规模快速原型的项目，但它不适合用于大规模的应用.”</p>

<p>在某种程度上， 这很难争个谁对谁错。毕竟Meteor的主页的版本号还是以<code>0</code>开头.</p>

<p>但事实是Meteor还没准备到一个黄金时间，比起内在的局限性，在如此青涩的时期(不到一岁)Meteor还有许多需要做的。</p>

<p>再说， 即使是现在， 有时牺牲一点稳定性来做交换得到Meteor带来的轻松且快速的开发还是值得的。如果你希望看到一些具体的Meteor案例，我可以推荐看看<a href="http://telesc.pe/">Telescope</a>吗？</p>

<p>So，我坚信，在Meteor这样快速发展之下，今天的技术原型将会是明天thousand-user 的应用.</p>

<h3>总结</h3>

<p>现在，即使我们正在写这本关于Meteor的书， 但我们首先依旧会承认一点， 如同其他的技术那样，Meteor同样也有着自己的缺陷。</p>

<p>But I do believe Meteor has enough potential to make it worth evaluating it on its own merits. 所以如果你犹豫不决是否使用Meteor， 希望我的建议能说服你你选择它.</p>

<p>原文来自 Sacha Greif  <a href="http://theMeteorbook.com/2013/03/12/5-Meteor-misconceptions/">5 Meteor Misconceptions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introduction to Realtime Web with Meteor and Node.js]]></title>
    <link href="http://xguox.github.com/blog/2013/03/10/introduction-to-realtime-web-with-meteor-dot-js-and-node-dot-js/"/>
    <updated>2013-03-10T23:16:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/10/introduction-to-realtime-web-with-meteor-dot-js-and-node-dot-js</id>
    <content type="html"><![CDATA[<p>最近,有许多关于 <a href="http://derbyjs.com/">Derby.js</a>的激动人心的讨论涌现在了我的Twitter Timeline. 我从未使用过能够帮你做这么多&#8211;实时同步客户端和服务端 的框架. 从本质上讲, 这使得我们可以自己编写一个代码量很少的应用可以让两个人编写同一个 text field–live. 而 Derby帮你处理了在 models 和 views 之间所有的同步. 就如 Google Docs 的协作编辑那样.</p>

<p>这非常的伟大, 但经过深入的研究, 发现 Derby.js 并没有我想象中的那么成熟&#8211;目前还没有到1.0版本. 当然, Node.js 和 Meteor 也同样没有. 但相比起来, 似乎Derby缺少的更多一些. 比如, 据我目前知道的, 还没有一个好使的方法来处理sessions. 或许是因为缺乏文档的原因吧, 但是, 据说Derby的团队目前正在开发authentication. 如果有谁有一些关于Derby.js 处理sessions的新手指引, 我会很乐意去研究的.</p>

<p>另外一个我经常见到被拿来与Derby.js做比较的框架是<a href="http://Meteor.com/">Meteor</a>. 与Derby相似的是,它也能在多个客户端下实时更新views, 尽管做法上可能跟Derby有点不同. Derby可以较容易的使用多种数据库, 而Meteor则只亲近于<a href="http://mongodb.org/">MongoDB</a>. 事实上, 通过如<a href="http://mongoosejs.com/">Mongoose</a>客户端接入数据库的API与你在服务端所期望的已经非常接近了.</p>

<p>比起现在node的一些缺点和<a href="http://bjouhier.wordpress.com/2012/03/11/fibers-and-threads-in-node-js-what-for/">争议</a>, Meteor看起来是非常有趣的选择用来建立有实时需求的应用. 个人觉得还是Derby基于传统回调的编程形式更吸引我, 但在Derby的强大背后,却缺乏健壮的文档和一个大的开发者社区, 这无疑是个很大的打击. 或许这会随着时间推移而有所改变吧, 但比起Meteor来说还是会慢很多, 因为后者最近获得了1100万美元的资金. 这笔财政资金确保了Meteor的存在以及得到持续的支持. 对于那些需要财政与发展稳定的框架的开发者而言, 这笔资金只会让Meteor更加优胜.</p>

<!-- more -->


<p>今天,让我们一起来看看如何新建一个真实的但又简单的Meteor应用. 本质上说, 这是基于<a href="http://vimeo.com/40300075">Tom的 Vimeo screencast</a>的一个新手指引. 与Tom的 Vimeo screencast最大的不同是处理事件的方式. 比起复制粘贴一个Meteor示例的代码, 我会一步一步的通过自己的方式来处理使用Enter键来提交一则讯息. 让我们开始吧.</p>

<h3>Creating a Meteor App</h3>

<p>Derby和Meteor 他们共有的一个大加分是他们各自的命令行工具. 与Derby使用Node的内置的 npm 工具所不同的是, Meteor使用的是它自己的.</p>

<p>在终端(Mac OS X 和 Linux),执行如下的命令. (在这之前请确保你已经安装了Node)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl https://install.Meteor.com | /bin/sh</span></code></pre></td></tr></table></div></figure>


<p>接下来的事Meteor会自己搞定了.</p>

<p>要新建一个项目, 先转到你的工作目录然后运行下边的代码. 这会创建一个目录, 里边包括有Meteor和一个最基本模板程序.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ Meteor create chat</span></code></pre></td></tr></table></div></figure>


<p>现在, 你可以转到该目录并运行下面的代码让它跑起来</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd chat
</span><span class='line'>$ Meteor
</span><span class='line'>Running on: http://localhost:3000/</span></code></pre></td></tr></table></div></figure>


<p>想要看到这个最基础的应用程序, 你只需要在任意一款不过时的浏览器下打开<code>http://localhost:3000/</code></p>

<p>只要你想, 你可以使用Meteor内置的<code>Meteor deploy</code>命令来部署你的应用到Meteor自己的服务器上</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ Meteor deploy my-app-name.Meteor.com</span></code></pre></td></tr></table></div></figure>


<p>只要你更新保存了你的代码, 所有连接上的浏览器都会实时更新其页面.</p>

<h3>Developing the Chat App</h3>

<p>通过<code>Meteor create</code>命令生成的文件夹里, 你可以看到几个不同的文件. 如果你的系统设置了显示隐藏文件, 那还可以看到一个<code>.Meteor</code>文件夹. 这个文件夹包括的Meteor本身, 以及MongoDB数据库的文件.</p>

<p>在你的项目的根目录, 你可以看到的还有<code>chat.html</code> <code>chat.js</code> <code>chat.css</code>. 这三个文件自解释?的. HTML包含了这个应用的模板和视图, 并都通过<code>chat.css</code>来添加样式. 而这个JavaScript文件则包含了在客户端和服务端执行的代码. 这非常的重要&#8211;请不要把任何东西比如配置数据和密码都放在这里, 因为任何人都能通过查看你的应用程序的源文件看到.</p>

<p>用你最喜欢的文本编辑器打开<code>chat.js</code>. 我个人使用的是<a href="http://sublimetext.com/">Sublime Text 2</a>, 因为它很简洁并且有多光标功能.
你可以在<code>chat.js</code>看到下面这些代码</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">hello</span><span class="p">.</span><span class="nx">greeting</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="s2">&quot;Welcome to chat.&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">hello</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="s1">&#39;click input&#39;</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// template data, if any, is available in &#39;this&#39;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">console</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;You pressed the button&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Meteor</span><span class="p">.</span><span class="nx">startup</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// code to run on server at startup</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>分别注意到<code>if</code>语句里的<code>Meteor.is_client</code>和<code>Meteor.is_server</code>部分. 在这里边的代码分别只在客户端和服务端下执行. 这就是Meteor共用代码的能力了.</p>

<p>删除掉<code>Meteor.is_server</code>这段代码并把<code>if (Meteor.is_client)</code>里边的代码删除了,只留如下部分:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>注意到, 当你保存了你的脚本之后, 浏览器会马上重新加载这个新脚本.</p>

<h3>Creating the View</h3>

<p>在我们正式对这个脚本文件动工之前, 我们需要先新建一个视图用来展示聊天记录.
在编辑器里打开<code>chat.html</code>并删除<code>body</code>标签里边的代码. 包括名为hello的<code>template</code>标签.只留如下部分</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>chat<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>接着在<code>body</code>标签里添加下面这句</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>{{&gt; entryfield}}
</span></code></pre></td></tr></table></div></figure>


<p>Meteor使用的模板系统与<a href="http://mustache.github.com/">Mustache</a>很相似.大括号<code>{{}}</code>表示要呈现的内容. 通过简单地在两对大括号里添加内容如<code>{{hello}}</code>, 模板系统会用<code>hello</code>这个变量的值来替换它. 后面会更详细的介绍.</p>

<p>注意到了在<code>entryfield</code>这个词前面有个大于号<code>&gt;</code>了吗? 使用该符号来指定渲染哪一个模板.</p>

<p>接下来使用下面这段代码来新建一个名叫<code>entryfield</code>的模板</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;entryfield&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;name&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Name&quot;</span> <span class="nt">/&gt;</span> <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;message&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Your Message&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在这个例子中,<code>template</code>标签只有一个属性&#8211;用来表示这个template的名字. 也就是当我们渲染的时候需要用来指定的名字.</p>

<p>查看浏览器, 你会发现页面已经刷新了, 输入框已经呈现出来了.</p>

<p>接下来, 在body里边添加另外的一个mutache标签用以渲染讯息列表</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>{{&gt; message}}
</span></code></pre></td></tr></table></div></figure>


<p>最后, 我们还需要新建一个名叫<code>messages</code>的模板. 在<code>entryfield</code>模板下面添加下面这段代码</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;messages&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;p&gt;</span>
</span><span class='line'>        {{#each messages}}
</span><span class='line'>            <span class="nt">&lt;strong&gt;</span>{{name}}<span class="nt">&lt;/strong&gt;</span>- {{message}}
</span><span class='line'>       {{/each}}
</span><span class='line'>  <span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>注意到<code>each</code>子句. 在Meteor中你可以使用如下的语法来遍历一个数组模板</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>
</span><span class='line'>{{#each [name of array]}}
</span><span class='line'>{{/each}}
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>使用each循环时,上下文会有所改变. 当引用变量的时候, 实际上你引用的是每一个数组元素的值.
例如,在我们的chat应用中, 我们遍历了数组模板&#8221;messages&#8221;里边的每个元素, 该数组可以像下面这样,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">[</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello world!&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Hey, Andrew!&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>然后, 在each循环中, 你可以看到<code>{{message}}</code> <code>{{name}}</code>, 这会引用 每一个数组元素的值来替代(Andrew 和 Bob 替换 name, 以及各自的问候信息.)</p>

<p>当返回到你的浏览器, 你还看不到任何的改变. 因为讯息数组还没被传送到模板, 所以Meteor遍历不到任何东西来呈现.</p>

<p>你的<code>chat.html</code>最后应该是这样的</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>chat<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  {{&gt; entryfield}}
</span><span class='line'>  {{&gt; messages}}
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;entryfield&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;name&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Name&quot;</span> <span class="nt">/&gt;</span> <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;message&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Your Message&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;messages&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  
</span><span class='line'>    <span class="nt">&lt;p&gt;</span>
</span><span class='line'>      {{#each messages}}
</span><span class='line'>            <span class="nt">&lt;strong&gt;</span>{{name}}<span class="nt">&lt;/strong&gt;</span>- {{message}}<span class="nt">&lt;br/&gt;</span>
</span><span class='line'>        {{/each}}
</span><span class='line'>    <span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h3>The Javascript</h3>

<p>从现在开始, 我们处理的大部分代码都是客户端代码, 所以, 除非特别说明, 以下的代码都是在<code>if (Meteor.is_client)</code>代码块中.</p>

<p>在我们编写展示讯息的代码之前,让我们先新建一个<code>Collection</code>. 从本质上讲, 这是一组Models. 换句话说, 在这个chat应用的环境下, Messages collection保存着整个聊天记录, 而每条讯息记录是一个Model.</p>

<p>在if语句前, 添加如下代码来初始化Collection:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>因为我们希望这个Collection可以在客户端和服务端被创建, 所以我们把它写在了客户端代码块之外.</p>

<p>由于Meteor为我们做了大部分的工作, 要展示聊天记录是非常容易的. 只需要把下面的代码添加进if语句里边.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">messages</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span> <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">time</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>让我们拆开来分析这段代码:<br/>
<strong>Template</strong>.messages.messages = function(){ … }<br/>
第一部分<code>Template</code>表示我们正在修改一个模板的行为.<br/>
Template.<strong>messages</strong>.messages = function(){ … }<br/>
第二部分<code>messages</code>是模板的名字, 表示是在修改哪一个模板. 例如,如果我们想要对&#8221;entryfield&#8221;模板做些什么,   只需把代码改成<code>Template.entryfields.variable = function(){ … }</code>(在这里, 请别这么做)<br/>
Template.messages.<strong>messages</strong> = function(){ … }<br/>
第三部分的这个<code>messages</code>代表的是一个这个模板里的一个变量. 还记得我们的each循环遍历<code>messages</code>吗? 这就是那个mesaages.</p>

<p>当你打开浏览器时, 页面还是没有什么改变. 这是意料之中的事, 因为我们只抓取的讯息, 而没有展示出来.</p>

<p>此时,你的<code>chat.js</code>应该是这样的. 是否很惊讶就只需在服务器写这么些代码我们就能展示一个实时的聊天记录应用.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">messages</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span> <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">time</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Adding a Message through the Console</h3>

<p>这部分的内容是可选的, 当然它有助于你调试程序. 你可以直接跳过往下学习建立form来响应key press.</p>

<p>如果你想要测试你的讯息显示代码, 你可以手动插入一条记录到数据库. 打开你的浏览器控制台, 并输入如下:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Messages</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Andrew&#39;</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;Hello world!&#39;</span><span class="p">,</span> <span class="nx">time</span><span class="o">:</span> <span class="mi">0</span> <span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>这将会在数据库中新建一条记录, 如果正确的操作了的话,那浏览器就会即刻更新这条讯息在页面上.</p>

<h3>The Message Entry Form</h3>

<p>返回到<code>chat.js</code>, 我们即将要完成的是允许用户在输入框中提交聊天讯息到数据库. <br/>
在if语句里头最下面添加下面这段代码</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">entryfield</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;keydown #message&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">which</span> <span class="o">==</span> <span class="mi">13</span><span class="p">){</span>
</span><span class='line'>      <span class="c1">// Submit the form</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">Messages</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
</span><span class='line'>          <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">message</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">time</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>        <span class="nx">message</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这段代码比较多, 让我们一步步分析. 你应该还有印象, 紧跟<code>Template</code>之后的词表示我们即将要修改的template的名字. 跟前面修改的模板是<code>messages</code>不一样的是, 这里我们要修改的是<code>entryfield</code>.<br/>
template的<code>event</code>属性会包含有一个对象, 这个对象的keys的格式如下:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s2">&quot;[eventname] [selector]&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>比如, 如果我们想绑定了一个<code>click</code>事件给了ID为<code>hello</code>的按钮. 则需要像下面这样添加一个<code>events</code>对象</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s2">&quot;click #hello&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span> <span class="err">…</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在我们这个例子中,我们绑定了一个<code>keydown</code>事件给了ID为<code>message</code>的输入框. 这个输入框在我们一开始的<code>chat.html</code>已经建好.</p>

<p>在<code>events</code>对象里, 每一个key都有一个函数作为它的值. 当事件被触发的时候, 这个<code>event</code>对象会被作为第一个参数传给这个函数.在我们的chat应用, 每一次在输入框中按下一个按键(<code>keydown</code>), 这个函数都会被调用.</p>

<p>在函数里的代码非常简单. 首先, 我们先要检测按下的是否&#8221;enter&#8221;键(&#8220;enter&#8221;的keycode 是13). 接着,通过ID来得到两个输入框中的DOM元素. 最后, 我们检查确保输入框中的值不为空, 用户不允许发送空的名字和讯息.</p>

<p>下面的代码需要注意了, 它会被直接插入到数据库中</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Messages</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">message</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">time</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>你会发现,这其实跟我们直接在浏览器控制台中输入的代码很相似, 只是我们用DOM元素的值来替换固定值. 另外, 欧文木讷添加了时间值来确保是按照时间来排序.</p>

<p>最后,我们把两个输入框设置为空<code>''</code></p>

<p>现在, 你可以打开浏览器尝试在输入框输入名字和讯息. 按下&#8221;enter&#8221;后,输入框会被被清空, 而且这则讯息会立马出现在你的输入框下边. 使用另外一个浏览器窗口或者其他浏览器打开同样的链接(<code>http://127.0.0.1:3000</code>).    尝试输入一则新的讯息, 此时你就会看到Meteor的强大之处.无须单独写一行代码来更新讯息记录, 就可以实时同步在不同的客户端浏览器中.</p>

<h3>Conclusion</h3>

<p>While Meteor is pretty cool to work with and there are some pretty useful applications for it, like Derby.js, it is immature. For examples of this, just browse through the documentation and look for the red quotations. For example, the documentation states the following about MongoDB collections:</p>

<blockquote><p>Currently the client is given full write access to the collection. They can execute arbitrary Mongo update commands. Once we build authentication, you will be able to limit the client’s direct access to insert, update, and remove. We are also considering validators and other ORM-like functionality.</p></blockquote>

<p>对于任何一个产品而言, 用户拥有数据库的所有读写权限都是非常大的问题, 非常危险.</p>

<p>原文来自Andrew Munsell <a href="http://www.andrewmunsell.com/blog/introduction-to-realtime-web-Meteor-and-nodejs/#.UTyJZtHN-tv">Introduction to Realtime Web with Meteor and Node.js</a></p>

<p>另附上Tom的 Vimeo screencast(需FanQiang)<br/>
<video width='640' height='320' preload='none' controls poster=' http://b.vimeocdn.com/ts/278/431/278431171_960.jpg'><source src='http://av.vimeo.com/31624/419/93304834.mp4?aksessionid=d86b5b612c86d70bd2022ae1050aa1be&token=1362992353_ce10e413b18fa6f2d0e3483ef6b82894' type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'/></video></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Meteor基础与最佳实践]]></title>
    <link href="http://xguox.github.com/blog/2013/03/08/learn-meteor-fundamentals-and-best-practices/"/>
    <updated>2013-03-08T17:42:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/08/learn-meteor-fundamentals-and-best-practices</id>
    <content type="html"><![CDATA[<h2>引言</h2>

<p>想知道这个新奇又好玩的东西&#8212;Meteor是如何工作的?那就太好了,你来对地方了. 我会向你展示一个Meteor项目的方方面面 并会给你一些最好的提示让你应用在未来自己的Meteor项目当中.</p>

<h2>What is Meteor</h2>

<p>Meteor能让你打造非常动态的的网页同时代码量出乎意料之少. 记住一点,Meteor目前还在一个超级测试的版本(原文发布时候为 preview 0.3.8, 翻译时为 preview 0.5.7). 所以, 请不要因为工作的不够完美而感到意外.<br/>
Meteor是基于<a href="http://nodejs.org/">Node.js</a>, 因此, 你所写的大部分代码也将会是JavaScript. 这没什么好惊奇的. 如果你想要一些好的资源来快递提高你的JavaScript, 可以看一看 <a href="http://bonsaiden.github.com/JavaScript-Garden/">JavaScript Garden</a>.  <br/>
Meteor存储数据所使用的是MongoDB. 尽管如此, 实际上,Meteor使用的是minimongo作为接口.  它只是拥有相对完整的功能而非标准MongoDB的所有功能. 你并不需要确切地知道MongoDB是如何工作的, 但我还是建议你看一看Meteor 的<a href="http://docs.Meteor.com/#collections">Collections文档</a>以便知道你能做些什么.<br/>
Meteor目前使用的模板引擎只能是 <a href="http://handlebarsjs.com/">handlebars</a>. 但在未来支持使用别的模板引擎也是很有可能的.(翻译该文章时已经支持使用其他的如 Jade )<br/>
最后, 只要你开发网站, 了解 HTML 和 CSS 都是必须的.</p>

<h2>基础</h2>

<p>一个Meteor项目包含的大多都是JavaScript文件. 如果你放置任意一个 <code>*.js</code>文件在你的项目的任何位置, Meteor会自动帮你加载并运行之. 你在Meteor项目中写的每一个JavaScript文件都会被部署到服务端和客户端(额&#8230;也不完全是这样的,继续往下看吧!). 之所以Meteor这么,这么的cool,原因之一就是:当你写了一个JavaScript函数,在客户端和服务端都可以使用之!  <br/>
更cool的是, 比如,你在项目的任意一个地方放置<code>*.less</code>, 那么这些文件都会自动被编译并发送至客户端以及从而包含进页面当中.<br/>
有时候,可能你希望分离开服务端和客户端的代码. 幸运地是,<!-- more --> Meteor有这么一对标识可以帮你:<code>Meteor.is_server</code>和<code>Meteor.is_client</code> <br/>
下面的例子在浏览器的JavaScript控制台中会输出<code>Hi. I’m CLIENT</code>,而在服务端中则会输出 <code>Hi. I’m SERVER</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// This function is available on both the client and the server.</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">greet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Hi. I&#39;m &quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Everything in here is only run on the server.</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">greet</span><span class="p">(</span><span class="s2">&quot;SERVER&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Everything in here is only run on the client.</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">greet</span><span class="p">(</span><span class="s2">&quot;CLIENT&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这非常的简单. 在客户端和服务端共用代码使你能够做到最大化的代码复用,这大大地减少了开发时间.</p>

<h2>项目文档结构</h2>

<p>可能, 你无数次地希望不再服务端和客户端之间共享所有的一切. 比如你有一些私密的算法在服务端执行,而你绝不希望Meteor把这些算法发送至客户端让全世界都看得见. Meteor提供了两个&#8221;特殊&#8221;的目录来帮助分离客户端和服务端的代码:<code>[project_root]/client/</code>和<code>[project_root]/server/</code>. 在server目录的JavaScript只会在服务端执行而不会发送至客户端, 反之亦然. 这就使得我们无须在各个地方都使用<code>Meteor.is_client</code>  和 <code>Meteor.is_server</code>.取而代之, 对应的放置你的代码就OK了.</p>

<p>项目的文件结构非常重要, 尤其在考虑到文件的先后加载顺序的时候. 假定有两个文件, 其中一个依赖于另外一个, 你知道你的JavaScript的加载顺序吗?  其规则如下:</p>

<ol>
<li> <code>[project_root]/lib</code>里的文件会最先被加载. 显而易见的,  库需要放在这个文件</li>
<li>文件会根据目录的深度来进行加载排序,放在深一层的文件会先加载</li>
<li>同一级的文件会按照字母顺序来排序加载.</li>
<li> <code>main.*</code> 会最后加载, 当有代码需要在其他所有的库或脚本之后执行这会很有用.</li>
</ol>


<p>Meteor有一些特殊的目录来帮助你解决分离 <code>client/server</code>的代码以及加载的顺序:</p>

<ul>
<li><code>[project_root]/lib/</code>  该目录下的代码会在你的 client/server 代码执行之前加载</li>
<li><code>[project_root]/client/</code> 这个目录下的代码只会在浏览器端而不会在服务端执行</li>
<li><code>[project_root]/server/</code> 这个目录下的代码只会在服务端而不会客户端执行</li>
<li><code>[project_root]/public/</code> 静态文件放在这个目录下, 并且你可以很轻松地在你的html中指向 image.jpg</li>
<li><code>[project_root]/.Meteor/</code> 一些特殊的,和项目相关的的信息放在这里,  比如你安装的某些模块. 你几乎可以不用关心这里边的东西</li>
</ul>


<h2>响应(Reactivity)</h2>

<p>Meteor 通过 响应数据源(“reactive” data sources) 和 上下文(context) 帮你省去了当数据改变时手动替换页面的麻烦. 当响应数据源被更新后,响应上下文会重新运行(A reactive context is just a function that will get re-run if it contains a reactive data source that gets updated.) 刚开始的时候要把思维转换过来可能有些难, 下面的例子将为你解释清楚. <br/>
下面是一个html页面和一个叫<code>cool_dude</code>Meteor<a href="http://docs.Meteor.com/#templates">模板</a>, 以及一个在客户端运行的JavaScript函数&#8212;传一个<code>username</code>的值给模板用以渲染.
Liquid error: undefined method `join&#8217; for #&lt;String:0x007fdfa30f36a8></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;cool_dude&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;important&quot;</span><span class="nt">&gt;</span>{{ username }} sure is one cool dude!<span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// On the client:</span>
</span><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">cool_dude</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="s2">&quot;Andrew Scala&quot;</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>当页面被渲染的时候会输出 <code>“Andrew Scala sure is one cool dude!”</code></p>

<p>模板即是响应的上下文: 如果它依赖于响应数据源, 那么当数据源改变时它会重渲染自身. 客户端的<code>session</code>一种响应数据源. 它只会在客户端存储一些键值对, 且当页面刷新的时候被擦除.</p>

<p>让我们把上面的例子模板上下文改为响应数据源:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// When the app starts,</span>
</span><span class='line'><span class="c1">// associate the key &quot;username&quot; with the string &quot;Andrew Scala&quot;</span>
</span><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">startup</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">,</span> <span class="s2">&quot;Andrew Scala&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">cool_dude</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>现在,模板将会在<code>Session</code>里取到<code>username</code>的值. 在响应上下文我们有一个响应数据源. 如果存储在<code>Session</code>的<code>username</code>的值更改了, 模板会重新渲染新的值到页面上. 如给<code>username</code>设置一个新的值:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">,</span> <span class="s2">&quot;Bill Murray&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>只要执行了这行代码,不管在哪, 页面都会立马输出<code>Bill Murray sure is one cool dude!</code><br/>
在这里, 我会列出其他的响应上下文和数据源,你也可以到 Meteor的<a href="http://docs.Meteor.com/#reactivity">Reactivity文档</a>自行阅读.</p>

<h2>发布/订阅</h2>

<p><strong>Note: 在每一个项目的根目录下执行<code>$ Meteor remove autopublish</code>, 否则它会默认发布你的所有数据到客户端, 这显然不是个好的做法</strong></p>

<p>服务端发布数据给客户端使用, 同时,客户端向服务端订阅已发布的数据. 在刚开始, 想要明白服务端发布数据和客户端订阅数据的关系会有些困难. 常规的经验是这样的: <strong>客户端只能访问当前时间点需要操作的数据, 除此之外的均不能访问</strong>. 举个例子, 如果你有一个聊天应用, 客户端不能够接收你的网站上每一个频道的所有信息, 而只能是当前所访问的频道的信息. 同样的也不能够知道别的频道的用户.</p>

<p>下面这是一个关于 发布/订阅 的方面教材,  客户端可以看到数据库中的每一条信息:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>当在客户端<code>Messages.find({})</code>,可以得到数据库里的每一条信息.<br/>
我们可以指定一个参数使得在订阅的时候缩小范围只获取实际需要的信息(如在<code>"cool_people_channel"</code>频道中的信息)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">channel_name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">channel</span><span class="o">:</span> <span class="nx">channel_name</span><span class="p">});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;current_channel&quot;</span><span class="p">,</span> <span class="s2">&quot;cool_people_channel&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">autosubscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">Meteor</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s2">&quot;messages&quot;</span><span class="p">,</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;current_channel&quot;</span><span class="p">));</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://docs.meteor.com/#deps_autorun">Meteor.autorun</a>是一个响应上下文, 意思是只要有响应数据源更新,所有在里头的东西都会重运行. 我们把当前所在的频道存储在Session的<code>"current_channel"</code>. 如果这个session值改变, 那么订阅(subscription)也就更新,
这样我们就能够访问其他的信息了. 如果用户想要加入<code>“breakfast talk”</code>这个频道. 我们可以运行<code>Session.set("current_channel", "breakfast_talk")</code>, 这会触发autosubscribe, 让我们可以且仅可访问<code>"breakfast_talk"</code>频道下的信息.</p>

<p>或许,你很多次都希望发布所有的collection到客户端. 仔细思考客户端实际需要的是什么. 比起发送所有的文档, 只发送特定领域会来得明智些.</p>

<h2>服务端方法</h2>

<p>由于客户端不允许查看数据库中有什么东西, 你一对会好奇客户端又是如何存储信息的. 解决办法是使用Meteor的<a href="http://docs.Meteor.com/#methods_header">服务端方法(Server Methods)</a>. 你在服务端定义了所有的函数用以一些危险的做法比如修改和更新数据, 然后让客户端像调用常规方法那样call这些函数并返回值. 客户端永远也不会看到具体的实现,也不会自己修改数据. 这些都是服务端做的事.<br/>
想要添加一个用户到数据库中, 假定有一个叫<code>create_user</code> 的方法&#8211;传入一个username并让服务端插入一条记录. 它会返回给客户端一个<code>ObjectID</code>这样客户端可以抓取到这个用户的信息并做任何接下来要做的事.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">methods</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">create_user</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">username</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;CREATING USER&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="kd">var</span> <span class="nx">USER_id</span> <span class="o">=</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="nx">username</span><span class="p">});</span>
</span><span class='line'>            <span class="k">return</span> <span class="nx">user_id</span><span class="p">;</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Remember, the client&#39;s browser only ever sees the code below:</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="s2">&quot;Andrew Scala&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;create_user&quot;</span><span class="p">,</span> <span class="nx">username</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">user_id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="nx">user_id</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在这个例子中我的 user_id被设置到客户端session中, 当任意模板使用到我的user_id
 的时候均立马可以得到更新.</p>

<h2>保护你的数据</h2>

<p>默认的, 你可以在客户端打开一个JavaScript 控制台并<strong>运行数据库查询</strong>.这非常的不安全.最糟糕的情况是, 当我们在访问你这么cool的Meteor应用时可以运行<code>Users.remove({})</code>来擦除你的所有数据.</p>

<p>Meteor即将会做一些措施来更好的保护你的数据, 但截至目前为止这是唯一的方法可以做到保护的. 这些代码被包含在了基于 Meteor的 <a href="http://madewith.Meteor.com/">madewith</a>网站中.这个代码片段阻止了从客户端进行insert/update/remove等操作. 把下面这段代码放在你的服务端代码中的任意位置:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// Relies on underscore.js. In your project directory:</span>
</span><span class='line'><span class="c1">// $ Meteor add underscore</span>
</span><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">startup</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">collections</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;collection_name_1&#39;</span><span class="p">,</span> <span class="s1">&#39;collection_name_2&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">collections</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">collection</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s1">&#39;insert&#39;</span><span class="p">,</span> <span class="s1">&#39;update&#39;</span><span class="p">,</span> <span class="s1">&#39;remove&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">Meteor</span><span class="p">.</span><span class="nx">default_server</span><span class="p">.</span><span class="nx">method_handlers</span><span class="p">[</span><span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">collection</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>敬请关注</h2>

<p>准备好开发一个真实的Meteor项目了吗?一起期待吧, Part 2 就在路上了.届时将引导你完成一个完整的app!</p>

<p>原文来自Andrew Scala <a href="http://andrewscala.com/meteor/">Learn Meteor Fundamentals and Best Practices</a>  <br/>
Ps:文章有点老,XD&#8230;不过就像该篇文章的作者所说, Meteor 现在还是处于一个 super-beta 阶段, 版本更新自然会相对来得快些. 据说1.0版本将会在不到一年的时间内发布.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A Look at a Meteor Template]]></title>
    <link href="http://xguox.github.com/blog/2013/03/06/a-look-at-a-meteor-template/"/>
    <updated>2013-03-06T14:40:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/06/a-look-at-a-meteor-template</id>
    <content type="html"><![CDATA[<h5>LEVEL: BEGINNER</h5>

<p>学习一门语言或框架的最好方法之一是从零开始开发一个应用程序.</p>

<p>但是,当你开发了N次的To-do list应用之后, 或许你会想要一些稍微新鲜的玩意. 所以这一次, 让我们来看看一些实际的应用的代码, 这里我们用的是 <a href="http://telesc.pe/">Telescope</a></p>

<p>Telescope是一个基于Meteor的开源社交新闻网站. <a href="http://reddit.com/">Reddit</a> or <a href="http://news.ycombinator.com/">Hacker News</a>的实时版本.</p>

<p>我们即将看到的代码是简化版的<code>post_edit</code><a href="https://github.com/SachaG/Telescope/blob/master/client/views/posts/post_edit.html">模板</a>及其<a href="https://github.com/SachaG/Telescope/blob/master/client/views/posts/post_edit.js">控制器(controller)</a>. 听名字你应该就知道, 这个模板的作用是提供一个简单的表单来编辑一篇已经存在的post. post有标题(title), 链接(URl), 主体(body), 以及一个或多个的类别(categories). 该程序实际的表单中还会有一些额外的东西, 但我们现在不需要关心那些.<br/>
<img src="http://theMeteorbook.com/images/telescope-post-edit.png" alt="" /></p>

<p>这篇文章的目的是让你对Meteor的模板有个大概的认识. 如果你在其他的环境下使用过模板系统就会感到很熟悉, 如果没的话,那就现在开始学习吧.</p>

<h2>Basic Organization</h2>

<p>Meteor模板系统有两个部分组成,分别是: HTML模板和JavaScript控制器. HTML部分只是纯粹的有变量占位符的哑巴模板, 所有的实际动作都是通过JavaScript产生的.</p>

<!-- more -->


<p>顺便说句, Meteor通过<code>template</code>标签的<code>name</code>属性来得到这个模板的名字(<code>&lt;template name="post_edit"&gt;</code>), 因此,建议使用同一名字命名所有相关的文件和模板本身, 如在这个例子中的<code>post_edit.html</code>和<code>post_edit.js</code></p>

<figure class='code'><figcaption><span>post_edit.html template</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;post_edit&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  
</span><span class='line'>  {{#with post}}
</span><span class='line'>    <span class="nt">&lt;form&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label&gt;</span>Title<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;title&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;{{headline}}&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label&gt;</span>URL<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;url&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;{{url}}&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label&gt;</span>Body<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        <span class="nt">&lt;textarea</span> <span class="na">id=</span><span class="s">&quot;body&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">class=</span><span class="s">&quot;input-xlarge&quot;</span><span class="nt">&gt;</span>{{body}}<span class="nt">&lt;/textarea&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label&gt;</span>Category<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        {{#each categories}}
</span><span class='line'>          <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&quot;checkbox inline&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;category_{{_id}}&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">value=</span><span class="s">&quot;{{_id}}&quot;</span> <span class="na">name=</span><span class="s">&quot;category&quot;</span> <span class="err">{{</span><span class="na">hasCategory</span><span class="err">}}</span> <span class="nt">/&gt;</span> {{name}}
</span><span class='line'>          <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>        {{/each}}
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;form-actions&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;delete-link&quot;</span> <span class="na">href=</span><span class="s">&quot;/posts/deleted&quot;</span><span class="nt">&gt;</span>Delete Post<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/form&gt;</span>
</span><span class='line'>  {{/with}}
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>post_edit.js controller</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">post_edit</span><span class="p">.</span><span class="nx">helpers</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">post</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">categories</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Categories</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">();</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">hasCategory</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">));</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">categories</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;checked&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">post_edit</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="s1">&#39;click input[type=submit]&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">selectedPostId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">categories</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;input[name=category]:checked&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">categories</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">title</span><span class="o">:</span>         <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#title&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
</span><span class='line'>      <span class="nx">url</span><span class="o">:</span>           <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#url&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
</span><span class='line'>      <span class="nx">body</span><span class="o">:</span>          <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#body&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
</span><span class='line'>      <span class="nx">categories</span><span class="o">:</span>    <span class="nx">categories</span><span class="p">,</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">Posts</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">,</span> <span class="p">{</span><span class="nx">$set</span><span class="o">:</span> <span class="nx">properties</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">alert</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">reason</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s1">&#39;click .delete-link&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nx">confirm</span><span class="p">(</span><span class="s2">&quot;Are you sure?&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">selectedPostId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">Posts</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>代码看起来很多, 但是只要拆开来看,即使你从未看过Meteor的代码也会觉得很容易.</p>

<h2>Handlebars Tags</h2>

<p>首先来快速浏览下HTML部分. 你一定注意到这种奇怪的标签用法了吧. 这些都是<a href="http://handlebarsjs.com/">Handlebars</a>标签用来让我们展示动态数据.
先来看第一个handlebars标签<code>{{#with post}}</code></p>

<figure class='code'><figcaption><span>The &#8220;with&#8221; block helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;post_edit&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>  {{#with post}}
</span><span class='line'>    <span class="c">&lt;!-- do something with &quot;post&quot; --&gt;</span>
</span><span class='line'>  {{/with}}
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://handlebarsjs.com/block_helpers.html">block helper</a>是一种快捷的方式告诉我们要在哪个模板对象上工作. 在<code>{{#with post}}</code>block里, 我们的应用知道<code>this</code>代表一个<code>post</code>. <code>this</code>也是传说中方法的上下文.</p>

<h2>Template Helpers</h2>

<p>你可能会好奇,我们是从哪里得到<code>post</code>, 找到你的controller里的</p>

<figure class='code'><figcaption><span>The &#8220;post&#8221; template helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">post_edit</span><span class="p">.</span><span class="nx">helpers</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">post</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>在这我们要做的是添加一个<code>post</code><a href="http://docs.Meteor.com/#template_helpers">Template Helper</a>到我们的<code>post_edit</code>模板. Template helpers 是一些简单的JavaScript方法允许你使用 Handlebars template.</p>

<p>在这个例子中,不管任何时候我们的Handlebars模板调用<code>post</code>, 我们都能在我们的<code>Posts</code> collection 中找到current post并返回之. 要做到这样首先我们需要用到<code>selectedPostId</code>这个通过路由设置的Session变量(but that’s for another lesson)</p>

<h2>Object Properties</h2>

<p>继续往下, 我们将看到第二个handlebars标签<code>{{title}}</code></p>

<figure class='code'><figcaption><span>The &#8220;title&#8221; template helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>Title<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;title&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;{{title}}&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>尽管不能用什么方式告诉你这个<code>{{title}}</code>不是一个Template helper, 而是我们的<code>post</code>对象的属性之一. 无须任何其他的工作,Meteor很神奇地提供给了我们使用的.</p>

<h2>Nested Objects</h2>

<p>链接(URL)和主体(Body)表单域用的都是相同的模式, 而类别(Category)域则有些不同了.在这里, 我们希望通过类别检查展示一系列复选框给所有网站的预定义类别.</p>

<p>首先的工作是准备一系列的类别选择, 我们通过<code>{{#each categories}}</code>这个block helper来完成:</p>

<figure class='code'><figcaption><span>Looping over categories with the &#8220;each&#8221; helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>Category<span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  {{#each categories}}
</span><span class='line'>    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&quot;checkbox inline&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;category_{{_id}}&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">value=</span><span class="s">&quot;{{_id}}&quot;</span> <span class="na">name=</span><span class="s">&quot;category&quot;</span> <span class="err">{{</span><span class="na">hasCategory</span><span class="err">}}</span> <span class="nt">/&gt;</span> {{name}}
</span><span class='line'>    <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  {{/each}}
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>这个helper完成了两件事: 遍历<code>categories</code>对象, 以及在代码块里使用<code>this</code>来表示每一个遍历结果.</p>

<p>或许你已经猜到, <code>categories</code>像<code>posts</code>那样是一个Template helper. 在这个例子中,我们只返回了在我们的数据库中的一系列类别(categories)</p>

<figure class='code'><figcaption><span>The &#8220;categories&#8221; template helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>  <span class="nx">categories</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Categories</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>还记得我说过block helper 会改变<code>this</code>的值吗?这就是为什么我们能看到<code>{{_id}}</code>而不会混乱. 因为这事在block helper里边, 因此可以知道,我们处理的是category的ID,而不是post的ID</p>

<h2>More Helpers</h2>

<p>到目前为止, 我们的helper简单地查询了我们的collections并返回了数据. 但helper却不仅限于此. 让我们一起看一看 <code>{{hasCategory}}{endraw}</code>这个helper</p>

<figure class='code'><figcaption><span>The &#8220;hasCategory&#8221; template helper</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">hasCategory</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">categories</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;checked&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>还记得吧, 我们是在block <code>{%raw%}{{#each categories}}</code>里调用了这个helper, 这就意味着这里<code>this</code>表示的是category</p>

<p>那么我们现在是首次得到我们的current post对象, 然后检查看current category是否包含在这个post的categories里.如果包含有, 则我们很容易地返回&#8221;checked&#8221;字符串用以标记我们这个复选框被选中.</p>

<p>你可能已经注意到, <code>_.contains()</code>是一个 <a href="http://underscorejs.org/">Underscore</a>方法. Underscore是一个非常有用的JavaScript工具包并被内置绑定到了Meteor里边.</p>

<h2>Template Events</h2>

<p>我们现在的代码足够用来加载一篇post的标题,URL,主体,以及类别了. 但还是需要一种保存这个表单的方法. 也就是下面的模板事件(template events)</p>

<figure class='code'><figcaption><span>Template events</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">post_edit</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="s1">&#39;click input[type=submit]&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// do something when the users clicks input[type=submit]</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s1">&#39;click .delete-link&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// do something when the users clicks .delete-link</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>如你所见, 定义 template events其实就是简单把事件和CSS选择器放在一起. 在这里我们有两个处理监听,一个是提交表单,另一个是删除post.<br/>
先来看看表单提交处理:</p>

<figure class='code'><figcaption><span>Our form submit handler</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s1">&#39;click input[type=submit]&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">selectedPostId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">categories</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;input[name=category]:checked&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">categories</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">title</span><span class="o">:</span>         <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#title&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
</span><span class='line'>    <span class="nx">url</span><span class="o">:</span>           <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#url&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
</span><span class='line'>    <span class="nx">body</span><span class="o">:</span>          <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#body&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
</span><span class='line'>    <span class="nx">categories</span><span class="o">:</span>    <span class="nx">categories</span><span class="p">,</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Posts</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">,</span> <span class="p">{</span><span class="nx">$set</span><span class="o">:</span> <span class="nx">properties</span><span class="p">});</span>
</span><span class='line'><span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>处理方法带有两个参数, event 和 template 实例. 现在, 我们可以忽略template 实例. 使用<code>e.preventDefault();</code>来开始你的处理可以很好的阻止浏览器执行默认的事件行为.</p>

<p>如你所见, 这里有大量的<code>$</code>符号. 除了Underscore, Meteor还绑定了jQuery. 看吧, 你已经了解了Meteor的一半了.</p>

<p>再来一次, 处理categories相较于其他的来说比较麻烦一些.  通过使用jQuery, we’re checking for checked checkboxes(敢不敢把这句话说上10次,LOL)并使用他们的ID来填充给一个数组.</p>

<p>接下来我们就能够建立我们的属性对象, 并使用Meteor的<a href="http://docs.Meteor.com/#update">update()</a>可以简单地提交我们的修改给数据库.</p>

<p>删除post更是简单</p>

<figure class='code'><figcaption><span>Our post delete handler</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s1">&#39;click .delete-link&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="nx">confirm</span><span class="p">(</span><span class="s2">&quot;Are you sure?&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">selectedPostId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selectedPostId&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">Posts</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">selectedPostId</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>只需要简单地把要删除的ID传送给Meteor的<a href="http://docs.Meteor.com/#remove">remove()</a>方法就搞定.</p>

<h2>Other Callbacks</h2>

<p>Meteor给管理模板提供了一些其他的回调, 比如<a href="http://docs.Meteor.com/#template_created">created</a>和<a href="http://docs.Meteor.com/#template_rendered">render</a>回调</p>

<p>尽管我们在这里没有使用到, 但只要Meteor完成渲染一个模板, 那么<code>rendered</code>回调可以很容易的通过jQuery来做一些DOM操作.</p>

<h2>Conclusion</h2>

<p>CRUD (Create, Read, Update, Delete)操作经常就是组成网站的主要功能. Meteor能如此简单的完成这些工作显然是要大加分的.</p>

<p>更重要的是, Meteor代码所依赖的很多模式和库都是你所熟悉的.这意味着可以非常快的掌握,只需要一些JavaScript知识.</p>

<p>当然，随着您的需求的发展，你需要深入挖掘这个框架的复杂性。但是即使你只知道Meteor最基本的功能你也同样能作出一些东西来, 我想,这大概就是为什么Meteor非常好玩的原因之一.</p>

<p>原文来自 Sacha Greif  <a href="http://theMeteorbook.com/2013/02/20/a-look-at-a-Meteor-template/">A Look at a Meteor Template</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting Started with Meteor]]></title>
    <link href="http://xguox.github.com/blog/2013/03/05/getting-started-with-meteor/"/>
    <updated>2013-03-05T23:02:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/03/05/getting-started-with-meteor</id>
    <content type="html"><![CDATA[<h5>LEVEL: BEGINNER</h5>

<p>当你看到这,也就说明你听说了<a href="http://Meteor.com/">Meteor</a>这东西, 并对它产生一些好奇.<br/>
那就让我们创建一个最基本的应用来耍一耍吧. 希望能以此学习到一两样东西.</p>

<h2>准备工作: 安装Meteor</h2>

<p>要安装Meteor那就再简单不过了. 只需要执行下面这条命令<br/>
<code>curl https://install.Meteor.com | /bin/sh</code></p>

<p>只要你是在<a href="https://github.com/Meteor/Meteor/wiki/Supported-Platforms">支持的平台</a>上运行,跟着步骤来就基本没什么问题.</p>

<p>接下来让我们创建一个简单的app来确定是否安装成功.<br/>
<code>Meteor create forum</code>
如果安装成功, 那执行下面的步骤就可以把这个app跑起来了</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd forum
</span><span class='line'>Meteor</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<p>如果这一切都顺利的话, 那么在浏览器打开<code>http://localhost:3000</code>, 就会看到:
<img src="http://theMeteorbook.com/images/posts/bare-Meteor-app.png" alt="" /></p>

<h2>设置我们的forum</h2>

<p>这个使用Meteor生成的简单的应用程序并不能做些什么; 只是或多或少示范了如何呈现模板和响应事件.</p>

<p>而今, 我们只需要用浏览器的控制台(比如Chrome的Inspector)来捣鼓一些我们这个应用的数据. 因此,我们不必太过在意现有的用户界面. 一切从简. 在创建一个posts集合并在一个列表中一一展示前,我们先在 forum.html 这么干:</p>

<figure class='code'><figcaption><span>forum.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>Forum<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  
</span><span class='line'>  {{&gt; posts}}
</span><span class='line'>  
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;posts&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h1&gt;</span>Posts<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ul&gt;</span>
</span><span class='line'>    {{#each posts}}
</span><span class='line'>    <span class="nt">&lt;li&gt;</span>{{name}}<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    {{/each}}
</span><span class='line'>  <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>当编辑完成上面这段代码后, 你应该会看到浏览器自动重载了页面. 现在, 除了一个&#8221;Posts&#8221;标题,你应该什么也看不到. 为什么会这样呢?</p>

<p><img src="http://theMeteorbook.com/images/posts/empty-posts-list.png" alt="" /></p>

<p>我们刚刚使用了<code>{{ #each }}</code>这个helper来告诉Meteor创建了一个无序列表并且在其里边的每个li标签展示一条post. 但是在这里我们的posts为空. 所以页面中什么也没显示出来. 那么接下来让我们来生成一些posts吧.</p>

<p>在<code>forum.js</code>, 我们创建了一个叫<code>posts</code>的<code>Collection</code>, 并使用之前所建立的<code>posts</code>模板加载之:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Posts</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">isClient</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">helpers</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">posts</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这看起来只是一个简单的变化，但事实并非如此。 我们做的事是在客户端和服务端创建了一个叫作<code>posts</code>的Meteor <code>Collection</code>. 这是什么意思呢?</p>

<p>在服务端,当数据被添加进来之后, 会被插入写进到一个<a href="http://www.mongodb.org/">mongo</a>数据库(mongo内置包含在每个Meteor应用程序). 当执行查询的时候, Meteor会查找到这个数据库. 这样我们其实就已经把这些posts永久性的存贮起来了.</p>

<p>在客户端,<code>posts</code> 集合会自动连接到服务端并在浏览器,本地镜像或者缓存中创建这个服务端集合. 这样, 当在浏览器中新建posts,这些posts就会直达服务端从而插入到mongo数据库中,并传输到其他连接上的本地的<code>posts</code>集合. 很难理解是吧?你很快就会知道这一切是怎么回事.</p>

<p>添加完以上的js以后, 你不会看到我们的应用程序发生任何的改变; 这是因为我们还没添加任何一条的数据. 那么现在开始添加吧.</p>

<h2>在你的浏览器控制台中操纵数据</h2>

<p>让我们来仔细看看这个神奇的集合. 在这我们会使用到浏览器控制台, 尽管我们假定你一直跟着我们的步伐并使用了Chrome的Inspector, 但其他的一些浏览器控制台(如Firebug等)也一样可以完成.</p>

<p>首先, 让我们看看集合里有些什么东西. 运行下面的代码,我们会告诉<code>posts</code>模板查找该集合中的数据:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</span><span class='line'><span class="err">»</span> <span class="err">‣</span><span class="nx">LocalCollection</span><span class="p">.</span><span class="nx">Cursor</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Cursor</code>是一个匹配指定的查询(在本例中为空)所得到的Meteor数据源. 现在看起来不那么有趣, 让我们使用下面这条语句来提取数据:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">()</span>
</span><span class='line'><span class="err">»</span> <span class="p">[]</span>
</span></code></pre></td></tr></table></div></figure>


<p>由于还没有一条post, 这会返回一个空数组. 让我们添加上一条吧!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Posts</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;A Brand New Post&#39;</span><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>由于Meteor的响应式渲染( reactive rendering )使得HTML与底层的数据模型保持同步, 因此我们可以马上在页面上看到这条post
<img src="http://theMeteorbook.com/images/posts/single-post-inserted.png" alt="" /></p>

<p>等一等,现在我们能够在客户端中从这个集合里抓取到这条post</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">()</span>
</span><span class='line'><span class="err">»</span> <span class="p">[</span><span class="err">‣</span><span class="nb">Object</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>我们能够在本地集合中看到这篇post的存在. 对此没什么概念吗? 试试刷新页面;或者在一个新的tab打开<code>http://localhost:3000</code>,这篇post还在是吧!</p>

<p>为什么会这样呢?在程序内部,Meteor已经同步了这个post对象(<code>{name: 'A Brand New Post'}</code>)到服务端, 并将其存储到mongo数据库中,这样,在所有的客户端都能访问到这篇post.我们同样能够在mongo的控制台中查看到它;在命令行中运行<code>Meteor mongo</code>(该命令运行的同时必须把项目跑起来),你也可以使用相似的接口来查看到:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;A Brand New Post&quot;</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;a72d6722-262b-4dc5-80f6-564796a6cc95&quot;</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>花上一点时间想想这对你来说有多么的神奇 (with no work on your part!), 然后肆意地在浏览器的控制台操纵<code>insert</code>  <code>update</code>  <code>remove</code> 命令(<a href="http://docs.Meteor.com/#collections">文档在这</a>),同时在其他tab,其他浏览器甚至其他机器上(只要能看得到)看看同步的效果</p>

<p>原文转自 Tom Coleman <a href="http://theMeteorbook.com/2013/01/30/getting-started-with-Meteor/">Getting Started with Meteor</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[你应该在生产环境下使用JavaScript的严格模式（strict mode）吗？]]></title>
    <link href="http://xguox.github.com/blog/2013/02/08/should-you-use-strict-in-your-production-javascript/"/>
    <updated>2013-02-08T09:32:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/02/08/should-you-use-strict-in-your-production-javascript</id>
    <content type="html"><![CDATA[<p>ECMAScript 5 中引入了一种定义,可以切换让你的JavaScript代码是否在所谓的 <strong>严格模式(strict mode)</strong>下执行。因为在strict mode下，当浏览器遇到一些脚本中包含有不好的代码做法时，即使没有语法上的错误也会抛出runtime错误，因而常常被吹捧为一种显著有益于捕获程序员错误的方式。</p>

<h2><strong>在strict mode下运行被认为可以更少的出错</strong></h2>

<p>举个栗子，在定义一个变量时，缺少关键字“var”，如果在non-strict mode下会默认为该变量为全局变量，而在 strict mode下则会抛出一个runtime错误。</p>

<!--more-->


<p>Non-Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
</span><span class='line'><span class="p">}());</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; 1</span>
</span></code></pre></td></tr></table></div></figure>


<p>Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
</span><span class='line'><span class="p">}());</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; ReferenceError: x is not defined</span>
</span></code></pre></td></tr></table></div></figure>


<h2><strong>但strict mode太爱出风头了</strong></h2>

<p>有些时候这样的严格会是一把双刃剑。我们都希望知道在我们的代码中的这些无声的bug，但绝对不会希望看到这些bug在我们运营上线的网站上抛出runtime错误给了我们的最终用户。尤其是,当这些代码实际上都按我们的期望正常运行着的时候，只是这些代码有一些“bug”</p>

<h2><strong>可以同时使用两种方式吗？</strong></h2>

<p>你不会得到许多的同情，而应该开始抱怨JavaScript暴露了一个bug给你的用户而你自己却不知道，除此之外，你可能会想这可以有两全其美的方法-在测试代码下使用strict mode，而生产环境下不使用。但这个想法有几个问题，首先，这很可能会使你的生产代码运行起来比测试代码要慢的多（见下文），然后，这两种代码可能跑起来会有所不同（见下文）。</p>

<h2><strong>Non-Strict Mode 下代码可能跑得要慢一些</strong></h2>

<p>或许这会跟你的直觉相悖，可能你会认为更多的错误检测和一些额外的“事情”一定会使得引擎做得更多从而你的代码跑得更慢。但<a href="https://hacks.mozilla.org/2011/01/ecmascript-5-strict-mode-in-firefox-4/">Chris Heilmann</a>总结出了使用strict mode跑的更快的原因。他的解释如下:</p>

<blockquote><p>[Strict mode] 修复了那些误区使得JavaScript引擎性能得到优化: 相较于非strict mode而言,strict mode代码能跑的更快。 Firefox 4 还未优化strict mode ,但其后续版本会。</p></blockquote>

<p>也就是说是否去掉strict mode 在生产环境意义并不是那么的明显, 但如果没有令人信服的考虑,去掉strict mode的话你实际上是改变了你的代码的执行方式。下面是几个例子。</p>

<h2><strong>是否为Strict Mode,函数的上下文会有所不同</strong></h2>

<p>在non-strict mode,任意全局函数中,保留字“<code>this</code>”默认指向全局对象(对于浏览器而言,这个对象会是 <strong>window对象</strong>).而在strict mode,“<code>this</code>”默认则为<code>undefined</code><br/>
Non-strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'><span class="p">}());</span>
</span><span class='line'><span class="c1">//=&gt; Window</span>
</span></code></pre></td></tr></table></div></figure>


<p>Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'><span class="p">}());</span>
</span><span class='line'><span class="c1">//=&gt; undefined</span>
</span></code></pre></td></tr></table></div></figure>


<p>在一个函数中使用<code>call()</code>你可以设定<code>this</code>的指代,但在这两种不同的模式下,你用来充当上下文的值会巧妙地变得有些不一样。在Non-strict Mode，如果上下文的值是原始的（primitive），比如数字 <code>1</code>，那它将会被转换成一个对象，一个Number对象。而在strict mode ,这个原始的值 <code>1</code>, 将会被保留。<br/>
Non-strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">}.</span><span class="nx">call</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; Number {}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">}.</span><span class="nx">call</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; 1</span>
</span></code></pre></td></tr></table></div></figure>


<h2><strong>是否为Strict Mode,arguments对象的行为有所不同</strong></h2>

<p> <code>arguments</code>对象包含了引用函数的形参。在non-strict mode下，修改arguments对象的值同时也会修改对应的形参的值，而在Strict Mode之下，两者是独立的。<br/>
Non-strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
</span><span class='line'><span class="p">}(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; two two</span>
</span></code></pre></td></tr></table></div></figure>


<p>Strict Mode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
</span><span class='line'><span class="p">}(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//=&gt; one two</span>
</span></code></pre></td></tr></table></div></figure>


<h2><strong>为什么你无论如何也要移除严格模式</strong></h2>

<p>考虑到在你的代码中的所有可能的变更行为,你可能会认为有明确的理由不去除“use strict&#8221;,毕竟，你也不希望你的做法会改变代码原本的运行方式。对不?但事实上，你确实会遇上这些问题，即使你保留了&#8221;use strict&#8221;。这是因为，你的“use strict&#8221;在一些旧版本的浏览器下会直接被无视，<a href="http://caniuse.com/use-strict">它们不认识这句声明</a>。因此，对于你的其中一些用户，你还不如把“use strict&#8221;去掉更好。这样，他们也将得到同样的而在你想象的现代浏览器中不会得到的不严格行为。如果希望使用严格模式的同时支持旧版本的浏览器，你需要明白所有的严格模式下是否有效的副作用,然后避开对它们的依赖。</p>

<p>你可能会觉得兼容性胜利了以及最好从来都没有出现过什么“use strict&#8221;的效果。又或者，你可能 觉得你了解了所有的副作用影响并坚持使用“use strict&#8221;,但还有另外一个问题需要考虑到的。如果通过连接和压缩你在生产环境下的代码来优化了HTTP请求,你可能会遇到一个与“use strict&#8221;相关的问题。当在函数中声明了 “use strict&#8221; ， 它只适用于该函数的词法作用域(lexical scope )。但如果在函数外声明，则将会作用于整一个文件。How could this come back to bite you?让我举个栗子&#8230;</p>

<p>在我的一些工作项目中，我们有时候会引入第三方的实用工具库到我们的应用程序中。而且很有可能会引入多个。当然，我们自己的代码是 concatenation-friendly ,因为我们只使用了函数范围内的 严格模式,但假设一下如果某一个第三方库在文件顶部&#8211;不在任何函数域内声明了“use strict&#8221;。现在也想象一下另外一个第三方库不是严格的安全。通过串联这两个库你几乎可以肯定会得到不同的行为以及一些以往不会抛出的错误。</p>

<p>当然也有一些方法可以缓解这些问题：避免使用任何在函数域外声明“use strict&#8221;的库,或者你可以放弃连接使用这些库并且 take the HTTP request hit to performance.这些个看起来都有些局限性，不那么吸引人。</p>

<p>因此，不顾所有可能的移除严格模式副作用,在特定情况下，你可能会决定选择在生产环境下移除&#8221;use strict&#8221;。</p>

<p>原文来自Michael Mathews,<a href="http://scriptogr.am/micmath/post/should-you-use-strict-in-your-production-javascript?utm_source=javascriptweekly&amp;utm_medium=email">Should You &#8220;Use Strict&#8221; in Your Production JavaScript?</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[About My Translation]]></title>
    <link href="http://xguox.github.com/blog/2013/02/07/about-translation/"/>
    <updated>2013-02-07T18:05:00+08:00</updated>
    <id>http://xguox.github.com/blog/2013/02/07/about-translation</id>
    <content type="html"><![CDATA[<p><strong>First off</strong>，以俺目前的各种水平，想写出一些好的 technical articles 是有点难度的啦。于是乎，我选择了翻译国外一些好的文章。不管多么新鲜的技术，就算找不着中文资料，也一定没少英文文档。比如最近发现的几个挺不错<a href="https://cooperpress.com/">weekly</a>（其实也不是最近才发现，也订阅了有大半年吧，不过其实是只订不阅，或者阅的比较少。惰性心理啊。）以及一些国外牛人BLOG。Share下我的文章的主要来源吧.</p>

<ul>
<li><a href="http://www.smashingmagazine.com/">Smashing Magazine</a></li>
<li><a href="http://www.html5rocks.com/en/">HTML5ROCKS</a></li>
<li><a href="http://css-tricks.com/">CSS-Tricks</a></li>
<li><a href="http://javascriptweekly.com/">JavaScript Weekly</a></li>
<li><a href="http://rubyweekly.com/">Ruby Weekly</a>(最近几乎没怎么研究Ruby了)</li>
<li><a href="http://dailyjs.com/">DailyJS</a></li>
<li><a href="http://net.tutsplus.com/">nettus+</a></li>
<li><a href="http://paulirish.com/">Paul Irish</a></li>
<li><a href="http://blog.reybango.com/">Rey Bango</a></li>
<li><a href="http://javascriptissexy.com/">JavaScript.is(Sexy)</a></li>
</ul>


<p>Obviously, 不可能有一篇新的我就翻译一篇. 要是那样的话我精尽人亡都搞不过来. 而且, 尴尬 + 惭愧的是, 本身我自己的Google Reader里也是常年1000+ unread =. =</p>

<p>其实以前初初学Rails也是跟着全英文的<a href="http://ruby.railstutorial.org/ruby-on-rails-tutorial-book">Ruby on Rails Tutorial</a>，另外也尝试翻译过<a href="http://rubymonk.com/">rubymonk</a>以及近段时间翻的一些，本人的英文水平实在很渣，CET6不上300分的成绩也曾经考过。于是，都翻比较蹩脚。就好比之前那几篇，好些地方原本读原文还明白了, 翻译过后反而看不懂在讲什么。有些则是只会半句。好吧，的确尴尬！不过，会好起来的。</p>

<p>说到英文水平，尽管老早的就知道重要性，却从未好好学习过，只能现在硬着头皮自愿加强迫自己上，看英文的电视剧（尽量不跟着字幕），用英文的社交网站（圈多些国外的），阅读外文的文章（好吧，几乎也就是一些科技类的）, 听英文podcast(各种听不懂)&#8230;</p>

<p>PS，最近看<a href="http://linlis.me/">@linux</a>也经常翻译一些文章，不过他翻译的更多比较文学性的。</p>
]]></content>
  </entry>
  
</feed>
